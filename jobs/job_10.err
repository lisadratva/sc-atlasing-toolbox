/tmp/1741193406.981197.shell: line 17: activate: No such file or directory
++ realpath ../sc-atlassing-toolbox
+ pipeline=/nfs/team205/ld21/repos/sc-atlassing-toolbox
+ snakemake --profile .profiles/local --configfile configs/resources.yaml configs/load_config.yaml configs/marker_genes.yaml configs/outputs.yaml configs/t_cells_0612.yaml --snakefile /nfs/team205/ld21/repos/sc-atlassing-toolbox/workflow/Snakefile --use-conda --rerun-incomplete --keep-going --printshellcmds filter_all preprocessing_all -c 10
Using profile .profiles/local for setting default command line arguments.
Config file configs/outputs.yaml is extended by additional config specified via the command line.
WARNING:ModuleConfig: No default target specified for module "collect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/collect/dataset~{dataset}.zarr..."
WARNING:ModuleConfig: No default target specified for module "uncollect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/uncollect/dataset~{dataset}/file_id~{file_id}/new_file_id~{new_file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "exploration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/exploration/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "sample_representation", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/sample_representation/dataset~{dataset}/file_id~{file_id}/method~{method}/input_type~{input_type}/use_rep~{use_rep}/var_mask~{var_mask}.zarr..."
WARNING:ModuleConfig: No default target specified for module "batch_analysis", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/batch_analysis/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "doublets", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "subset", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/subset/dataset~{dataset}/file_id~{file_id}/strategy~{strategy}.zarr..."
WARNING:ModuleConfig: No default target specified for module "label_transfer", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/label_transfer/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "integration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/integration/dataset~{dataset}/file_id~{file_id}/method~{method}/batch~{batch}/label~{label}/var_mask~{var_mask}/output_type~{output_type}.zarr..."
WARNING:ModuleConfig: No default target specified for module "marker_genes", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/marker_genes/dataset~{dataset}/file_id~{file_id}.zarr..."
Building DAG of jobs...
Using shell: /usr/local/bin/bash
Provided cores: 10
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Job stats:
job                                    count
-----------------------------------  -------
filter                                     1
filter_all                                 1
preprocessing_all                          1
preprocessing_assemble                     1
preprocessing_extra_hvgs                   1
preprocessing_highly_variable_genes        1
preprocessing_neighbors                   33
preprocessing_normalize                    1
preprocessing_pca                         27
preprocessing_plot_pca                    32
preprocessing_plot_umap                   35
preprocessing_umap                        35
total                                    169

Select jobs to execute...

[Thu Mar  6 04:02:18 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/pca.zarr
    jobid: 200
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/pca.zarr; Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE182159_Liver
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

[Thu Mar  6 04:02:20 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/pca.zarr
    jobid: 194
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/pca.zarr; Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE217930
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

[Thu Mar  6 04:02:20 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/pca.zarr
    jobid: 180
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/pca.zarr; Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:COMBAT_2022
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

[Thu Mar  6 04:02:20 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/neighbors.zarr
    jobid: 291
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/neighbors.zarr; Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Reyes_2020
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

[Thu Mar  6 04:02:20 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/umap.done
    jobid: 341
    reason: Forced execution
    wildcards: dataset=t_cells, file_id=filter:GSE259231_mCEL_seq2_HCV
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

[Thu Mar  6 04:02:20 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/pca.zarr
    jobid: 222
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/pca.zarr; Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:Ren_2021_10X_3_PBMCs
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

[Thu Mar  6 04:02:20 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/pca.zarr
    jobid: 208
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:Stephenson_2021
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpjl_y8zzf.umap.py
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmppyweyrv1.pca.py
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp2sy_7z6y.neighbors.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp94e8rkwz.pca.py
Activating conda environment: rapids_singlecell
Activating conda environment: rapids_singlecell
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpg72shi4k.pca.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpac687x2y.pca.py
Activating conda environment: rapids_singlecell

[Thu Mar  6 04:02:24 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/neighbors.zarr
    jobid: 351
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/neighbors.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE287808_NALT
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell

[Thu Mar  6 04:02:24 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/umap.done
    jobid: 338
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/umap.zarr; Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/pca.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/neighbors.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE259231_mCEL_seq2_HBV
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell

[Thu Mar  6 04:02:24 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/pca.zarr
    jobid: 244
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE162097_TDL
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpce5l8p5z.pca.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpv90ufgfi.neighbors.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp9c4bcbrg.umap.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpwnuwa6qv.pca.py
Activating conda environment: rapids_singlecell
INFO:root:Using rapids_singlecell...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/highly_variable_genes.zarr"...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/pca.zarr...
INFO:root:Using rapids_singlecell...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/highly_variable_genes.zarr"...
INFO:root:Using rapids_singlecell...
INFO:root:Using rapids_singlecell...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/highly_variable_genes.zarr"...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/neighbors.zarr...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/neighbors.zarr...
INFO:root:Using rapids_singlecell...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/highly_variable_genes.zarr"...
INFO:root:Using rapids_singlecell...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/highly_variable_genes.zarr"...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/pca.zarr...
INFO:root:Using rapids_singlecell...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/highly_variable_genes.zarr"...
INFO:root:AnnData object with n_obs × n_vars = 6794 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
INFO:root:Subset to highly variable genes...
INFO:root:AnnData object with n_obs × n_vars = 77517 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
INFO:root:AnnData object with n_obs × n_vars = 84354 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:PCA with parameters: {'n_comps': 50}
INFO:root:Subset to highly variable genes...
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/umap.zarr...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/umap.zarr...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 58167 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
INFO:root:AnnData object with n_obs × n_vars = 430171 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
INFO:root:AnnData object with n_obs × n_vars = 60128 × 11025
    obs: '10X_3prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 6794 × 10000
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 32602 × 11025
    obs: '10X_3prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
[Thu Mar  6 04:04:50 2025]
Finished job 351.
1 of 169 steps (1%) done
Select jobs to execute...

[Thu Mar  6 04:04:50 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/umap.done
    jobid: 350
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/umap.zarr; Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/neighbors.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE287808_NALT
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:04:50 2025]
Finished job 291.
2 of 169 steps (1%) done
Select jobs to execute...

[Thu Mar  6 04:04:50 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/umap.done
    jobid: 290
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/neighbors.zarr
    wildcards: dataset=t_cells, file_id=filter:Reyes_2020
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpno1ru1bz.umap.py
Activating conda environment: rapids_singlecell
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/umap.done.
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:04:54 2025]
Finished job 341.
3 of 169 steps (2%) done
[Thu Mar  6 04:04:54 2025]
Finished job 244.
4 of 169 steps (2%) done
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/umap.done.
[Thu Mar  6 04:04:54 2025]
Finished job 338.
5 of 169 steps (3%) done
Select jobs to execute...

[Thu Mar  6 04:04:54 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/umap
    jobid: 337
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE259231_mCEL_seq2_HBV
    resources: tmpdir=/tmp

python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmppmj6ugv2.umap.py
Activating conda environment: rapids_singlecell

[Thu Mar  6 04:04:55 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182536/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182536/pca.zarr
    jobid: 188
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182536/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE182536
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpxczyzs79.plot.py
Activating conda environment: scanpy
INFO:root:AnnData object with n_obs × n_vars = 273942 × 11024
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/neighbors.zarr...
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/umap.zarr...

[Thu Mar  6 04:04:58 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/umap
    jobid: 340
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE259231_mCEL_seq2_HCV
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpls9gn1_g.pca.py
Activating conda environment: rapids_singlecell
Select jobs to execute...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmplpy_gtc1.plot.py
Activating conda environment: scanpy
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/neighbors.zarr...
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/umap.zarr...
INFO:root:Using rapids_singlecell...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182536/highly_variable_genes.zarr"...
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/umap.done.
[Thu Mar  6 04:05:05 2025]
Finished job 350.
6 of 169 steps (4%) done

[Thu Mar  6 04:05:05 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/umap
    jobid: 349
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/umap; Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE287808_NALT
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp10txe3gg.plot.py
Activating conda environment: scanpy
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/umap.done.
[Thu Mar  6 04:05:09 2025]
Finished job 290.
7 of 169 steps (4%) done
Select jobs to execute...

[Thu Mar  6 04:05:09 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/umap
    jobid: 289
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:Reyes_2020
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpivmy290g.plot.py
Activating conda environment: scanpy
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE259231_mCEL_seq2_HCV...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/umap.zarr...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE259231_mCEL_seq2_HBV...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/umap.zarr...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE287808_NALT...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/umap.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 200.0}
INFO:root:Remove outliers...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 46.59832246039143}
  0%|          | 0/11 [00:00<?, ?it/s]  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "modalities"...
INFO:root:Plot color "tissue"...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 3.4383757113139755}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "qc_status"...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:Reyes_2020...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/umap.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 6.134592969756457}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "Cross_tissue_broad"...
  9%|▉         | 1/11 [00:00<00:08,  1.18it/s]INFO:root:Plot color "qc_status"...
  9%|▉         | 1/11 [00:00<00:08,  1.12it/s]INFO:root:Plot color "Cross_tissue_broad"...
 18%|█▊        | 2/11 [00:01<00:04,  1.98it/s]INFO:root:Plot color "infection_status"...
 18%|█▊        | 2/11 [00:01<00:05,  1.72it/s]INFO:root:Plot color "infection_stage"...
  9%|▉         | 1/11 [00:01<00:10,  1.08s/it]INFO:root:Plot color "infection_stage"...
 27%|██▋       | 3/11 [00:01<00:03,  2.51it/s]INFO:root:Plot color "Lindeboom_broad"...
 27%|██▋       | 3/11 [00:01<00:03,  2.21it/s]INFO:root:Plot color "pathogen"...
  9%|▉         | 1/11 [00:00<00:09,  1.05it/s]INFO:root:Plot color "dataset_id"...
 36%|███▋      | 4/11 [00:01<00:02,  2.58it/s]INFO:root:Plot color "Lindeboom_broad"...
 36%|███▋      | 4/11 [00:01<00:03,  2.16it/s]INFO:root:Plot color "modalities"...
 18%|█▊        | 2/11 [00:01<00:07,  1.13it/s]INFO:root:Plot color "tissue"...
 18%|█▊        | 2/11 [00:01<00:06,  1.40it/s]INFO:root:Plot color "infection_status"...
 45%|████▌     | 5/11 [00:02<00:02,  2.57it/s]INFO:root:Plot color "dataset_id"...
 55%|█████▍    | 6/11 [00:02<00:01,  2.95it/s]INFO:root:Plot color "Compartment_prediction"...
 45%|████▌     | 5/11 [00:02<00:02,  2.11it/s]INFO:root:Plot color "tissue"...
 27%|██▋       | 3/11 [00:02<00:06,  1.26it/s]INFO:root:Plot color "infection_status"...
 64%|██████▎   | 7/11 [00:02<00:01,  3.09it/s]INFO:root:Plot color "infection_stage"...
 55%|█████▍    | 6/11 [00:02<00:02,  2.47it/s]INFO:root:Plot color "study"...
 27%|██▋       | 3/11 [00:02<00:05,  1.36it/s]INFO:root:Plot color "pathogen"...
 64%|██████▎   | 7/11 [00:03<00:01,  2.70it/s]INFO:root:Plot color "dataset_id"...
 73%|███████▎  | 8/11 [00:03<00:01,  2.95it/s]INFO:root:Plot color "pathogen"...
 82%|████████▏ | 9/11 [00:03<00:00,  3.26it/s]INFO:root:Plot color "Cross_tissue_broad"...
 73%|███████▎  | 8/11 [00:03<00:01,  2.70it/s]INFO:root:Plot color "infection_status"...
 36%|███▋      | 4/11 [00:03<00:05,  1.29it/s]INFO:root:Plot color "Lindeboom_broad"...
 36%|███▋      | 4/11 [00:02<00:04,  1.51it/s]INFO:root:Plot color "Lindeboom_broad"...
 91%|█████████ | 10/11 [00:03<00:00,  3.34it/s]INFO:root:Plot color "study"...
 82%|████████▏ | 9/11 [00:03<00:00,  2.88it/s]INFO:root:Plot color "qc_status"...
100%|██████████| 11/11 [00:03<00:00,  3.50it/s]100%|██████████| 11/11 [00:03<00:00,  2.83it/s]
 91%|█████████ | 10/11 [00:04<00:00,  2.96it/s]INFO:root:Plot color "Compartment_prediction"...
[Thu Mar  6 04:05:16 2025]
Finished job 340.
8 of 169 steps (5%) done
Select jobs to execute...

[Thu Mar  6 04:05:16 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/neighbors.zarr
    jobid: 348
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/neighbors.zarr; Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE162097_TDL
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
100%|██████████| 11/11 [00:04<00:00,  2.97it/s]100%|██████████| 11/11 [00:04<00:00,  2.52it/s]
 45%|████▌     | 5/11 [00:03<00:04,  1.21it/s]INFO:root:Plot color "tissue"...
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp5veb78p9.neighbors.py
Activating conda environment: rapids_singlecell
 45%|████▌     | 5/11 [00:04<00:05,  1.10it/s]INFO:root:Plot color "pathogen"...
[Thu Mar  6 04:05:16 2025]
Finished job 337.
9 of 169 steps (5%) done
Select jobs to execute...

[Thu Mar  6 04:05:16 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/pca.zarr
    jobid: 230
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:ESKD_2024
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

 55%|█████▍    | 6/11 [00:04<00:03,  1.38it/s]INFO:root:Plot color "Compartment_prediction"...
 55%|█████▍    | 6/11 [00:05<00:04,  1.15it/s]INFO:root:Plot color "modalities"...
 64%|██████▎   | 7/11 [00:05<00:02,  1.43it/s]INFO:root:Plot color "infection_stage"...
 64%|██████▎   | 7/11 [00:05<00:03,  1.24it/s]INFO:root:Plot color "Cross_tissue_broad"...
 73%|███████▎  | 8/11 [00:05<00:02,  1.40it/s]INFO:root:Plot color "study"...
INFO:root:PCA with parameters: {'n_comps': 50}
 73%|███████▎  | 8/11 [00:06<00:02,  1.22it/s]INFO:root:Plot color "dataset_id"...
 82%|████████▏ | 9/11 [00:06<00:01,  1.52it/s]INFO:root:Plot color "modalities"...
 91%|█████████ | 10/11 [00:06<00:00,  1.61it/s]INFO:root:Plot color "qc_status"...
 82%|████████▏ | 9/11 [00:07<00:01,  1.28it/s]INFO:root:Plot color "Compartment_prediction"...
100%|██████████| 11/11 [00:07<00:00,  1.63it/s]100%|██████████| 11/11 [00:07<00:00,  1.46it/s]
 91%|█████████ | 10/11 [00:08<00:00,  1.27it/s]INFO:root:Plot color "study"...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:05:20 2025]
Finished job 289.
10 of 169 steps (6%) done
Select jobs to execute...

[Thu Mar  6 04:05:20 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/pca.zarr
    jobid: 216
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:Hatje_2024_SmartSeq2
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp_qsl_cfd.pca.py
Activating conda environment: rapids_singlecell
100%|██████████| 11/11 [00:08<00:00,  1.32it/s]100%|██████████| 11/11 [00:08<00:00,  1.24it/s]
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 77517 × 10000
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
INFO:root:AnnData object with n_obs × n_vars = 7818 × 11022
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/pca.zarr...
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 6794 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:05:24 2025]
Finished job 349.
11 of 169 steps (7%) done
Select jobs to execute...

[Thu Mar  6 04:05:24 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/pca.zarr
    jobid: 196
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:Waradon_Dengue
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpx9iqrrwv.pca.py
Activating conda environment: rapids_singlecell
INFO:root:Using rapids_singlecell...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/highly_variable_genes.zarr"...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:05:28 2025]
Finished job 200.
12 of 169 steps (7%) done
[Thu Mar  6 04:05:28 2025]
Finished job 348.
13 of 169 steps (8%) done
Select jobs to execute...

[Thu Mar  6 04:05:28 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/pca.zarr
    jobid: 182
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:Yoshida_2021
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmptmh9b93z.pca.py
Activating conda environment: rapids_singlecell
INFO:root:Using rapids_singlecell...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/highly_variable_genes.zarr"...

[Thu Mar  6 04:05:31 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/umap.done
    jobid: 347
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/umap.zarr; Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/pca.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/neighbors.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE162097_TDL
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
Select jobs to execute...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpihdy1bay.pca.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpo5oj8d5o.umap.py
Activating conda environment: rapids_singlecell
INFO:root:Using rapids_singlecell...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/highly_variable_genes.zarr"...
INFO:root:PCA with parameters: {'n_comps': 50}
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/neighbors.zarr...
INFO:root:Using rapids_singlecell...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/highly_variable_genes.zarr"...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182536/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 7818 × 10000
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/umap.zarr...
[Thu Mar  6 04:05:40 2025]
Finished job 188.
14 of 169 steps (8%) done

[Thu Mar  6 04:05:40 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182536/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182536/neighbors.zarr
    jobid: 264
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182536/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE182536
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

INFO:root:AnnData object with n_obs × n_vars = 1049 × 11025
    obs: 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'Smartseq2', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/umap.done.
[Thu Mar  6 04:05:45 2025]
Finished job 347.
15 of 169 steps (9%) done
Select jobs to execute...

[Thu Mar  6 04:05:45 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/umap
    jobid: 346
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/umap; Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE162097_TDL
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpv9ghfovb.neighbors.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp1t10kve6.plot.py
Activating conda environment: scanpy
INFO:root:PCA with parameters: {'n_comps': 50}
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 1049 × 10000
    obs: 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'Smartseq2', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE162097_TDL...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/umap.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 29.43773918163085}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "Lindeboom_broad"...
  9%|▉         | 1/11 [00:00<00:05,  1.88it/s]INFO:root:Plot color "dataset_id"...
 18%|█▊        | 2/11 [00:00<00:03,  2.60it/s]INFO:root:Plot color "pathogen"...
 27%|██▋       | 3/11 [00:01<00:02,  2.99it/s]INFO:root:Plot color "study"...
 36%|███▋      | 4/11 [00:01<00:02,  3.20it/s]INFO:root:Plot color "Compartment_prediction"...
 45%|████▌     | 5/11 [00:01<00:01,  3.16it/s]INFO:root:Plot color "infection_status"...
[Thu Mar  6 04:05:50 2025]
Finished job 216.
16 of 169 steps (9%) done
Select jobs to execute...

[Thu Mar  6 04:05:50 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/neighbors.zarr
    jobid: 306
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Hatje_2024_SmartSeq2
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

 55%|█████▍    | 6/11 [00:01<00:01,  3.32it/s]INFO:root:Plot color "qc_status"...
 64%|██████▎   | 7/11 [00:02<00:01,  3.34it/s]INFO:root:Plot color "infection_stage"...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182536/pca.zarr...
 73%|███████▎  | 8/11 [00:02<00:01,  2.96it/s]INFO:root:Plot color "tissue"...
 82%|████████▏ | 9/11 [00:02<00:00,  3.17it/s]INFO:root:Plot color "Cross_tissue_broad"...
 91%|█████████ | 10/11 [00:03<00:00,  3.08it/s]INFO:root:Plot color "modalities"...
100%|██████████| 11/11 [00:03<00:00,  3.22it/s]100%|██████████| 11/11 [00:03<00:00,  3.08it/s]
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:05:54 2025]
Finished job 346.
17 of 169 steps (10%) done
Select jobs to execute...

[Thu Mar  6 04:05:54 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/pca.zarr
    jobid: 224
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:Ren_2021_10X_5_PBMCs
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpwm3mhh4l.neighbors.py
Activating conda environment: rapids_singlecell
INFO:root:AnnData object with n_obs × n_vars = 103843 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpnj6vmcfa.pca.py
Activating conda environment: rapids_singlecell
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/pca.zarr...
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182536/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 7818 × 11022
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
INFO:root:AnnData object with n_obs × n_vars = 344071 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 1049 × 11025
    obs: 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'Smartseq2', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
INFO:root:Subset to highly variable genes...
[Thu Mar  6 04:06:03 2025]
Finished job 264.
18 of 169 steps (11%) done
Select jobs to execute...

[Thu Mar  6 04:06:03 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182536/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182536/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182536/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182536/umap.done
    jobid: 263
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182536/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182536/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE182536
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

INFO:root:Using rapids_singlecell...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/highly_variable_genes.zarr"...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:06:06 2025]
Finished job 306.
19 of 169 steps (11%) done
Select jobs to execute...

[Thu Mar  6 04:06:06 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/umap.done
    jobid: 305
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Hatje_2024_SmartSeq2
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpio124c3e.umap.py
Activating conda environment: rapids_singlecell
INFO:root:AnnData object with n_obs × n_vars = 255782 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpaa9ct225.umap.py
Activating conda environment: rapids_singlecell
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182536/neighbors.zarr...
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182536/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182536/umap.zarr...
INFO:root:PCA with parameters: {'n_comps': 50}
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 60128 × 10000
    obs: '10X_3prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/neighbors.zarr...
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/umap.zarr...
[Thu Mar  6 04:06:19 2025]
Finished job 222.
20 of 169 steps (12%) done
Select jobs to execute...

[Thu Mar  6 04:06:19 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE158769/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE158769/pca.zarr
    jobid: 210
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE158769/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE158769
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182536/umap.done.
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:06:24 2025]
Finished job 263.
21 of 169 steps (12%) done
Select jobs to execute...

[Thu Mar  6 04:06:24 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182536/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE182536/umap
    jobid: 262
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182536/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE182536
    resources: tmpdir=/tmp

python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpxpg6n249.pca.py
Activating conda environment: rapids_singlecell
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpfefrmf7j.plot.py
Activating conda environment: scanpy
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/umap.done.
[Thu Mar  6 04:06:25 2025]
Finished job 305.
22 of 169 steps (13%) done
Select jobs to execute...

[Thu Mar  6 04:06:25 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/umap
    jobid: 304
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:Hatje_2024_SmartSeq2
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpb8az7y5f.plot.py
Activating conda environment: scanpy
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE182536...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182536/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182536/umap.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 25.581990278843694}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "qc_status"...
  9%|▉         | 1/11 [00:00<00:04,  2.48it/s]INFO:root:Plot color "modalities"...
 18%|█▊        | 2/11 [00:00<00:03,  2.71it/s]INFO:root:Plot color "tissue"...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:Hatje_2024_SmartSeq2...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/umap.zarr...
 27%|██▋       | 3/11 [00:01<00:02,  2.79it/s]INFO:root:Plot color "pathogen"...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 190.65776930409913}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "dataset_id"...
 36%|███▋      | 4/11 [00:01<00:02,  2.86it/s]INFO:root:Plot color "Cross_tissue_broad"...
  9%|▉         | 1/11 [00:00<00:04,  2.43it/s]INFO:root:Plot color "infection_stage"...
 45%|████▌     | 5/11 [00:01<00:02,  2.79it/s]INFO:root:Plot color "infection_stage"...
 18%|█▊        | 2/11 [00:00<00:03,  2.90it/s]INFO:root:Plot color "Lindeboom_broad"...
 55%|█████▍    | 6/11 [00:02<00:01,  2.72it/s]INFO:root:Plot color "infection_status"...
 27%|██▋       | 3/11 [00:01<00:03,  2.33it/s]INFO:root:Plot color "pathogen"...
 64%|██████▎   | 7/11 [00:02<00:01,  2.75it/s]INFO:root:Plot color "Lindeboom_broad"...
 36%|███▋      | 4/11 [00:01<00:02,  2.81it/s]INFO:root:Plot color "tissue"...
INFO:root:Using rapids_singlecell...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE158769/highly_variable_genes.zarr"...
 45%|████▌     | 5/11 [00:01<00:01,  3.10it/s]INFO:root:Plot color "Compartment_prediction"...
 73%|███████▎  | 8/11 [00:03<00:01,  2.41it/s]INFO:root:Plot color "Compartment_prediction"...
 55%|█████▍    | 6/11 [00:02<00:01,  3.11it/s]INFO:root:Plot color "study"...
 64%|██████▎   | 7/11 [00:02<00:01,  3.34it/s]INFO:root:Plot color "modalities"...
 82%|████████▏ | 9/11 [00:03<00:00,  2.24it/s]INFO:root:Plot color "dataset_id"...
 73%|███████▎  | 8/11 [00:02<00:00,  3.48it/s]INFO:root:Plot color "Cross_tissue_broad"...
 91%|█████████ | 10/11 [00:03<00:00,  2.42it/s]INFO:root:Plot color "study"...
 82%|████████▏ | 9/11 [00:02<00:00,  3.05it/s]INFO:root:Plot color "infection_status"...
100%|██████████| 11/11 [00:04<00:00,  2.56it/s]100%|██████████| 11/11 [00:04<00:00,  2.58it/s]
 91%|█████████ | 10/11 [00:03<00:00,  3.31it/s]INFO:root:Plot color "qc_status"...
[Thu Mar  6 04:06:31 2025]
Finished job 262.
23 of 169 steps (14%) done
Select jobs to execute...

[Thu Mar  6 04:06:31 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/pca
    jobid: 205
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Reyes_2020
    resources: tmpdir=/tmp

100%|██████████| 11/11 [00:03<00:00,  3.40it/s]100%|██████████| 11/11 [00:03<00:00,  3.13it/s]
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp00pa1d8g.plot.py
Activating conda environment: scanpy
[Thu Mar  6 04:06:32 2025]
Finished job 304.
24 of 169 steps (14%) done
Select jobs to execute...

[Thu Mar  6 04:06:32 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/pca
    jobid: 199
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE182159_Liver
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpor0yarmp.plot.py
Activating conda environment: scanpy
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:Reyes_2020...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/pca.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 6.134592969756457}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "modalities"...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE182159_Liver...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/pca.zarr...
  9%|▉         | 1/11 [00:00<00:06,  1.46it/s]INFO:root:Plot color "infection_stage"...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 2.580079208431699}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "modalities"...
 18%|█▊        | 2/11 [00:01<00:06,  1.38it/s]INFO:root:Plot color "Lindeboom_broad"...
  9%|▉         | 1/11 [00:00<00:08,  1.19it/s]INFO:root:Plot color "infection_stage"...
 27%|██▋       | 3/11 [00:02<00:06,  1.17it/s]INFO:root:Plot color "tissue"...
 18%|█▊        | 2/11 [00:01<00:08,  1.09it/s]INFO:root:Plot color "Lindeboom_broad"...
 36%|███▋      | 4/11 [00:02<00:05,  1.38it/s]INFO:root:Plot color "dataset_id"...
 45%|████▌     | 5/11 [00:03<00:03,  1.51it/s]INFO:root:Plot color "qc_status"...
 27%|██▋       | 3/11 [00:03<00:09,  1.17s/it]INFO:root:Plot color "tissue"...
 55%|█████▍    | 6/11 [00:04<00:03,  1.51it/s]INFO:root:Plot color "study"...
 64%|██████▎   | 7/11 [00:04<00:02,  1.51it/s]INFO:root:Plot color "pathogen"...
 36%|███▋      | 4/11 [00:04<00:07,  1.03s/it]INFO:root:Plot color "pathogen"...
 73%|███████▎  | 8/11 [00:05<00:01,  1.60it/s]INFO:root:Plot color "Cross_tissue_broad"...
 45%|████▌     | 5/11 [00:04<00:05,  1.05it/s]INFO:root:Plot color "dataset_id"...
INFO:root:PCA with parameters: {'n_comps': 50}
 82%|████████▏ | 9/11 [00:06<00:01,  1.39it/s]INFO:root:Plot color "infection_status"...
 55%|█████▍    | 6/11 [00:05<00:04,  1.07it/s]INFO:root:Plot color "study"...
 91%|█████████ | 10/11 [00:07<00:00,  1.36it/s]INFO:root:Plot color "Compartment_prediction"...
 64%|██████▎   | 7/11 [00:06<00:03,  1.11it/s]INFO:root:Plot color "qc_status"...
100%|██████████| 11/11 [00:07<00:00,  1.41it/s]100%|██████████| 11/11 [00:07<00:00,  1.42it/s]
[Thu Mar  6 04:06:42 2025]
Finished job 205.
25 of 169 steps (15%) done
Select jobs to execute...

[Thu Mar  6 04:06:42 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE187515/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE187515/pca.zarr
    jobid: 190
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE187515/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE187515
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

 73%|███████▎  | 8/11 [00:07<00:02,  1.12it/s]INFO:root:Plot color "infection_status"...
 82%|████████▏ | 9/11 [00:08<00:01,  1.10it/s]INFO:root:Plot color "Compartment_prediction"...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 84354 × 10000
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
 91%|█████████ | 10/11 [00:09<00:00,  1.10it/s]INFO:root:Plot color "Cross_tissue_broad"...
100%|██████████| 11/11 [00:10<00:00,  1.14it/s]100%|██████████| 11/11 [00:10<00:00,  1.08it/s]
INFO:root:AnnData object with n_obs × n_vars = 481256 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
INFO:root:Subset to highly variable genes...
[Thu Mar  6 04:06:46 2025]
Finished job 199.
26 of 169 steps (15%) done
Select jobs to execute...

[Thu Mar  6 04:06:46 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/pca
    jobid: 185
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Lindeboom_2024_NP
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp_wwhph3a.pca.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp_n2eeq5h.plot.py
Activating conda environment: scanpy
[Thu Mar  6 04:06:47 2025]
Finished job 194.
27 of 169 steps (16%) done
Select jobs to execute...

[Thu Mar  6 04:06:47 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/pca
    jobid: 241
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/pca
    wildcards: dataset=t_cells, file_id=filter:GSE162097_PBMCs
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpbb0a65qr.plot.py
Activating conda environment: scanpy
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:Lindeboom_2024_NP...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/pca.zarr...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE162097_PBMCs...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/pca.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 30.372057706909644}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "Cross_tissue_broad"...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
  9%|▉         | 1/11 [00:00<00:04,  2.49it/s]INFO:root:Plot color "qc_status"...
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 6.570949830798042}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "qc_status"...
 18%|█▊        | 2/11 [00:00<00:03,  2.85it/s]INFO:root:Plot color "infection_stage"...
INFO:root:Using rapids_singlecell...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE187515/highly_variable_genes.zarr"...
 27%|██▋       | 3/11 [00:01<00:02,  2.98it/s]INFO:root:Plot color "modalities"...
  9%|▉         | 1/11 [00:00<00:06,  1.48it/s]INFO:root:Plot color "modalities"...
 36%|███▋      | 4/11 [00:01<00:02,  3.18it/s]INFO:root:Plot color "study"...
 45%|████▌     | 5/11 [00:01<00:01,  3.24it/s]INFO:root:Plot color "Compartment_prediction"...
 18%|█▊        | 2/11 [00:01<00:05,  1.70it/s]INFO:root:Plot color "infection_status"...
 55%|█████▍    | 6/11 [00:01<00:01,  3.16it/s]INFO:root:Plot color "pathogen"...
 64%|██████▎   | 7/11 [00:02<00:01,  3.28it/s]INFO:root:Plot color "infection_status"...
 27%|██▋       | 3/11 [00:01<00:04,  1.61it/s]INFO:root:Plot color "Lindeboom_broad"...
 73%|███████▎  | 8/11 [00:02<00:00,  3.04it/s]INFO:root:Plot color "dataset_id"...
 82%|████████▏ | 9/11 [00:02<00:00,  3.17it/s]INFO:root:Plot color "Lindeboom_broad"...
 36%|███▋      | 4/11 [00:02<00:05,  1.26it/s]INFO:root:Plot color "infection_stage"...
 91%|█████████ | 10/11 [00:03<00:00,  2.43it/s]INFO:root:Plot color "tissue"...
100%|██████████| 11/11 [00:03<00:00,  2.71it/s]100%|██████████| 11/11 [00:03<00:00,  2.90it/s]
 45%|████▌     | 5/11 [00:03<00:04,  1.33it/s]INFO:root:Plot color "tissue"...
[Thu Mar  6 04:06:55 2025]
Finished job 241.
28 of 169 steps (17%) done
Select jobs to execute...

[Thu Mar  6 04:06:55 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/pca.zarr
    jobid: 232
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE234241_PBMCs
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

 55%|█████▍    | 6/11 [00:04<00:03,  1.47it/s]INFO:root:Plot color "pathogen"...
 64%|██████▎   | 7/11 [00:04<00:02,  1.50it/s]INFO:root:Plot color "dataset_id"...
 73%|███████▎  | 8/11 [00:05<00:01,  1.61it/s]INFO:root:Plot color "Compartment_prediction"...
 82%|████████▏ | 9/11 [00:05<00:01,  1.59it/s]INFO:root:Plot color "study"...
 91%|█████████ | 10/11 [00:06<00:00,  1.66it/s]INFO:root:Plot color "Cross_tissue_broad"...
100%|██████████| 11/11 [00:07<00:00,  1.51it/s]100%|██████████| 11/11 [00:07<00:00,  1.51it/s]
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:06:59 2025]
Finished job 185.
29 of 169 steps (17%) done
Select jobs to execute...

[Thu Mar  6 04:06:59 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/neighbors.zarr
    jobid: 336
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE259231_10X_5
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpngv9fe40.pca.py
Activating conda environment: rapids_singlecell
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp7sa0r_zt.neighbors.py
Activating conda environment: rapids_singlecell
INFO:root:Using rapids_singlecell...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/highly_variable_genes.zarr"...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 489802 × 11025
    obs: '10X_3prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
INFO:root:AnnData object with n_obs × n_vars = 122570 × 11020
    obs: '10X_5prime_ECCITE-seq', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
INFO:root:AnnData object with n_obs × n_vars = 14434 × 11024
    obs: 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'Seq_well', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 4060 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
INFO:root:PCA with parameters: {'n_comps': 50}
[Thu Mar  6 04:07:33 2025]
Finished job 336.
30 of 169 steps (18%) done
Select jobs to execute...

[Thu Mar  6 04:07:33 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/umap.done
    jobid: 335
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/neighbors.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE259231_10X_5
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 103843 × 10000
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp8ckmuk6y.umap.py
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:07:40 2025]
Finished job 196.
31 of 169 steps (18%) done
Select jobs to execute...

[Thu Mar  6 04:07:40 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/neighbors.zarr
    jobid: 273
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE217930
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/neighbors.zarr...
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/umap.zarr...
INFO:root:PCA with parameters: {'n_comps': 50}
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 14434 × 10000
    obs: 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'Seq_well', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp140kqtb4.neighbors.py
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:07:48 2025]
Finished job 232.
32 of 169 steps (19%) done
Select jobs to execute...

[Thu Mar  6 04:07:48 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/pca
    jobid: 231
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE234241_PBMCs
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp_59wy4fp.plot.py
Activating conda environment: scanpy
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE234241_PBMCs...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/pca.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 13.856172925038104}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "pathogen"...
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/umap.done.
[Thu Mar  6 04:07:51 2025]
Finished job 335.
33 of 169 steps (20%) done
Select jobs to execute...

[Thu Mar  6 04:07:51 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/umap
    jobid: 334
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE259231_10X_5
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
  9%|▉         | 1/11 [00:00<00:04,  2.31it/s]INFO:root:Plot color "modalities"...
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpf8u9j0o7.plot.py
Activating conda environment: scanpy
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/pca.zarr...
 18%|█▊        | 2/11 [00:00<00:03,  2.43it/s]INFO:root:Plot color "tissue"...
 27%|██▋       | 3/11 [00:01<00:03,  2.31it/s]INFO:root:Plot color "Lindeboom_broad"...
 36%|███▋      | 4/11 [00:02<00:04,  1.64it/s]INFO:root:Plot color "infection_stage"...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE259231_10X_5...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/umap.zarr...
 45%|████▌     | 5/11 [00:02<00:03,  1.72it/s]INFO:root:Plot color "study"...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 49.26108374384236}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "pathogen"...
  9%|▉         | 1/11 [00:00<00:02,  3.43it/s]INFO:root:Plot color "Lindeboom_broad"...
 55%|█████▍    | 6/11 [00:03<00:02,  1.92it/s]INFO:root:Plot color "Cross_tissue_broad"...
 18%|█▊        | 2/11 [00:00<00:03,  2.52it/s]INFO:root:Plot color "Cross_tissue_broad"...
 27%|██▋       | 3/11 [00:01<00:02,  2.83it/s]INFO:root:Plot color "qc_status"...
 64%|██████▎   | 7/11 [00:03<00:02,  1.59it/s]INFO:root:Plot color "Compartment_prediction"...
 36%|███▋      | 4/11 [00:01<00:02,  3.01it/s]INFO:root:Plot color "modalities"...
 45%|████▌     | 5/11 [00:01<00:01,  3.23it/s]INFO:root:Plot color "tissue"...
 73%|███████▎  | 8/11 [00:04<00:01,  1.72it/s]INFO:root:Plot color "dataset_id"...
 55%|█████▍    | 6/11 [00:01<00:01,  3.43it/s]INFO:root:Plot color "dataset_id"...
 82%|████████▏ | 9/11 [00:04<00:01,  1.92it/s]INFO:root:Plot color "qc_status"...
 64%|██████▎   | 7/11 [00:02<00:01,  3.35it/s]INFO:root:Plot color "study"...
 73%|███████▎  | 8/11 [00:02<00:00,  3.48it/s]INFO:root:Plot color "infection_status"...
 91%|█████████ | 10/11 [00:05<00:00,  2.02it/s]INFO:root:Plot color "infection_status"...
 82%|████████▏ | 9/11 [00:02<00:00,  3.02it/s]INFO:root:Plot color "infection_stage"...
100%|██████████| 11/11 [00:05<00:00,  2.13it/s]100%|██████████| 11/11 [00:05<00:00,  1.94it/s]
 91%|█████████ | 10/11 [00:03<00:00,  3.05it/s]INFO:root:Plot color "Compartment_prediction"...
[Thu Mar  6 04:07:57 2025]
Finished job 231.
34 of 169 steps (20%) done
Select jobs to execute...

[Thu Mar  6 04:07:57 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/pca.zarr
    jobid: 218
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:Ren_2021_10X_3_BALF
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

100%|██████████| 11/11 [00:03<00:00,  3.13it/s]100%|██████████| 11/11 [00:03<00:00,  3.13it/s]
[Thu Mar  6 04:08:01 2025]
Finished job 334.
35 of 169 steps (21%) done
Select jobs to execute...

[Thu Mar  6 04:08:01 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/pca
    jobid: 213
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Hatje_2024_Liver
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp8hwc6mj8.pca.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmphpg6w1zt.plot.py
Activating conda environment: scanpy
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:Hatje_2024_Liver...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/pca.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 20.220402386007482}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "pathogen"...
  9%|▉         | 1/11 [00:00<00:04,  2.29it/s]INFO:root:Plot color "Lindeboom_broad"...
INFO:root:Using rapids_singlecell...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/highly_variable_genes.zarr"...
 18%|█▊        | 2/11 [00:01<00:06,  1.45it/s]INFO:root:Plot color "infection_status"...
 27%|██▋       | 3/11 [00:01<00:04,  1.83it/s]INFO:root:Plot color "modalities"...
 36%|███▋      | 4/11 [00:02<00:03,  2.11it/s]INFO:root:Plot color "qc_status"...
 45%|████▌     | 5/11 [00:02<00:02,  2.25it/s]INFO:root:Plot color "tissue"...
 55%|█████▍    | 6/11 [00:02<00:02,  2.43it/s]INFO:root:Plot color "Compartment_prediction"...
 64%|██████▎   | 7/11 [00:03<00:01,  2.12it/s]INFO:root:Plot color "Cross_tissue_broad"...
 73%|███████▎  | 8/11 [00:04<00:01,  1.92it/s]INFO:root:Plot color "study"...
 82%|████████▏ | 9/11 [00:04<00:00,  2.13it/s]INFO:root:Plot color "infection_stage"...
 91%|█████████ | 10/11 [00:04<00:00,  2.27it/s]INFO:root:Plot color "dataset_id"...
100%|██████████| 11/11 [00:05<00:00,  2.42it/s]100%|██████████| 11/11 [00:05<00:00,  2.16it/s]
[Thu Mar  6 04:08:11 2025]
Finished job 213.
36 of 169 steps (21%) done
Select jobs to execute...

[Thu Mar  6 04:08:11 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/neighbors.zarr
    jobid: 315
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Ren_2021_10X_3_PBMCs
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp35dtwnwq.neighbors.py
Activating conda environment: rapids_singlecell
INFO:root:PCA with parameters: {'n_comps': 50}
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 105 × 11025
    obs: '10X_3prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
INFO:root:PCA with parameters: {'n_comps': 50}
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 105 × 9258
    obs: '10X_3prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 273942 × 10000
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
[Thu Mar  6 04:08:29 2025]
Finished job 218.
37 of 169 steps (22%) done
Select jobs to execute...

[Thu Mar  6 04:08:29 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/pca
    jobid: 217
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Ren_2021_10X_3_BALF
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp686hu7de.plot.py
Activating conda environment: scanpy
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:Ren_2021_10X_3_BALF...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/pca.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 200.0}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "dataset_id"...
[Thu Mar  6 04:08:32 2025]
Finished job 208.
38 of 169 steps (22%) done
Select jobs to execute...

[Thu Mar  6 04:08:32 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/neighbors.zarr
    jobid: 294
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Stephenson_2021
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

  9%|▉         | 1/11 [00:00<00:02,  3.89it/s]INFO:root:Plot color "Cross_tissue_broad"...
 18%|█▊        | 2/11 [00:00<00:02,  3.82it/s]INFO:root:Plot color "pathogen"...
 27%|██▋       | 3/11 [00:00<00:01,  4.13it/s]INFO:root:Plot color "qc_status"...
 36%|███▋      | 4/11 [00:00<00:01,  4.26it/s]INFO:root:Plot color "tissue"...
 45%|████▌     | 5/11 [00:01<00:01,  4.50it/s]INFO:root:Plot color "study"...
 55%|█████▍    | 6/11 [00:01<00:01,  4.52it/s]INFO:root:Plot color "modalities"...
 64%|██████▎   | 7/11 [00:01<00:00,  4.37it/s]INFO:root:Plot color "Lindeboom_broad"...
 73%|███████▎  | 8/11 [00:02<00:00,  3.09it/s]INFO:root:Plot color "Compartment_prediction"...
 82%|████████▏ | 9/11 [00:02<00:00,  3.01it/s]INFO:root:Plot color "infection_stage"...
 91%|█████████ | 10/11 [00:02<00:00,  3.24it/s]INFO:root:Plot color "infection_status"...
100%|██████████| 11/11 [00:02<00:00,  3.57it/s]100%|██████████| 11/11 [00:02<00:00,  3.69it/s]
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:08:37 2025]
Finished job 217.
39 of 169 steps (23%) done
Select jobs to execute...

[Thu Mar  6 04:08:37 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE173231/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE173231/pca.zarr
    jobid: 204
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE173231/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE173231
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpe_4_l835.neighbors.py
Activating conda environment: rapids_singlecell
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpj8tj28bt.pca.py
Activating conda environment: rapids_singlecell
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/pca.zarr...
INFO:root:Using rapids_singlecell...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE173231/highly_variable_genes.zarr"...
INFO:root:AnnData object with n_obs × n_vars = 11845 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
INFO:root:PCA with parameters: {'n_comps': 50}
INFO:root:PCA with parameters: {'n_comps': 50}
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 84354 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 430171 × 10000
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE173231/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 11845 × 10000
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
[Thu Mar  6 04:09:27 2025]
Finished job 273.
40 of 169 steps (24%) done
Select jobs to execute...

[Thu Mar  6 04:09:27 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/umap.done
    jobid: 272
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/pca.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/neighbors.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE217930
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:09:31 2025]
Finished job 204.
41 of 169 steps (24%) done
[Thu Mar  6 04:09:31 2025]
Finished job 180.
42 of 169 steps (25%) done
Select jobs to execute...

[Thu Mar  6 04:09:31 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/neighbors.zarr
    jobid: 252
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:COMBAT_2022
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpz_kexf2w.umap.py
Activating conda environment: rapids_singlecell

[Thu Mar  6 04:09:36 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE173231/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE173231/pca
    jobid: 203
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE173231/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE173231
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
Select jobs to execute...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp_2v8xm3m.neighbors.py
Activating conda environment: rapids_singlecell
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/neighbors.zarr...
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp342hsybx.plot.py
Activating conda environment: scanpy
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/umap.zarr...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE173231...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE173231/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE173231/pca.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 16.884761502743775}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "Cross_tissue_broad"...
  9%|▉         | 1/11 [00:00<00:06,  1.52it/s]INFO:root:Plot color "pathogen"...
 18%|█▊        | 2/11 [00:01<00:04,  2.12it/s]INFO:root:Plot color "tissue"...
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
 27%|██▋       | 3/11 [00:01<00:03,  2.43it/s]INFO:root:Plot color "modalities"...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 60128 × 11025
    obs: '10X_3prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
 36%|███▋      | 4/11 [00:01<00:02,  2.59it/s]INFO:root:Plot color "dataset_id"...
 45%|████▌     | 5/11 [00:02<00:02,  2.67it/s]INFO:root:Plot color "qc_status"...
 55%|█████▍    | 6/11 [00:02<00:01,  2.64it/s]INFO:root:Plot color "infection_status"...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/pca.zarr...
 64%|██████▎   | 7/11 [00:02<00:01,  2.65it/s]INFO:root:Plot color "study"...
 73%|███████▎  | 8/11 [00:03<00:01,  2.73it/s]INFO:root:Plot color "Lindeboom_broad"...
 82%|████████▏ | 9/11 [00:04<00:01,  1.90it/s]INFO:root:Plot color "infection_stage"...
 91%|█████████ | 10/11 [00:04<00:00,  2.13it/s]INFO:root:Plot color "Compartment_prediction"...
[Thu Mar  6 04:09:44 2025]
Finished job 315.
43 of 169 steps (25%) done

[Thu Mar  6 04:09:44 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/umap.done
    jobid: 314
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/pca.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/neighbors.zarr
    wildcards: dataset=t_cells, file_id=filter:Ren_2021_10X_3_PBMCs
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

100%|██████████| 11/11 [00:04<00:00,  2.19it/s]100%|██████████| 11/11 [00:04<00:00,  2.30it/s]
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:09:47 2025]
Finished job 203.
44 of 169 steps (26%) done
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/umap.done.
[Thu Mar  6 04:09:47 2025]
Finished job 272.
45 of 169 steps (27%) done
Select jobs to execute...

[Thu Mar  6 04:09:47 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/pca.zarr
    jobid: 198
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:Lindeboom_2024_PBMCs
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp_2e48s0i.umap.py
Activating conda environment: rapids_singlecell

[Thu Mar  6 04:09:51 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE217930/umap
    jobid: 271
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE217930
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
Select jobs to execute...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpnwzsf_ed.pca.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpxuxlhmj9.plot.py
Activating conda environment: scanpy
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE217930...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/umap.zarr...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/neighbors.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 2.3709604760888636}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "qc_status"...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/umap.zarr...
  9%|▉         | 1/11 [00:00<00:09,  1.06it/s]INFO:root:Plot color "infection_status"...
 18%|█▊        | 2/11 [00:01<00:07,  1.14it/s]INFO:root:Plot color "Cross_tissue_broad"...
INFO:root:PCA with parameters: {'n_comps': 50}
 27%|██▋       | 3/11 [00:02<00:07,  1.07it/s]INFO:root:Plot color "pathogen"...
INFO:root:Using rapids_singlecell...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/highly_variable_genes.zarr"...
 36%|███▋      | 4/11 [00:03<00:06,  1.12it/s]INFO:root:Plot color "infection_stage"...
 45%|████▌     | 5/11 [00:04<00:05,  1.09it/s]INFO:root:Plot color "study"...
 55%|█████▍    | 6/11 [00:05<00:04,  1.12it/s]INFO:root:Plot color "Compartment_prediction"...
INFO:root:PCA with parameters: {'n_comps': 50}
 64%|██████▎   | 7/11 [00:06<00:03,  1.06it/s]INFO:root:Plot color "tissue"...
 73%|███████▎  | 8/11 [00:07<00:02,  1.10it/s]INFO:root:Plot color "Lindeboom_broad"...
 82%|████████▏ | 9/11 [00:08<00:02,  1.03s/it]INFO:root:Plot color "modalities"...
 91%|█████████ | 10/11 [00:09<00:00,  1.03it/s]INFO:root:Plot color "dataset_id"...
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/umap.done.
[Thu Mar  6 04:10:04 2025]
Finished job 314.
46 of 169 steps (27%) done

[Thu Mar  6 04:10:04 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/umap
    jobid: 313
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:Ren_2021_10X_3_PBMCs
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpqpfj7tl6.plot.py
Activating conda environment: scanpy
100%|██████████| 11/11 [00:10<00:00,  1.07it/s]100%|██████████| 11/11 [00:10<00:00,  1.07it/s]
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 344071 × 10000
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
[Thu Mar  6 04:10:05 2025]
Finished job 271.
47 of 169 steps (28%) done
Select jobs to execute...

[Thu Mar  6 04:10:05 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/neighbors.zarr
    jobid: 309
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Ren_2021_10X_3_BALF
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

INFO:root:Wildcard string: dataset: t_cells
file_id: filter:Ren_2021_10X_3_PBMCs...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/umap.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 3.326237360298031}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "Cross_tissue_broad"...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE187515/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 122570 × 10000
    obs: '10X_5prime_ECCITE-seq', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
  9%|▉         | 1/11 [00:01<00:11,  1.18s/it]INFO:root:Plot color "pathogen"...
 18%|█▊        | 2/11 [00:01<00:07,  1.18it/s]INFO:root:Plot color "tissue"...
 27%|██▋       | 3/11 [00:02<00:05,  1.36it/s]INFO:root:Plot color "infection_stage"...
 36%|███▋      | 4/11 [00:03<00:04,  1.42it/s]INFO:root:Plot color "infection_status"...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:10:10 2025]
Finished job 230.
48 of 169 steps (28%) done
[Thu Mar  6 04:10:10 2025]
Finished job 190.
49 of 169 steps (29%) done
Select jobs to execute...

[Thu Mar  6 04:10:10 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE187515/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE187515/pca
    jobid: 189
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE187515/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE187515
    resources: tmpdir=/tmp

 45%|████▌     | 5/11 [00:03<00:04,  1.45it/s]INFO:root:Plot color "study"...
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp8swms52g.neighbors.py
Activating conda environment: rapids_singlecell

[Thu Mar  6 04:10:11 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/neighbors.zarr
    jobid: 327
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:ESKD_2024
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpt4lzz92f.plot.py
Activating conda environment: scanpy
 55%|█████▍    | 6/11 [00:04<00:03,  1.44it/s]INFO:root:Plot color "qc_status"...
 64%|██████▎   | 7/11 [00:05<00:02,  1.47it/s]INFO:root:Plot color "dataset_id"...
 73%|███████▎  | 8/11 [00:05<00:01,  1.52it/s]INFO:root:Plot color "modalities"...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE187515...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE187515/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE187515/pca.zarr...
 82%|████████▏ | 9/11 [00:06<00:01,  1.55it/s]INFO:root:Plot color "Compartment_prediction"...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 1.6317206494248184}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "Cross_tissue_broad"...
 91%|█████████ | 10/11 [00:06<00:00,  1.52it/s]INFO:root:Plot color "Lindeboom_broad"...
  9%|▉         | 1/11 [00:01<00:11,  1.19s/it]INFO:root:Plot color "infection_stage"...
100%|██████████| 11/11 [00:08<00:00,  1.26it/s]100%|██████████| 11/11 [00:08<00:00,  1.36it/s]
 18%|█▊        | 2/11 [00:02<00:10,  1.16s/it]INFO:root:Plot color "tissue"...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/pca.zarr...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:10:17 2025]
Finished job 313.
50 of 169 steps (30%) done
Select jobs to execute...

[Thu Mar  6 04:10:17 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE217930/pca
    jobid: 193
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE217930
    resources: tmpdir=/tmp

INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
Select jobs to execute...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
 27%|██▋       | 3/11 [00:03<00:08,  1.12s/it]INFO:root:Plot color "infection_status"...
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpwa8ngx_k.neighbors.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmper2ei5ma.plot.py
Activating conda environment: scanpy
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 105 × 11025
    obs: '10X_3prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
 36%|███▋      | 4/11 [00:04<00:07,  1.12s/it]INFO:root:Plot color "Lindeboom_broad"...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE217930...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/pca.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 2.3709604760888636}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "Lindeboom_broad"...
 45%|████▌     | 5/11 [00:06<00:07,  1.29s/it]INFO:root:Plot color "Compartment_prediction"...
[Thu Mar  6 04:10:20 2025]
Finished job 309.
51 of 169 steps (30%) done

[Thu Mar  6 04:10:20 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/umap.done
    jobid: 308
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/pca.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/neighbors.zarr
    wildcards: dataset=t_cells, file_id=filter:Ren_2021_10X_3_BALF
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

  9%|▉         | 1/11 [00:01<00:13,  1.35s/it]INFO:root:Plot color "Cross_tissue_broad"...
 55%|█████▍    | 6/11 [00:07<00:06,  1.29s/it]INFO:root:Plot color "study"...
INFO:root:AnnData object with n_obs × n_vars = 171002 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
 18%|█▊        | 2/11 [00:02<00:10,  1.16s/it]INFO:root:Plot color "infection_stage"...
 64%|██████▎   | 7/11 [00:08<00:04,  1.22s/it]INFO:root:Plot color "qc_status"...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/pca.zarr...
 27%|██▋       | 3/11 [00:03<00:08,  1.05s/it]INFO:root:Plot color "pathogen"...
 73%|███████▎  | 8/11 [00:09<00:03,  1.20s/it]INFO:root:Plot color "modalities"...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpe1uqst76.umap.py
Activating conda environment: rapids_singlecell
 36%|███▋      | 4/11 [00:04<00:06,  1.04it/s]INFO:root:Plot color "Compartment_prediction"...
 82%|████████▏ | 9/11 [00:10<00:02,  1.16s/it]INFO:root:Plot color "dataset_id"...
 45%|████▌     | 5/11 [00:05<00:06,  1.00s/it]INFO:root:Plot color "qc_status"...
 91%|█████████ | 10/11 [00:11<00:01,  1.18s/it]INFO:root:Plot color "pathogen"...
 55%|█████▍    | 6/11 [00:06<00:04,  1.02it/s]INFO:root:Plot color "modalities"...
 64%|██████▎   | 7/11 [00:06<00:03,  1.07it/s]INFO:root:Plot color "study"...
100%|██████████| 11/11 [00:12<00:00,  1.14s/it]100%|██████████| 11/11 [00:12<00:00,  1.18s/it]
[Thu Mar  6 04:10:27 2025]
Finished job 189.
52 of 169 steps (31%) done
Select jobs to execute...

[Thu Mar  6 04:10:27 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE180268/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE180268/pca.zarr
    jobid: 184
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE180268/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE180268
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

 73%|███████▎  | 8/11 [00:07<00:02,  1.11it/s]INFO:root:Plot color "dataset_id"...
 82%|████████▏ | 9/11 [00:08<00:01,  1.13it/s]INFO:root:Plot color "infection_status"...
 91%|█████████ | 10/11 [00:09<00:00,  1.16it/s]INFO:root:Plot color "tissue"...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/neighbors.zarr...
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/umap.zarr...
100%|██████████| 11/11 [00:10<00:00,  1.18it/s]100%|██████████| 11/11 [00:10<00:00,  1.07it/s]
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:10:30 2025]
Finished job 193.
53 of 169 steps (31%) done
Select jobs to execute...

[Thu Mar  6 04:10:30 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/pca
    jobid: 235
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE259231_10X_5
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpr4924m43.pca.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpw6ta1k2g.plot.py
Activating conda environment: scanpy
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE259231_10X_5...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/pca.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 49.26108374384236}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "infection_status"...
  9%|▉         | 1/11 [00:00<00:03,  2.86it/s]INFO:root:Plot color "qc_status"...
 18%|█▊        | 2/11 [00:00<00:02,  3.07it/s]INFO:root:Plot color "tissue"...
 27%|██▋       | 3/11 [00:00<00:02,  3.35it/s]INFO:root:Plot color "infection_stage"...
 36%|███▋      | 4/11 [00:01<00:02,  3.04it/s]INFO:root:Plot color "Cross_tissue_broad"...
 45%|████▌     | 5/11 [00:01<00:01,  3.09it/s]INFO:root:Plot color "Lindeboom_broad"...
 55%|█████▍    | 6/11 [00:02<00:01,  2.80it/s]INFO:root:Plot color "study"...
 64%|██████▎   | 7/11 [00:02<00:01,  3.04it/s]INFO:root:Plot color "dataset_id"...
 73%|███████▎  | 8/11 [00:02<00:00,  3.23it/s]INFO:root:Plot color "Compartment_prediction"...
 82%|████████▏ | 9/11 [00:02<00:00,  2.96it/s]INFO:root:Plot color "pathogen"...
 91%|█████████ | 10/11 [00:03<00:00,  3.09it/s]INFO:root:Plot color "modalities"...
100%|██████████| 11/11 [00:03<00:00,  3.26it/s]100%|██████████| 11/11 [00:03<00:00,  3.11it/s]
[Thu Mar  6 04:10:36 2025]
Finished job 235.
54 of 169 steps (32%) done
Select jobs to execute...

[Thu Mar  6 04:10:36 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/pca
    jobid: 179
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:COMBAT_2022
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
INFO:root:Using rapids_singlecell...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE180268/highly_variable_genes.zarr"...
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpc5b1rfe0.plot.py
Activating conda environment: scanpy
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/umap.done.
[Thu Mar  6 04:10:38 2025]
Finished job 308.
55 of 169 steps (33%) done
Select jobs to execute...

[Thu Mar  6 04:10:38 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/umap
    jobid: 307
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:Ren_2021_10X_3_BALF
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:COMBAT_2022...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/pca.zarr...
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmphahirhh_.plot.py
Activating conda environment: scanpy
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 0.46493138775045273}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "pathogen"...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:Ren_2021_10X_3_BALF...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/umap.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 200.0}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "Lindeboom_broad"...
  9%|▉         | 1/11 [00:00<00:05,  1.81it/s]INFO:root:Plot color "Cross_tissue_broad"...
 18%|█▊        | 2/11 [00:00<00:03,  2.66it/s]INFO:root:Plot color "Compartment_prediction"...
 27%|██▋       | 3/11 [00:01<00:02,  3.12it/s]INFO:root:Plot color "infection_stage"...
 36%|███▋      | 4/11 [00:01<00:01,  3.65it/s]INFO:root:Plot color "infection_status"...
 45%|████▌     | 5/11 [00:01<00:01,  3.95it/s]INFO:root:Plot color "modalities"...
 55%|█████▍    | 6/11 [00:01<00:01,  4.14it/s]INFO:root:Plot color "dataset_id"...
 64%|██████▎   | 7/11 [00:01<00:00,  4.26it/s]INFO:root:Plot color "study"...
 73%|███████▎  | 8/11 [00:02<00:00,  3.89it/s]INFO:root:Plot color "pathogen"...
 82%|████████▏ | 9/11 [00:02<00:00,  4.12it/s]INFO:root:Plot color "tissue"...
 91%|█████████ | 10/11 [00:02<00:00,  4.31it/s]INFO:root:Plot color "qc_status"...
  9%|▉         | 1/11 [00:03<00:30,  3.02s/it]INFO:root:Plot color "infection_status"...
100%|██████████| 11/11 [00:02<00:00,  4.46it/s]100%|██████████| 11/11 [00:02<00:00,  3.86it/s]
[Thu Mar  6 04:10:44 2025]
Finished job 307.
56 of 169 steps (33%) done
Select jobs to execute...

[Thu Mar  6 04:10:44 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE173231/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE173231/neighbors.zarr
    jobid: 288
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE173231/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE173231
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

 18%|█▊        | 2/11 [00:06<00:28,  3.13s/it]INFO:root:Plot color "Lindeboom_broad"...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpu24a0egw.neighbors.py
Activating conda environment: rapids_singlecell
 27%|██▋       | 3/11 [00:09<00:26,  3.29s/it]INFO:root:Plot color "study"...
 36%|███▋      | 4/11 [00:12<00:22,  3.16s/it]INFO:root:Plot color "Compartment_prediction"...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE173231/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 56313 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
 45%|████▌     | 5/11 [00:15<00:18,  3.12s/it]INFO:root:Plot color "modalities"...
 55%|█████▍    | 6/11 [00:18<00:15,  3.07s/it]INFO:root:Plot color "qc_status"...
 64%|██████▎   | 7/11 [00:21<00:12,  3.10s/it]INFO:root:Plot color "infection_stage"...
 73%|███████▎  | 8/11 [00:25<00:09,  3.31s/it]INFO:root:Plot color "Cross_tissue_broad"...
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE173231/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 11845 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
 82%|████████▏ | 9/11 [00:28<00:06,  3.33s/it]INFO:root:Plot color "tissue"...
[Thu Mar  6 04:11:11 2025]
Finished job 288.
57 of 169 steps (34%) done
Select jobs to execute...

[Thu Mar  6 04:11:11 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE173231/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE173231/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE173231/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE173231/umap.done
    jobid: 287
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE173231/pca.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE173231/neighbors.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE173231
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

 91%|█████████ | 10/11 [00:32<00:03,  3.24s/it]INFO:root:Plot color "dataset_id"...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
100%|██████████| 11/11 [00:35<00:00,  3.16s/it]100%|██████████| 11/11 [00:35<00:00,  3.18s/it]
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp7p5g4fuz.umap.py
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:11:16 2025]
Finished job 179.
58 of 169 steps (34%) done
Select jobs to execute...

[Thu Mar  6 04:11:16 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/pca.zarr
    jobid: 226
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:Ren_2021_10X_3_Sputum
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpbtwoq8cx.pca.py
Activating conda environment: rapids_singlecell
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 273942 × 11024
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE173231/neighbors.zarr...
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE173231/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE173231/umap.zarr...
[Thu Mar  6 04:11:24 2025]
Finished job 294.
59 of 169 steps (35%) done
Select jobs to execute...

[Thu Mar  6 04:11:24 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/umap.done
    jobid: 293
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/pca.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/neighbors.zarr
    wildcards: dataset=t_cells, file_id=filter:Stephenson_2021
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

INFO:root:Using rapids_singlecell...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/highly_variable_genes.zarr"...
INFO:root:PCA with parameters: {'n_comps': 50}
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp5zloaff2.umap.py
Activating conda environment: rapids_singlecell
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE173231/umap.done.
[Thu Mar  6 04:11:30 2025]
Finished job 287.
60 of 169 steps (36%) done
Select jobs to execute...

[Thu Mar  6 04:11:30 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE173231/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE173231/umap
    jobid: 286
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE173231/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE173231
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp3h6em8nq.plot.py
Activating conda environment: scanpy
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE173231...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE173231/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE173231/umap.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 16.884761502743775}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "Cross_tissue_broad"...
  9%|▉         | 1/11 [00:00<00:06,  1.46it/s]INFO:root:Plot color "Compartment_prediction"...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 255782 × 10000
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
 18%|█▊        | 2/11 [00:01<00:04,  1.85it/s]INFO:root:Plot color "study"...
 27%|██▋       | 3/11 [00:01<00:03,  2.18it/s]INFO:root:Plot color "pathogen"...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/neighbors.zarr...
 36%|███▋      | 4/11 [00:01<00:02,  2.39it/s]INFO:root:Plot color "infection_stage"...
 45%|████▌     | 5/11 [00:02<00:02,  2.51it/s]INFO:root:Plot color "infection_status"...
 55%|█████▍    | 6/11 [00:02<00:01,  2.55it/s]INFO:root:Plot color "tissue"...
 64%|██████▎   | 7/11 [00:02<00:01,  2.63it/s]INFO:root:Plot color "qc_status"...
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
 73%|███████▎  | 8/11 [00:03<00:01,  2.29it/s]INFO:root:Plot color "Lindeboom_broad"...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/umap.zarr...
 82%|████████▏ | 9/11 [00:04<00:01,  1.81it/s]INFO:root:Plot color "modalities"...
 91%|█████████ | 10/11 [00:04<00:00,  2.02it/s]INFO:root:Plot color "dataset_id"...
100%|██████████| 11/11 [00:05<00:00,  2.20it/s]100%|██████████| 11/11 [00:05<00:00,  2.19it/s]
[Thu Mar  6 04:11:38 2025]
Finished job 182.
61 of 169 steps (36%) done
Select jobs to execute...

[Thu Mar  6 04:11:38 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/neighbors.zarr
    jobid: 255
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Yoshida_2021
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

INFO:root:AnnData object with n_obs × n_vars = 104 × 11025
    obs: '10X_3prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
INFO:root:PCA with parameters: {'n_comps': 50}
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 104 × 10000
    obs: '10X_3prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:11:43 2025]
Finished job 286.
62 of 169 steps (37%) done
Select jobs to execute...

[Thu Mar  6 04:11:43 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/pca
    jobid: 221
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Ren_2021_10X_3_PBMCs
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp5ccy9azg.neighbors.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpivia52sp.plot.py
Activating conda environment: scanpy
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:Ren_2021_10X_3_PBMCs...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/pca.zarr...
[Thu Mar  6 04:11:46 2025]
Finished job 226.
63 of 169 steps (37%) done
Select jobs to execute...

[Thu Mar  6 04:11:46 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/pca
    jobid: 225
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Ren_2021_10X_3_Sputum
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 3.326237360298031}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "tissue"...
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpzbbjko4k.plot.py
Activating conda environment: scanpy
  9%|▉         | 1/11 [00:00<00:06,  1.47it/s]INFO:root:Plot color "infection_status"...
 18%|█▊        | 2/11 [00:01<00:06,  1.41it/s]INFO:root:Plot color "dataset_id"...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:Ren_2021_10X_3_Sputum...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/pca.zarr...
 27%|██▋       | 3/11 [00:02<00:05,  1.47it/s]INFO:root:Plot color "infection_stage"...
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/umap.done.
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 200.0}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "Lindeboom_broad"...
[Thu Mar  6 04:11:49 2025]
Finished job 293.
64 of 169 steps (38%) done
Select jobs to execute...

[Thu Mar  6 04:11:49 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/neighbors.zarr
    jobid: 321
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Ren_2021_10X_3_Sputum
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/pca.zarr...
 36%|███▋      | 4/11 [00:02<00:04,  1.43it/s]INFO:root:Plot color "Compartment_prediction"...
  9%|▉         | 1/11 [00:00<00:05,  1.85it/s]INFO:root:Plot color "study"...
 18%|█▊        | 2/11 [00:00<00:03,  2.92it/s]INFO:root:Plot color "qc_status"...
 27%|██▋       | 3/11 [00:00<00:02,  3.49it/s]INFO:root:Plot color "pathogen"...
 36%|███▋      | 4/11 [00:01<00:01,  3.92it/s]INFO:root:Plot color "infection_status"...
 45%|████▌     | 5/11 [00:03<00:04,  1.37it/s]INFO:root:Plot color "qc_status"...
 45%|████▌     | 5/11 [00:01<00:01,  4.08it/s]INFO:root:Plot color "tissue"...
 55%|█████▍    | 6/11 [00:01<00:01,  4.35it/s]INFO:root:Plot color "Compartment_prediction"...
 64%|██████▎   | 7/11 [00:01<00:00,  4.33it/s]INFO:root:Plot color "modalities"...
 55%|█████▍    | 6/11 [00:04<00:03,  1.39it/s]INFO:root:Plot color "Cross_tissue_broad"...
 73%|███████▎  | 8/11 [00:02<00:00,  4.33it/s]INFO:root:Plot color "dataset_id"...
 82%|████████▏ | 9/11 [00:02<00:00,  3.97it/s]INFO:root:Plot color "infection_stage"...
 91%|█████████ | 10/11 [00:02<00:00,  4.21it/s]INFO:root:Plot color "Cross_tissue_broad"...
100%|██████████| 11/11 [00:02<00:00,  3.58it/s]100%|██████████| 11/11 [00:02<00:00,  3.74it/s]
 64%|██████▎   | 7/11 [00:05<00:03,  1.09it/s]INFO:root:Plot color "pathogen"...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:11:52 2025]
Finished job 225.
65 of 169 steps (38%) done
Select jobs to execute...

[Thu Mar  6 04:11:52 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/umap
    jobid: 292
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:Stephenson_2021
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp7fy1xlyl.neighbors.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpa_gf6lcz.plot.py
Activating conda environment: scanpy
 73%|███████▎  | 8/11 [00:06<00:02,  1.18it/s]INFO:root:Plot color "modalities"...
 82%|████████▏ | 9/11 [00:06<00:01,  1.27it/s]INFO:root:Plot color "study"...
 91%|█████████ | 10/11 [00:07<00:00,  1.35it/s]INFO:root:Plot color "Lindeboom_broad"...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:Stephenson_2021...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/umap.zarr...
100%|██████████| 11/11 [00:08<00:00,  1.16it/s]100%|██████████| 11/11 [00:08<00:00,  1.26it/s]
[Thu Mar  6 04:11:55 2025]
Finished job 221.
66 of 169 steps (39%) done
Select jobs to execute...

[Thu Mar  6 04:11:55 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/neighbors.zarr
    jobid: 330
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE234241_PBMCs
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 0.7300815501091472}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "Lindeboom_broad"...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/pca.zarr...
  9%|▉         | 1/11 [00:02<00:23,  2.34s/it]INFO:root:Plot color "study"...
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 104 × 11025
    obs: '10X_3prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmprm8c8oq6.neighbors.py
Activating conda environment: rapids_singlecell
 18%|█▊        | 2/11 [00:04<00:18,  2.08s/it]INFO:root:Plot color "modalities"...
[Thu Mar  6 04:12:02 2025]
Finished job 321.
67 of 169 steps (40%) done
Select jobs to execute...

[Thu Mar  6 04:12:02 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/umap.done
    jobid: 320
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/pca.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/neighbors.zarr
    wildcards: dataset=t_cells, file_id=filter:Ren_2021_10X_3_Sputum
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

 27%|██▋       | 3/11 [00:06<00:16,  2.05s/it]INFO:root:Plot color "infection_stage"...
INFO:root:PCA with parameters: {'n_comps': 50}
 36%|███▋      | 4/11 [00:08<00:14,  2.01s/it]INFO:root:Plot color "infection_status"...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/pca.zarr...
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpuqqzalkq.umap.py
Activating conda environment: rapids_singlecell
 45%|████▌     | 5/11 [00:10<00:12,  2.01s/it]INFO:root:Plot color "tissue"...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE180268/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 56313 × 10000
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
 55%|█████▍    | 6/11 [00:12<00:09,  1.97s/it]INFO:root:Plot color "dataset_id"...
[Thu Mar  6 04:12:10 2025]
Finished job 184.
68 of 169 steps (40%) done
Select jobs to execute...

[Thu Mar  6 04:12:10 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE180268/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE180268/pca
    jobid: 183
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE180268/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE180268
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp6bpcrv2_.plot.py
Activating conda environment: scanpy
 64%|██████▎   | 7/11 [00:14<00:07,  1.95s/it]INFO:root:Plot color "pathogen"...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/neighbors.zarr...
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/umap.zarr...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE180268...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE180268/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE180268/pca.zarr...
 73%|███████▎  | 8/11 [00:15<00:05,  1.95s/it]INFO:root:Plot color "Cross_tissue_broad"...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 3.5515777884325113}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "infection_stage"...
  9%|▉         | 1/11 [00:00<00:06,  1.44it/s]INFO:root:Plot color "study"...
 18%|█▊        | 2/11 [00:01<00:05,  1.52it/s]INFO:root:Plot color "Compartment_prediction"...
 82%|████████▏ | 9/11 [00:18<00:04,  2.06s/it]INFO:root:Plot color "Compartment_prediction"...
 27%|██▋       | 3/11 [00:01<00:05,  1.51it/s]INFO:root:Plot color "infection_status"...
 36%|███▋      | 4/11 [00:02<00:04,  1.54it/s]INFO:root:Plot color "qc_status"...
 45%|████▌     | 5/11 [00:03<00:03,  1.55it/s]INFO:root:Plot color "modalities"...
 91%|█████████ | 10/11 [00:20<00:02,  2.04s/it]INFO:root:Plot color "qc_status"...
 55%|█████▍    | 6/11 [00:03<00:03,  1.59it/s]INFO:root:Plot color "pathogen"...
 64%|██████▎   | 7/11 [00:04<00:02,  1.62it/s]INFO:root:Plot color "dataset_id"...
 73%|███████▎  | 8/11 [00:05<00:01,  1.63it/s]INFO:root:Plot color "Cross_tissue_broad"...
100%|██████████| 11/11 [00:22<00:00,  2.02s/it]100%|██████████| 11/11 [00:22<00:00,  2.02s/it]
 82%|████████▏ | 9/11 [00:05<00:01,  1.47it/s]INFO:root:Plot color "tissue"...
[Thu Mar  6 04:12:19 2025]
Finished job 292.
69 of 169 steps (41%) done
Select jobs to execute...

[Thu Mar  6 04:12:19 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE180268/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE180268/neighbors.zarr
    jobid: 258
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE180268/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE180268
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

 91%|█████████ | 10/11 [00:06<00:00,  1.48it/s]INFO:root:Plot color "Lindeboom_broad"...
100%|██████████| 11/11 [00:07<00:00,  1.25it/s]100%|██████████| 11/11 [00:07<00:00,  1.44it/s]
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 14434 × 11024
    obs: 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'Seq_well', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/umap.done.
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:12:23 2025]
Finished job 320.
70 of 169 steps (41%) done
[Thu Mar  6 04:12:23 2025]
Finished job 183.
71 of 169 steps (42%) done
Select jobs to execute...

[Thu Mar  6 04:12:23 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/umap
    jobid: 319
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:Ren_2021_10X_3_Sputum
    resources: tmpdir=/tmp

[Thu Mar  6 04:12:24 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/pca.zarr
    jobid: 212
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:Hatje_2024_PBMCs
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp7hly6irt.neighbors.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpwcs7gtja.plot.py
Activating conda environment: scanpy
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:Ren_2021_10X_3_Sputum...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/umap.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 200.0}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "Compartment_prediction"...
  9%|▉         | 1/11 [00:00<00:02,  3.86it/s]INFO:root:Plot color "tissue"...
 18%|█▊        | 2/11 [00:00<00:02,  4.27it/s]INFO:root:Plot color "Lindeboom_broad"...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
 27%|██▋       | 3/11 [00:01<00:02,  2.67it/s]INFO:root:Plot color "dataset_id"...
[Thu Mar  6 04:12:27 2025]
Finished job 330.
72 of 169 steps (43%) done
Select jobs to execute...

[Thu Mar  6 04:12:27 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/umap.done
    jobid: 329
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE234241_PBMCs
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

 36%|███▋      | 4/11 [00:01<00:02,  3.26it/s]INFO:root:Plot color "modalities"...
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp9fruovef.pca.py
Activating conda environment: rapids_singlecell
 45%|████▌     | 5/11 [00:01<00:01,  3.73it/s]INFO:root:Plot color "infection_status"...
 55%|█████▍    | 6/11 [00:01<00:01,  3.82it/s]INFO:root:Plot color "qc_status"...
 64%|██████▎   | 7/11 [00:01<00:00,  4.20it/s]INFO:root:Plot color "infection_stage"...
 73%|███████▎  | 8/11 [00:02<00:00,  3.93it/s]INFO:root:Plot color "Cross_tissue_broad"...
 82%|████████▏ | 9/11 [00:02<00:00,  3.42it/s]INFO:root:Plot color "pathogen"...
 91%|█████████ | 10/11 [00:02<00:00,  3.71it/s]INFO:root:Plot color "study"...
100%|██████████| 11/11 [00:02<00:00,  4.04it/s]100%|██████████| 11/11 [00:02<00:00,  3.74it/s]
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE180268/pca.zarr...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:12:31 2025]
Finished job 319.
73 of 169 steps (43%) done
Select jobs to execute...

[Thu Mar  6 04:12:31 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE187515/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE187515/neighbors.zarr
    jobid: 267
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE187515/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE187515
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpsf174cn5.umap.py
Activating conda environment: rapids_singlecell
INFO:root:Using rapids_singlecell...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/highly_variable_genes.zarr"...
Select jobs to execute...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpo7jiu4em.neighbors.py
Activating conda environment: rapids_singlecell
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/neighbors.zarr...
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/umap.zarr...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE187515/pca.zarr...
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/umap.done.
[Thu Mar  6 04:12:45 2025]
Finished job 329.
74 of 169 steps (44%) done

[Thu Mar  6 04:12:45 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/umap
    jobid: 328
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE234241_PBMCs
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmplmf09hfl.plot.py
Activating conda environment: scanpy
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE234241_PBMCs...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/umap.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 13.856172925038104}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "infection_status"...
  9%|▉         | 1/11 [00:00<00:04,  2.18it/s]INFO:root:Plot color "qc_status"...
 18%|█▊        | 2/11 [00:00<00:04,  2.21it/s]INFO:root:Plot color "Compartment_prediction"...
 27%|██▋       | 3/11 [00:01<00:03,  2.11it/s]INFO:root:Plot color "modalities"...
 36%|███▋      | 4/11 [00:01<00:03,  2.26it/s]INFO:root:Plot color "infection_stage"...
 45%|████▌     | 5/11 [00:02<00:02,  2.17it/s]INFO:root:Plot color "dataset_id"...
 55%|█████▍    | 6/11 [00:02<00:02,  2.22it/s]INFO:root:Plot color "Lindeboom_broad"...
 64%|██████▎   | 7/11 [00:03<00:02,  1.61it/s]INFO:root:Plot color "pathogen"...
 73%|███████▎  | 8/11 [00:04<00:01,  1.81it/s]INFO:root:Plot color "Cross_tissue_broad"...
 82%|████████▏ | 9/11 [00:04<00:01,  1.62it/s]INFO:root:Plot color "study"...
 91%|█████████ | 10/11 [00:05<00:00,  1.82it/s]INFO:root:Plot color "tissue"...
100%|██████████| 11/11 [00:05<00:00,  2.01it/s]100%|██████████| 11/11 [00:05<00:00,  1.95it/s]
[Thu Mar  6 04:12:54 2025]
Finished job 328.
75 of 169 steps (44%) done
Select jobs to execute...

[Thu Mar  6 04:12:54 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/neighbors.zarr
    jobid: 303
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Hatje_2024_Liver
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

INFO:root:AnnData object with n_obs × n_vars = 149740 × 11025
    obs: '10X_3prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp4t02cyuu.neighbors.py
Activating conda environment: rapids_singlecell
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/pca.zarr...
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 430171 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
[Thu Mar  6 04:13:14 2025]
Finished job 252.
76 of 169 steps (45%) done
Select jobs to execute...

[Thu Mar  6 04:13:14 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/umap.done
    jobid: 251
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/pca.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/neighbors.zarr
    wildcards: dataset=t_cells, file_id=filter:COMBAT_2022
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 344071 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp5ds5ke6t.umap.py
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:13:23 2025]
Finished job 327.
77 of 169 steps (46%) done
Select jobs to execute...

[Thu Mar  6 04:13:23 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/umap.done
    jobid: 326
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/pca.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/neighbors.zarr
    wildcards: dataset=t_cells, file_id=filter:ESKD_2024
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/neighbors.zarr...
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/umap.zarr...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpwbfiid_0.umap.py
Activating conda environment: rapids_singlecell
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 9891 × 11025
    obs: '10X_3prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/neighbors.zarr...
[Thu Mar  6 04:13:35 2025]
Finished job 303.
78 of 169 steps (46%) done
Select jobs to execute...

[Thu Mar  6 04:13:35 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/umap.done
    jobid: 302
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/neighbors.zarr
    wildcards: dataset=t_cells, file_id=filter:Hatje_2024_Liver
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE180268/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 56313 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/umap.zarr...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpqqz1dsg8.umap.py
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:13:39 2025]
Finished job 258.
79 of 169 steps (47%) done
Select jobs to execute...

[Thu Mar  6 04:13:39 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE180268/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE180268/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE180268/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE180268/umap.done
    jobid: 257
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE180268/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE180268/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE180268
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/neighbors.zarr...
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/umap.zarr...
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/umap.done.
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:13:45 2025]
Finished job 251.
80 of 169 steps (47%) done
Select jobs to execute...

[Thu Mar  6 04:13:45 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/pca.zarr
    jobid: 192
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:Liu_2021
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp97n3qxy4.umap.py
Activating conda environment: rapids_singlecell
INFO:root:PCA with parameters: {'n_comps': 50}
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpq6zzfq46.pca.py
Activating conda environment: rapids_singlecell
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/umap.done.
[Thu Mar  6 04:13:49 2025]
Finished job 326.
81 of 169 steps (48%) done
Select jobs to execute...

[Thu Mar  6 04:13:49 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/pca
    jobid: 243
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/pca; Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE162097_TDL
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpj30xgdcv.plot.py
Activating conda environment: scanpy
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 171002 × 10000
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE180268/neighbors.zarr...
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE180268/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE180268/umap.zarr...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE162097_TDL...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/pca.zarr...
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/umap.done.
[Thu Mar  6 04:13:52 2025]
Finished job 302.
82 of 169 steps (49%) done
Select jobs to execute...

[Thu Mar  6 04:13:52 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/umap
    jobid: 301
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:Hatje_2024_Liver
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 29.43773918163085}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "pathogen"...
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpvf760ktu.plot.py
Activating conda environment: scanpy
  9%|▉         | 1/11 [00:00<00:02,  3.36it/s]INFO:root:Plot color "Lindeboom_broad"...
 18%|█▊        | 2/11 [00:00<00:03,  2.26it/s]INFO:root:Plot color "tissue"...
 27%|██▋       | 3/11 [00:01<00:02,  2.71it/s]INFO:root:Plot color "infection_stage"...
[Thu Mar  6 04:13:53 2025]
Finished job 198.
83 of 169 steps (49%) done
Select jobs to execute...

[Thu Mar  6 04:13:53 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/pca
    jobid: 197
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Lindeboom_2024_PBMCs
    resources: tmpdir=/tmp

 36%|███▋      | 4/11 [00:01<00:02,  2.94it/s]INFO:root:Plot color "study"...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
 45%|████▌     | 5/11 [00:01<00:01,  3.15it/s]INFO:root:Plot color "Compartment_prediction"...
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpjzww9ybk.plot.py
Activating conda environment: scanpy
 55%|█████▍    | 6/11 [00:02<00:01,  3.04it/s]INFO:root:Plot color "Cross_tissue_broad"...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:Hatje_2024_Liver...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/umap.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 20.220402386007482}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "infection_status"...
INFO:root:Using rapids_singlecell...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/highly_variable_genes.zarr"...
 64%|██████▎   | 7/11 [00:02<00:01,  2.99it/s]INFO:root:Plot color "modalities"...
  9%|▉         | 1/11 [00:00<00:03,  2.76it/s]INFO:root:Plot color "dataset_id"...
 73%|███████▎  | 8/11 [00:02<00:01,  2.80it/s]INFO:root:Plot color "infection_status"...
 18%|█▊        | 2/11 [00:00<00:03,  2.74it/s]INFO:root:Plot color "qc_status"...
 82%|████████▏ | 9/11 [00:03<00:00,  3.02it/s]INFO:root:Plot color "qc_status"...
 91%|█████████ | 10/11 [00:03<00:00,  3.09it/s]INFO:root:Plot color "dataset_id"...
 27%|██▋       | 3/11 [00:01<00:02,  2.69it/s]INFO:root:Plot color "Compartment_prediction"...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:Lindeboom_2024_PBMCs...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/pca.zarr...
100%|██████████| 11/11 [00:03<00:00,  3.03it/s]100%|██████████| 11/11 [00:03<00:00,  2.95it/s]
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/pca.zarr...
 36%|███▋      | 4/11 [00:01<00:03,  2.28it/s]INFO:root:Plot color "Lindeboom_broad"...
[Thu Mar  6 04:13:56 2025]
Finished job 243.
84 of 169 steps (50%) done
Select jobs to execute...

[Thu Mar  6 04:13:56 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/umap
    jobid: 325
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:ESKD_2024
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpaab7merh.plot.py
Activating conda environment: scanpy
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 1.1695769640121167}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "Lindeboom_broad"...
 45%|████▌     | 5/11 [00:02<00:03,  1.67it/s]INFO:root:Plot color "tissue"...
 55%|█████▍    | 6/11 [00:02<00:02,  1.97it/s]INFO:root:Plot color "infection_stage"...
 64%|██████▎   | 7/11 [00:03<00:01,  2.08it/s]INFO:root:Plot color "modalities"...
 73%|███████▎  | 8/11 [00:03<00:01,  2.30it/s]INFO:root:Plot color "study"...
 82%|████████▏ | 9/11 [00:03<00:00,  2.48it/s]INFO:root:Plot color "Cross_tissue_broad"...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:ESKD_2024...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/umap.zarr...
  9%|▉         | 1/11 [00:01<00:17,  1.74s/it]INFO:root:Plot color "modalities"...
 91%|█████████ | 10/11 [00:04<00:00,  1.97it/s]INFO:root:Plot color "pathogen"...
100%|██████████| 11/11 [00:05<00:00,  2.20it/s]100%|██████████| 11/11 [00:05<00:00,  2.19it/s]
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE180268/umap.done.
[Thu Mar  6 04:13:59 2025]
Finished job 257.
85 of 169 steps (50%) done
Select jobs to execute...

[Thu Mar  6 04:13:59 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182536/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE182536/pca
    jobid: 187
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182536/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE182536
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
[Thu Mar  6 04:14:00 2025]
Finished job 301.
86 of 169 steps (51%) done
Select jobs to execute...

[Thu Mar  6 04:14:00 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/neighbors.zarr
    jobid: 276
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Waradon_Dengue
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
 18%|█▊        | 2/11 [00:03<00:13,  1.51s/it]INFO:root:Plot color "infection_status"...
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp24i13rqf.plot.py
Activating conda environment: scanpy
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 0.5812753763031467}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "infection_stage"...
 27%|██▋       | 3/11 [00:04<00:11,  1.46s/it]INFO:root:Plot color "study"...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE182536...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182536/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182536/pca.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 25.581990278843694}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "study"...
 36%|███▋      | 4/11 [00:05<00:09,  1.41s/it]INFO:root:Plot color "dataset_id"...
  9%|▉         | 1/11 [00:00<00:04,  2.02it/s]INFO:root:Plot color "Lindeboom_broad"...
 18%|█▊        | 2/11 [00:00<00:04,  2.00it/s]INFO:root:Plot color "Compartment_prediction"...
  9%|▉         | 1/11 [00:02<00:22,  2.20s/it]INFO:root:Plot color "qc_status"...
 27%|██▋       | 3/11 [00:01<00:03,  2.22it/s]INFO:root:Plot color "modalities"...
 36%|███▋      | 4/11 [00:01<00:02,  2.52it/s]INFO:root:Plot color "pathogen"...
 45%|████▌     | 5/11 [00:07<00:08,  1.42s/it]INFO:root:Plot color "infection_stage"...
 45%|████▌     | 5/11 [00:02<00:02,  2.74it/s]INFO:root:Plot color "Cross_tissue_broad"...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpox3u4tf5.neighbors.py
Activating conda environment: rapids_singlecell
 55%|█████▍    | 6/11 [00:02<00:01,  2.81it/s]INFO:root:Plot color "tissue"...
 64%|██████▎   | 7/11 [00:02<00:01,  2.91it/s]INFO:root:Plot color "infection_status"...
 73%|███████▎  | 8/11 [00:02<00:01,  2.95it/s]INFO:root:Plot color "infection_stage"...
 55%|█████▍    | 6/11 [00:08<00:07,  1.42s/it]INFO:root:Plot color "tissue"...
 18%|█▊        | 2/11 [00:04<00:20,  2.31s/it]INFO:root:Plot color "modalities"...
INFO:root:PCA with parameters: {'n_comps': 50}
 82%|████████▏ | 9/11 [00:03<00:00,  2.75it/s]INFO:root:Plot color "dataset_id"...
 91%|█████████ | 10/11 [00:03<00:00,  2.91it/s]INFO:root:Plot color "qc_status"...
100%|██████████| 11/11 [00:04<00:00,  2.94it/s]100%|██████████| 11/11 [00:04<00:00,  2.72it/s]
[Thu Mar  6 04:14:06 2025]
Finished job 187.
87 of 169 steps (51%) done
Select jobs to execute...

[Thu Mar  6 04:14:06 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/pca.zarr
    jobid: 178
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/pca.zarr; Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:BEAM
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
 64%|██████▎   | 7/11 [00:10<00:05,  1.42s/it]INFO:root:Plot color "pathogen"...
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpviz2ta3k.pca.py
Activating conda environment: rapids_singlecell
 27%|██▋       | 3/11 [00:06<00:18,  2.26s/it]INFO:root:Plot color "dataset_id"...
 73%|███████▎  | 8/11 [00:11<00:04,  1.39s/it]INFO:root:Plot color "qc_status"...
 82%|████████▏ | 9/11 [00:12<00:02,  1.40s/it]INFO:root:Plot color "Cross_tissue_broad"...
 36%|███▋      | 4/11 [00:08<00:15,  2.23s/it]INFO:root:Plot color "Lindeboom_broad"...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/pca.zarr...
 91%|█████████ | 10/11 [00:14<00:01,  1.44s/it]INFO:root:Plot color "Compartment_prediction"...
100%|██████████| 11/11 [00:15<00:00,  1.46s/it]100%|██████████| 11/11 [00:15<00:00,  1.44s/it]
 45%|████▌     | 5/11 [00:11<00:14,  2.40s/it]INFO:root:Plot color "pathogen"...
[Thu Mar  6 04:14:13 2025]
Finished job 197.
88 of 169 steps (52%) done
Select jobs to execute...

[Thu Mar  6 04:14:13 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/pca.zarr
    jobid: 234
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE234241_Liver
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

INFO:root:Using rapids_singlecell...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/highly_variable_genes.zarr"...
 55%|█████▍    | 6/11 [00:14<00:11,  2.38s/it]INFO:root:Plot color "Cross_tissue_broad"...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE158769/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 489802 × 10000
    obs: '10X_3prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpjj3d50jv.pca.py
Activating conda environment: rapids_singlecell
 64%|██████▎   | 7/11 [00:16<00:09,  2.42s/it]INFO:root:Plot color "tissue"...
 73%|███████▎  | 8/11 [00:18<00:07,  2.38s/it]INFO:root:Plot color "infection_status"...
[Thu Mar  6 04:14:20 2025]
Finished job 210.
89 of 169 steps (53%) done
Select jobs to execute...

[Thu Mar  6 04:14:20 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE158769/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE158769/pca
    jobid: 209
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE158769/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE158769
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp9v5tbnb0.plot.py
Activating conda environment: scanpy
INFO:root:AnnData object with n_obs × n_vars = 171503 × 11015
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
 82%|████████▏ | 9/11 [00:21<00:04,  2.35s/it]INFO:root:Plot color "study"...
INFO:root:Using rapids_singlecell...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/highly_variable_genes.zarr"...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE158769...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE158769/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE158769/pca.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
 91%|█████████ | 10/11 [00:23<00:02,  2.32s/it]INFO:root:Plot color "Compartment_prediction"...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 0.4083282632573979}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "Compartment_prediction"...
100%|██████████| 11/11 [00:25<00:00,  2.33s/it]100%|██████████| 11/11 [00:25<00:00,  2.33s/it]
[Thu Mar  6 04:14:27 2025]
Finished job 325.
90 of 169 steps (53%) done
Select jobs to execute...

[Thu Mar  6 04:14:27 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/neighbors.zarr
    jobid: 345
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/neighbors.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE162097_PBMCs
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpt67oylfh.neighbors.py
Activating conda environment: rapids_singlecell
INFO:root:PCA with parameters: {'n_comps': 50}
  9%|▉         | 1/11 [00:03<00:34,  3.44s/it]INFO:root:Plot color "pathogen"...
 18%|█▊        | 2/11 [00:06<00:29,  3.30s/it]INFO:root:Plot color "modalities"...
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/pca.zarr...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE187515/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 122570 × 11020
    obs: '10X_5prime_ECCITE-seq', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
 27%|██▋       | 3/11 [00:09<00:26,  3.26s/it]INFO:root:Plot color "study"...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 6585 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
INFO:root:AnnData object with n_obs × n_vars = 100946 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
[Thu Mar  6 04:14:36 2025]
Finished job 267.
91 of 169 steps (54%) done
Select jobs to execute...

[Thu Mar  6 04:14:36 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE187515/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE187515/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE187515/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE187515/umap.done
    jobid: 266
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE187515/pca.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE187515/neighbors.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE187515
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 481256 × 10000
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
 36%|███▋      | 4/11 [00:13<00:22,  3.23s/it]INFO:root:Plot color "tissue"...
INFO:root:AnnData object with n_obs × n_vars = 16149 × 11024
    obs: 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'Seq_well', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
 45%|████▌     | 5/11 [00:16<00:19,  3.21s/it]INFO:root:Plot color "Lindeboom_broad"...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:14:42 2025]
Finished job 345.
92 of 169 steps (54%) done
Select jobs to execute...

[Thu Mar  6 04:14:42 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/umap.done
    jobid: 344
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/umap.zarr; Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/neighbors.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE162097_PBMCs
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:14:42 2025]
Finished job 224.
93 of 169 steps (55%) done
Select jobs to execute...

[Thu Mar  6 04:14:42 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/neighbors.zarr
    jobid: 318
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Ren_2021_10X_5_PBMCs
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp7bh0ltp1.umap.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpq5vnrdco.umap.py
Activating conda environment: rapids_singlecell
 55%|█████▍    | 6/11 [00:19<00:16,  3.36s/it]INFO:root:Plot color "Cross_tissue_broad"...
 64%|██████▎   | 7/11 [00:23<00:13,  3.38s/it]INFO:root:Plot color "dataset_id"...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/neighbors.zarr...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE187515/neighbors.zarr...
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/umap.zarr...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE187515/pca.zarr for use_rep="X_pca"...
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp91st8crb.neighbors.py
Activating conda environment: rapids_singlecell
INFO:root:Compute UMAP...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE187515/umap.zarr...
 73%|███████▎  | 8/11 [00:26<00:09,  3.32s/it]INFO:root:Plot color "infection_stage"...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/pca.zarr...
 82%|████████▏ | 9/11 [00:29<00:06,  3.30s/it]INFO:root:Plot color "infection_status"...
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/umap.done.
[Thu Mar  6 04:14:56 2025]
Finished job 344.
94 of 169 steps (56%) done
Select jobs to execute...

[Thu Mar  6 04:14:56 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/pca
    jobid: 223
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Ren_2021_10X_5_PBMCs
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpycs0d9ep.plot.py
Activating conda environment: scanpy
 91%|█████████ | 10/11 [00:32<00:03,  3.28s/it]INFO:root:Plot color "qc_status"...
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE187515/umap.done.
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:Ren_2021_10X_5_PBMCs...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/pca.zarr...
[Thu Mar  6 04:14:58 2025]
Finished job 266.
95 of 169 steps (56%) done
Select jobs to execute...

[Thu Mar  6 04:14:58 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/neighbors.zarr
    jobid: 282
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE182159_Liver
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 0.41557923433681865}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "Cross_tissue_broad"...
100%|██████████| 11/11 [00:36<00:00,  3.28s/it]100%|██████████| 11/11 [00:36<00:00,  3.30s/it]
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:15:04 2025]
Finished job 209.
96 of 169 steps (57%) done
Select jobs to execute...

[Thu Mar  6 04:15:04 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/pca
    jobid: 229
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:ESKD_2024
    resources: tmpdir=/tmp

python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpefgwp9gc.neighbors.py
Activating conda environment: rapids_singlecell
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpta9d_7rr.plot.py
Activating conda environment: scanpy
  9%|▉         | 1/11 [00:03<00:39,  3.94s/it]INFO:root:Plot color "dataset_id"...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:ESKD_2024...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/pca.zarr...
 18%|█▊        | 2/11 [00:07<00:31,  3.48s/it]INFO:root:Plot color "qc_status"...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 0.5812753763031467}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "pathogen"...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/pca.zarr...
  9%|▉         | 1/11 [00:02<00:24,  2.46s/it]INFO:root:Plot color "Cross_tissue_broad"...
 27%|██▋       | 3/11 [00:10<00:27,  3.41s/it]INFO:root:Plot color "study"...
INFO:root:PCA with parameters: {'n_comps': 50}
 18%|█▊        | 2/11 [00:05<00:22,  2.51s/it]INFO:root:Plot color "dataset_id"...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 16149 × 10000
    obs: 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'Seq_well', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
 36%|███▋      | 4/11 [00:13<00:23,  3.29s/it]INFO:root:Plot color "infection_stage"...
 27%|██▋       | 3/11 [00:07<00:19,  2.43s/it]INFO:root:Plot color "infection_status"...
[Thu Mar  6 04:15:16 2025]
Finished job 234.
97 of 169 steps (57%) done
Select jobs to execute...

[Thu Mar  6 04:15:16 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/umap
    jobid: 343
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/umap; Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE162097_PBMCs
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmplygskb55.plot.py
Activating conda environment: scanpy
 45%|████▌     | 5/11 [00:16<00:19,  3.22s/it]INFO:root:Plot color "Lindeboom_broad"...
 36%|███▋      | 4/11 [00:09<00:16,  2.40s/it]INFO:root:Plot color "tissue"...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE162097_PBMCs...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/umap.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 30.372057706909644}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "qc_status"...
  9%|▉         | 1/11 [00:00<00:03,  3.33it/s]INFO:root:Plot color "Lindeboom_broad"...
 18%|█▊        | 2/11 [00:00<00:04,  2.10it/s]INFO:root:Plot color "pathogen"...
 27%|██▋       | 3/11 [00:01<00:03,  2.64it/s]INFO:root:Plot color "study"...
 36%|███▋      | 4/11 [00:01<00:02,  2.99it/s]INFO:root:Plot color "modalities"...
 45%|████▌     | 5/11 [00:11<00:14,  2.34s/it]INFO:root:Plot color "modalities"...
 45%|████▌     | 5/11 [00:01<00:01,  3.22it/s]INFO:root:Plot color "Compartment_prediction"...
 55%|█████▍    | 6/11 [00:02<00:01,  3.22it/s]INFO:root:Plot color "infection_status"...
 55%|█████▍    | 6/11 [00:20<00:16,  3.30s/it]INFO:root:Plot color "infection_status"...
 64%|██████▎   | 7/11 [00:02<00:01,  3.39it/s]INFO:root:Plot color "dataset_id"...
 73%|███████▎  | 8/11 [00:02<00:00,  3.14it/s]INFO:root:Plot color "tissue"...
 82%|████████▏ | 9/11 [00:02<00:00,  3.33it/s]INFO:root:Plot color "Cross_tissue_broad"...
 91%|█████████ | 10/11 [00:03<00:00,  3.15it/s]INFO:root:Plot color "infection_stage"...
100%|██████████| 11/11 [00:03<00:00,  3.28it/s]100%|██████████| 11/11 [00:03<00:00,  3.11it/s]
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
[Thu Mar  6 04:15:22 2025]
Finished job 343.
98 of 169 steps (58%) done
Select jobs to execute...

[Thu Mar  6 04:15:22 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE180268/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE180268/umap
    jobid: 256
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE180268/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE180268
    resources: tmpdir=/tmp

 55%|█████▍    | 6/11 [00:14<00:11,  2.34s/it]INFO:root:Plot color "Compartment_prediction"...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp1e8kknvq.plot.py
Activating conda environment: scanpy
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 255782 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
 64%|██████▎   | 7/11 [00:23<00:13,  3.27s/it]INFO:root:Plot color "pathogen"...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE180268...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE180268/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE180268/umap.zarr...
 64%|██████▎   | 7/11 [00:16<00:09,  2.36s/it]INFO:root:Plot color "Lindeboom_broad"...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 3.5515777884325113}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "Compartment_prediction"...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 103843 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
  9%|▉         | 1/11 [00:00<00:06,  1.47it/s]INFO:root:Plot color "study"...
 18%|█▊        | 2/11 [00:01<00:05,  1.58it/s]INFO:root:Plot color "dataset_id"...
 73%|███████▎  | 8/11 [00:26<00:09,  3.27s/it]INFO:root:Plot color "modalities"...
 27%|██▋       | 3/11 [00:01<00:04,  1.63it/s]INFO:root:Plot color "Lindeboom_broad"...
[Thu Mar  6 04:15:27 2025]
Finished job 255.
99 of 169 steps (59%) done
Select jobs to execute...

[Thu Mar  6 04:15:27 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/umap.done
    jobid: 254
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Yoshida_2021
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

 73%|███████▎  | 8/11 [00:19<00:07,  2.48s/it]INFO:root:Plot color "study"...
 36%|███▋      | 4/11 [00:02<00:05,  1.25it/s]INFO:root:Plot color "qc_status"...
 45%|████▌     | 5/11 [00:03<00:04,  1.35it/s]INFO:root:Plot color "infection_stage"...
 55%|█████▍    | 6/11 [00:04<00:03,  1.37it/s]INFO:root:Plot color "Cross_tissue_broad"...
 82%|████████▏ | 9/11 [00:21<00:04,  2.42s/it]INFO:root:Plot color "infection_stage"...
 82%|████████▏ | 9/11 [00:29<00:06,  3.22s/it]INFO:root:Plot color "tissue"...
 64%|██████▎   | 7/11 [00:05<00:02,  1.38it/s]INFO:root:Plot color "modalities"...
 73%|███████▎  | 8/11 [00:05<00:02,  1.46it/s]INFO:root:Plot color "tissue"...
 82%|████████▏ | 9/11 [00:06<00:01,  1.48it/s]INFO:root:Plot color "pathogen"...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:15:31 2025]
Finished job 276.
100 of 169 steps (59%) done
Select jobs to execute...

[Thu Mar  6 04:15:31 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/umap.done
    jobid: 275
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Waradon_Dengue
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

 91%|█████████ | 10/11 [00:23<00:02,  2.31s/it]INFO:root:Plot color "qc_status"...
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp2fc0bx4a.umap.py
Activating conda environment: rapids_singlecell
 91%|█████████ | 10/11 [00:06<00:00,  1.55it/s]INFO:root:Plot color "infection_status"...
100%|██████████| 11/11 [00:07<00:00,  1.58it/s]100%|██████████| 11/11 [00:07<00:00,  1.48it/s]
 91%|█████████ | 10/11 [00:32<00:03,  3.17s/it]INFO:root:Plot color "Compartment_prediction"...
100%|██████████| 11/11 [00:26<00:00,  2.37s/it]100%|██████████| 11/11 [00:26<00:00,  2.39s/it]
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:15:34 2025]
Finished job 256.
101 of 169 steps (60%) done
[Thu Mar  6 04:15:34 2025]
Finished job 229.
102 of 169 steps (60%) done
Select jobs to execute...

[Thu Mar  6 04:15:34 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/pca.zarr
    jobid: 220
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:Ren_2021_10X_5_BALF
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpw9oi7h5n.umap.py
Activating conda environment: rapids_singlecell
100%|██████████| 11/11 [00:35<00:00,  3.16s/it]100%|██████████| 11/11 [00:35<00:00,  3.26s/it]
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/neighbors.zarr...

[Thu Mar  6 04:15:37 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/pca
    jobid: 215
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Hatje_2024_SmartSeq2
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
[Thu Mar  6 04:15:38 2025]
Finished job 223.
103 of 169 steps (61%) done
Select jobs to execute...

[Thu Mar  6 04:15:38 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/pca
    jobid: 195
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Waradon_Dengue
    resources: tmpdir=/tmp

python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpt21_0oru.pca.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp_ndise_5.plot.py
Activating conda environment: scanpy
Select jobs to execute...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpi8sh33tc.plot.py
Activating conda environment: scanpy
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/umap.zarr...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:Hatje_2024_SmartSeq2...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/pca.zarr...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/neighbors.zarr...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:Waradon_Dengue...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/pca.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 190.65776930409913}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "Compartment_prediction"...
  9%|▉         | 1/11 [00:00<00:03,  3.15it/s]INFO:root:Plot color "pathogen"...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 1.925984418786052}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "tissue"...
 18%|█▊        | 2/11 [00:00<00:02,  3.56it/s]INFO:root:Plot color "infection_status"...
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/pca.zarr for use_rep="X_pca"...
 27%|██▋       | 3/11 [00:00<00:02,  3.89it/s]INFO:root:Plot color "dataset_id"...
INFO:root:Compute UMAP...
 36%|███▋      | 4/11 [00:01<00:01,  4.02it/s]INFO:root:Plot color "infection_stage"...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/umap.zarr...
 45%|████▌     | 5/11 [00:01<00:01,  4.15it/s]INFO:root:Plot color "tissue"...
  9%|▉         | 1/11 [00:00<00:09,  1.08it/s]INFO:root:Plot color "Cross_tissue_broad"...
 55%|█████▍    | 6/11 [00:01<00:01,  4.23it/s]INFO:root:Plot color "Cross_tissue_broad"...
 64%|██████▎   | 7/11 [00:01<00:01,  3.92it/s]INFO:root:Plot color "Lindeboom_broad"...
INFO:root:PCA with parameters: {'n_comps': 50}
 73%|███████▎  | 8/11 [00:02<00:01,  3.00it/s]INFO:root:Plot color "study"...
 82%|████████▏ | 9/11 [00:02<00:00,  2.92it/s]INFO:root:Plot color "modalities"...
 18%|█▊        | 2/11 [00:02<00:10,  1.20s/it]INFO:root:Plot color "modalities"...
 91%|█████████ | 10/11 [00:02<00:00,  3.23it/s]INFO:root:Plot color "qc_status"...
100%|██████████| 11/11 [00:03<00:00,  3.42it/s]100%|██████████| 11/11 [00:03<00:00,  3.50it/s]
[Thu Mar  6 04:15:43 2025]
Finished job 215.
104 of 169 steps (62%) done

[Thu Mar  6 04:15:43 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/neighbors.zarr
    jobid: 333
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE234241_Liver
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

 27%|██▋       | 3/11 [00:03<00:08,  1.07s/it]INFO:root:Plot color "qc_status"...
INFO:root:Using rapids_singlecell...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/highly_variable_genes.zarr"...
 36%|███▋      | 4/11 [00:04<00:07,  1.03s/it]INFO:root:Plot color "dataset_id"...
INFO:root:PCA with parameters: {'n_comps': 50}
 45%|████▌     | 5/11 [00:05<00:05,  1.01it/s]INFO:root:Plot color "study"...
 55%|█████▍    | 6/11 [00:06<00:05,  1.00s/it]INFO:root:Plot color "infection_stage"...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 149740 × 10000
    obs: '10X_3prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp4h2wnorw.neighbors.py
Activating conda environment: rapids_singlecell
 64%|██████▎   | 7/11 [00:07<00:04,  1.01s/it]INFO:root:Plot color "infection_status"...
 73%|███████▎  | 8/11 [00:08<00:03,  1.02s/it]INFO:root:Plot color "Compartment_prediction"...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 100946 × 10000
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
 82%|████████▏ | 9/11 [00:09<00:02,  1.02s/it]INFO:root:Plot color "pathogen"...
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/umap.done.
[Thu Mar  6 04:15:50 2025]
Finished job 254.
105 of 169 steps (62%) done
Select jobs to execute...

[Thu Mar  6 04:15:50 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/umap
    jobid: 253
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:Yoshida_2021
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/umap.done.
[Thu Mar  6 04:15:51 2025]
Finished job 275.
106 of 169 steps (63%) done
Select jobs to execute...

[Thu Mar  6 04:15:51 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/umap
    jobid: 274
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:Waradon_Dengue
    resources: tmpdir=/tmp

 91%|█████████ | 10/11 [00:10<00:00,  1.01it/s]INFO:root:Plot color "Lindeboom_broad"...
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpm7iv2yzy.plot.py
Activating conda environment: scanpy
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
[Thu Mar  6 04:15:51 2025]
Finished job 212.
107 of 169 steps (63%) done
Select jobs to execute...

[Thu Mar  6 04:15:51 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/pca
    jobid: 211
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Hatje_2024_PBMCs
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpnm82th3t.plot.py
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpzc2zig4w.plot.py
Activating conda environment: scanpy
[Thu Mar  6 04:15:52 2025]
Finished job 178.
108 of 169 steps (64%) done
Select jobs to execute...

[Thu Mar  6 04:15:52 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/neighbors.zarr
    jobid: 249
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/neighbors.zarr; Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:BEAM
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
100%|██████████| 11/11 [00:11<00:00,  1.11s/it]100%|██████████| 11/11 [00:11<00:00,  1.05s/it]
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpsazvi_uz.neighbors.py
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:15:52 2025]
Finished job 195.
109 of 169 steps (64%) done
Select jobs to execute...

[Thu Mar  6 04:15:52 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:BEAM/pca
    jobid: 177
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:BEAM
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpz_32oao8.plot.py
Activating conda environment: scanpy
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:Yoshida_2021...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/umap.zarr...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:Waradon_Dengue...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/umap.zarr...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:Hatje_2024_PBMCs...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/pca.zarr...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/pca.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 1.925984418786052}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "Lindeboom_broad"...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 1.3356484573260319}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "Cross_tissue_broad"...
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:BEAM...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/pca.zarr...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 0.7819158502161997}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "qc_status"...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 1.9812573058863154}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "infection_stage"...
  9%|▉         | 1/11 [00:01<00:14,  1.43s/it]INFO:root:Plot color "dataset_id"...
  9%|▉         | 1/11 [00:01<00:14,  1.44s/it]INFO:root:Plot color "study"...
 18%|█▊        | 2/11 [00:02<00:10,  1.14s/it]INFO:root:Plot color "infection_stage"...
  9%|▉         | 1/11 [00:01<00:10,  1.02s/it]INFO:root:Plot color "qc_status"...
  9%|▉         | 1/11 [00:01<00:18,  1.89s/it]INFO:root:Plot color "infection_status"...
 18%|█▊        | 2/11 [00:02<00:11,  1.32s/it]INFO:root:Plot color "dataset_id"...
 27%|██▋       | 3/11 [00:03<00:08,  1.08s/it]INFO:root:Plot color "infection_status"...
 18%|█▊        | 2/11 [00:02<00:09,  1.07s/it]INFO:root:Plot color "Lindeboom_broad"...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/pca.zarr...
 27%|██▋       | 3/11 [00:03<00:10,  1.28s/it]INFO:root:Plot color "pathogen"...
 36%|███▋      | 4/11 [00:04<00:07,  1.06s/it]INFO:root:Plot color "modalities"...
 18%|█▊        | 2/11 [00:03<00:17,  1.92s/it]INFO:root:Plot color "modalities"...
 27%|██▋       | 3/11 [00:03<00:10,  1.27s/it]INFO:root:Plot color "pathogen"...
INFO:root:AnnData object with n_obs × n_vars = 6564 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
 45%|████▌     | 5/11 [00:05<00:06,  1.02s/it]INFO:root:Plot color "tissue"...
 36%|███▋      | 4/11 [00:05<00:09,  1.30s/it]INFO:root:Plot color "qc_status"...
 36%|███▋      | 4/11 [00:04<00:08,  1.16s/it]INFO:root:Plot color "Compartment_prediction"...
 55%|█████▍    | 6/11 [00:06<00:05,  1.03s/it]INFO:root:Plot color "qc_status"...
 27%|██▋       | 3/11 [00:05<00:14,  1.87s/it]INFO:root:Plot color "study"...
 45%|████▌     | 5/11 [00:06<00:07,  1.31s/it]INFO:root:Plot color "modalities"...
 45%|████▌     | 5/11 [00:05<00:06,  1.12s/it]INFO:root:Plot color "infection_status"...
 64%|██████▎   | 7/11 [00:07<00:04,  1.04s/it]INFO:root:Plot color "study"...
 55%|█████▍    | 6/11 [00:07<00:06,  1.28s/it]INFO:root:Plot color "tissue"...
 55%|█████▍    | 6/11 [00:06<00:05,  1.10s/it]INFO:root:Plot color "Cross_tissue_broad"...
 36%|███▋      | 4/11 [00:07<00:12,  1.83s/it]INFO:root:Plot color "tissue"...
 73%|███████▎  | 8/11 [00:08<00:03,  1.02s/it]INFO:root:Plot color "Compartment_prediction"...
 64%|██████▎   | 7/11 [00:09<00:05,  1.29s/it]INFO:root:Plot color "Lindeboom_broad"...
 64%|██████▎   | 7/11 [00:07<00:04,  1.13s/it]INFO:root:Plot color "modalities"...
 82%|████████▏ | 9/11 [00:09<00:02,  1.05s/it]INFO:root:Plot color "Cross_tissue_broad"...
 45%|████▌     | 5/11 [00:09<00:11,  1.84s/it]INFO:root:Plot color "Compartment_prediction"...
 73%|███████▎  | 8/11 [00:08<00:03,  1.08s/it]INFO:root:Plot color "tissue"...
 73%|███████▎  | 8/11 [00:10<00:04,  1.40s/it]INFO:root:Plot color "infection_status"...
 91%|█████████ | 10/11 [00:11<00:01,  1.18s/it]INFO:root:Plot color "pathogen"...
 82%|████████▏ | 9/11 [00:09<00:02,  1.05s/it]INFO:root:Plot color "study"...
100%|██████████| 11/11 [00:11<00:00,  1.11s/it]100%|██████████| 11/11 [00:11<00:00,  1.09s/it]
 55%|█████▍    | 6/11 [00:11<00:09,  1.86s/it]INFO:root:Plot color "infection_stage"...
 82%|████████▏ | 9/11 [00:12<00:02,  1.37s/it]INFO:root:Plot color "Compartment_prediction"...
 91%|█████████ | 10/11 [00:10<00:01,  1.03s/it]INFO:root:Plot color "dataset_id"...
[Thu Mar  6 04:16:06 2025]
Finished job 274.
110 of 169 steps (65%) done
Select jobs to execute...

[Thu Mar  6 04:16:06 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/neighbors.zarr
    jobid: 300
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Hatje_2024_PBMCs
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 77517 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
100%|██████████| 11/11 [00:11<00:00,  1.01s/it]100%|██████████| 11/11 [00:11<00:00,  1.08s/it]
 91%|█████████ | 10/11 [00:13<00:01,  1.36s/it]INFO:root:Plot color "infection_stage"...
 64%|██████▎   | 7/11 [00:13<00:07,  1.88s/it]INFO:root:Plot color "Cross_tissue_broad"...
100%|██████████| 11/11 [00:14<00:00,  1.34s/it]100%|██████████| 11/11 [00:14<00:00,  1.33s/it]
 73%|███████▎  | 8/11 [00:15<00:05,  1.97s/it]INFO:root:Plot color "Lindeboom_broad"...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:16:12 2025]
Finished job 177.
111 of 169 steps (66%) done
[Thu Mar  6 04:16:12 2025]
Finished job 211.
112 of 169 steps (66%) done
[Thu Mar  6 04:16:12 2025]
Finished job 282.
113 of 169 steps (67%) done
Select jobs to execute...

[Thu Mar  6 04:16:12 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/neighbors.zarr
    jobid: 261
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/neighbors.zarr; Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Lindeboom_2024_NP
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

[Thu Mar  6 04:16:12 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/umap
    jobid: 250
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:COMBAT_2022
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp6_8250wh.neighbors.py
Activating conda environment: rapids_singlecell

[Thu Mar  6 04:16:12 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/umap.done
    jobid: 281
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/pca.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/neighbors.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE182159_Liver
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp9petj744.neighbors.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpd2ead09h.plot.py
Activating conda environment: scanpy
 82%|████████▏ | 9/11 [00:17<00:04,  2.04s/it]INFO:root:Plot color "pathogen"...
 91%|█████████ | 10/11 [00:19<00:01,  1.96s/it]INFO:root:Plot color "dataset_id"...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:COMBAT_2022...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/umap.zarr...
INFO:root:PCA with parameters: {'n_comps': 50}
100%|██████████| 11/11 [00:21<00:00,  1.91s/it]100%|██████████| 11/11 [00:21<00:00,  1.91s/it]
Select jobs to execute...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
[Thu Mar  6 04:16:16 2025]
Finished job 253.
114 of 169 steps (67%) done

[Thu Mar  6 04:16:16 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/pca
    jobid: 233
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE234241_Liver
    resources: tmpdir=/tmp

python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmprqcwq77n.umap.py
Activating conda environment: rapids_singlecell
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmplhw0avn9.plot.py
Activating conda environment: scanpy
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 6564 × 10000
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/pca.zarr...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/pca.zarr...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 0.46493138775045273}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "Cross_tissue_broad"...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE234241_Liver...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/pca.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 12.384667781286767}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "infection_stage"...
[Thu Mar  6 04:16:19 2025]
Finished job 220.
115 of 169 steps (68%) done
Select jobs to execute...

[Thu Mar  6 04:16:19 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/pca.zarr
    jobid: 228
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/pca.zarr; Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:HRA000190
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
  9%|▉         | 1/11 [00:00<00:05,  1.86it/s]INFO:root:Plot color "dataset_id"...
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpat38v2lv.pca.py
Activating conda environment: rapids_singlecell
 18%|█▊        | 2/11 [00:00<00:04,  2.13it/s]INFO:root:Plot color "tissue"...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 16149 × 11024
    obs: 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'Seq_well', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
 27%|██▋       | 3/11 [00:01<00:03,  2.33it/s]INFO:root:Plot color "qc_status"...
 36%|███▋      | 4/11 [00:01<00:03,  2.33it/s]INFO:root:Plot color "Cross_tissue_broad"...
 45%|████▌     | 5/11 [00:02<00:03,  1.82it/s]INFO:root:Plot color "infection_status"...
  9%|▉         | 1/11 [00:03<00:36,  3.63s/it]INFO:root:Plot color "Lindeboom_broad"...
 55%|█████▍    | 6/11 [00:02<00:02,  1.96it/s]INFO:root:Plot color "Compartment_prediction"...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/neighbors.zarr...
 64%|██████▎   | 7/11 [00:03<00:02,  1.99it/s]INFO:root:Plot color "study"...
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
[Thu Mar  6 04:16:23 2025]
Finished job 333.
116 of 169 steps (69%) done
Select jobs to execute...

[Thu Mar  6 04:16:23 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/umap.done
    jobid: 332
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE234241_Liver
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

 73%|███████▎  | 8/11 [00:03<00:01,  2.01it/s]INFO:root:Plot color "pathogen"...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/umap.zarr...
 82%|████████▏ | 9/11 [00:04<00:00,  2.17it/s]INFO:root:Plot color "Lindeboom_broad"...
 91%|█████████ | 10/11 [00:05<00:00,  1.71it/s]INFO:root:Plot color "modalities"...
100%|██████████| 11/11 [00:05<00:00,  1.90it/s]100%|██████████| 11/11 [00:05<00:00,  1.97it/s]
 18%|█▊        | 2/11 [00:07<00:32,  3.58s/it]INFO:root:Plot color "study"...
INFO:root:Using rapids_singlecell...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/highly_variable_genes.zarr"...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:16:26 2025]
Finished job 233.
117 of 169 steps (69%) done
Select jobs to execute...

[Thu Mar  6 04:16:26 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/neighbors.zarr
    jobid: 279
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Lindeboom_2024_PBMCs
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmph_nz0a46.umap.py
Activating conda environment: rapids_singlecell
 27%|██▋       | 3/11 [00:10<00:26,  3.33s/it]INFO:root:Plot color "modalities"...
 36%|███▋      | 4/11 [00:13<00:22,  3.21s/it]INFO:root:Plot color "qc_status"...
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/umap.done.
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:16:32 2025]
Finished job 281.
118 of 169 steps (70%) done
Select jobs to execute...

[Thu Mar  6 04:16:32 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/umap
    jobid: 280
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE182159_Liver
    resources: tmpdir=/tmp

INFO:root:AnnData object with n_obs × n_vars = 166683 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpsvqiiktb.neighbors.py
Activating conda environment: rapids_singlecell
INFO:root:Subset to highly variable genes...
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpt3d4dr5h.plot.py
Activating conda environment: scanpy
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/neighbors.zarr...
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/umap.zarr...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE182159_Liver...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/umap.zarr...
 45%|████▌     | 5/11 [00:16<00:19,  3.24s/it]INFO:root:Plot color "infection_status"...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 2.580079208431699}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "dataset_id"...
  9%|▉         | 1/11 [00:00<00:08,  1.17it/s]INFO:root:Plot color "qc_status"...
 18%|█▊        | 2/11 [00:01<00:07,  1.14it/s]INFO:root:Plot color "study"...
 27%|██▋       | 3/11 [00:02<00:06,  1.16it/s]INFO:root:Plot color "pathogen"...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/pca.zarr...
 55%|█████▍    | 6/11 [00:19<00:16,  3.21s/it]INFO:root:Plot color "Compartment_prediction"...
 36%|███▋      | 4/11 [00:03<00:05,  1.19it/s]INFO:root:Plot color "infection_stage"...
 45%|████▌     | 5/11 [00:04<00:05,  1.14it/s]INFO:root:Plot color "infection_status"...
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/umap.done.
[Thu Mar  6 04:16:40 2025]
Finished job 332.
119 of 169 steps (70%) done
Select jobs to execute...

[Thu Mar  6 04:16:40 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/umap
    jobid: 331
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE234241_Liver
    resources: tmpdir=/tmp

 55%|█████▍    | 6/11 [00:05<00:04,  1.09it/s]INFO:root:Plot color "tissue"...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpj1onzs9e.plot.py
Activating conda environment: scanpy
 64%|██████▎   | 7/11 [00:06<00:03,  1.13it/s]INFO:root:Plot color "Cross_tissue_broad"...
 64%|██████▎   | 7/11 [00:23<00:13,  3.27s/it]INFO:root:Plot color "tissue"...
 73%|███████▎  | 8/11 [00:07<00:02,  1.11it/s]INFO:root:Plot color "modalities"...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE234241_Liver...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/umap.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 12.384667781286767}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "pathogen"...
 82%|████████▏ | 9/11 [00:07<00:01,  1.13it/s]INFO:root:Plot color "Compartment_prediction"...
  9%|▉         | 1/11 [00:00<00:04,  2.38it/s]INFO:root:Plot color "study"...
 18%|█▊        | 2/11 [00:00<00:03,  2.41it/s]INFO:root:Plot color "infection_status"...
 91%|█████████ | 10/11 [00:08<00:00,  1.11it/s]INFO:root:Plot color "Lindeboom_broad"...
 27%|██▋       | 3/11 [00:01<00:03,  2.34it/s]INFO:root:Plot color "qc_status"...
 73%|███████▎  | 8/11 [00:26<00:09,  3.20s/it]INFO:root:Plot color "infection_stage"...
 36%|███▋      | 4/11 [00:01<00:03,  2.29it/s]INFO:root:Plot color "Cross_tissue_broad"...
100%|██████████| 11/11 [00:10<00:00,  1.02s/it]100%|██████████| 11/11 [00:10<00:00,  1.08it/s]
 45%|████▌     | 5/11 [00:02<00:03,  1.77it/s]INFO:root:Plot color "modalities"...
[Thu Mar  6 04:16:45 2025]
Finished job 280.
120 of 169 steps (71%) done
Select jobs to execute...

[Thu Mar  6 04:16:45 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/neighbors.zarr
    jobid: 312
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Ren_2021_10X_5_BALF
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

 55%|█████▍    | 6/11 [00:02<00:02,  1.96it/s]INFO:root:Plot color "Lindeboom_broad"...
 64%|██████▎   | 7/11 [00:03<00:02,  1.52it/s]INFO:root:Plot color "dataset_id"...
 73%|███████▎  | 8/11 [00:04<00:01,  1.72it/s]INFO:root:Plot color "Compartment_prediction"...
 82%|████████▏ | 9/11 [00:04<00:01,  1.80it/s]INFO:root:Plot color "infection_stage"...
 82%|████████▏ | 9/11 [00:29<00:06,  3.38s/it]INFO:root:Plot color "dataset_id"...
 91%|█████████ | 10/11 [00:05<00:00,  1.86it/s]INFO:root:Plot color "tissue"...
100%|██████████| 11/11 [00:05<00:00,  2.03it/s]100%|██████████| 11/11 [00:05<00:00,  1.93it/s]
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:16:49 2025]
Finished job 331.
121 of 169 steps (72%) done
Select jobs to execute...

[Thu Mar  6 04:16:49 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/pca
    jobid: 219
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Ren_2021_10X_5_BALF
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpbeo5vh_4.neighbors.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp9kye6tu4.plot.py
Activating conda environment: scanpy
 91%|█████████ | 10/11 [00:32<00:03,  3.27s/it]INFO:root:Plot color "pathogen"...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:Ren_2021_10X_5_BALF...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/pca.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 30.469226081657524}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "pathogen"...
  9%|▉         | 1/11 [00:00<00:03,  3.06it/s]INFO:root:Plot color "infection_stage"...
 18%|█▊        | 2/11 [00:00<00:02,  3.15it/s]INFO:root:Plot color "Lindeboom_broad"...
 27%|██▋       | 3/11 [00:01<00:04,  1.87it/s]INFO:root:Plot color "Compartment_prediction"...
 36%|███▋      | 4/11 [00:01<00:03,  2.09it/s]INFO:root:Plot color "tissue"...
100%|██████████| 11/11 [00:35<00:00,  3.19s/it]100%|██████████| 11/11 [00:35<00:00,  3.27s/it]
 45%|████▌     | 5/11 [00:02<00:02,  2.42it/s]INFO:root:Plot color "modalities"...
 55%|█████▍    | 6/11 [00:02<00:01,  2.65it/s]INFO:root:Plot color "dataset_id"...
[Thu Mar  6 04:16:54 2025]
Finished job 250.
122 of 169 steps (72%) done
Select jobs to execute...

[Thu Mar  6 04:16:54 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE158769/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE158769/neighbors.zarr
    jobid: 297
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE158769/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE158769
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

 64%|██████▎   | 7/11 [00:02<00:01,  2.81it/s]INFO:root:Plot color "study"...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/pca.zarr...
 73%|███████▎  | 8/11 [00:03<00:01,  2.70it/s]INFO:root:Plot color "Cross_tissue_broad"...
 82%|████████▏ | 9/11 [00:03<00:00,  2.23it/s]INFO:root:Plot color "infection_status"...
 91%|█████████ | 10/11 [00:04<00:00,  2.39it/s]INFO:root:Plot color "qc_status"...
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
100%|██████████| 11/11 [00:04<00:00,  2.55it/s]100%|██████████| 11/11 [00:04<00:00,  2.47it/s]
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 100946 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:16:59 2025]
Finished job 219.
123 of 169 steps (73%) done
Select jobs to execute...

[Thu Mar  6 04:16:59 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE187515/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE187515/umap
    jobid: 265
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE187515/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE187515
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpo93_fmpa.neighbors.py
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:17:00 2025]
Finished job 249.
124 of 169 steps (73%) done
Select jobs to execute...

[Thu Mar  6 04:17:00 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/umap.done
    jobid: 248
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/umap.zarr; Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/pca.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/neighbors.zarr
    wildcards: dataset=t_cells, file_id=filter:BEAM
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpukruj74g.plot.py
Activating conda environment: scanpy
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp3yu9lox3.umap.py
Activating conda environment: rapids_singlecell
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE187515...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE187515/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE187515/umap.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 1.6317206494248184}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "qc_status"...
  9%|▉         | 1/11 [00:01<00:11,  1.17s/it]INFO:root:Plot color "Cross_tissue_broad"...
 18%|█▊        | 2/11 [00:02<00:10,  1.18s/it]INFO:root:Plot color "tissue"...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE158769/pca.zarr...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/neighbors.zarr...
 27%|██▋       | 3/11 [00:03<00:09,  1.14s/it]INFO:root:Plot color "Lindeboom_broad"...
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/umap.zarr...
 36%|███▋      | 4/11 [00:04<00:08,  1.27s/it]INFO:root:Plot color "pathogen"...
 45%|████▌     | 5/11 [00:05<00:07,  1.20s/it]INFO:root:Plot color "study"...
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 30437 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
 55%|█████▍    | 6/11 [00:07<00:06,  1.20s/it]INFO:root:Plot color "infection_stage"...
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 6564 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
 64%|██████▎   | 7/11 [00:08<00:04,  1.19s/it]INFO:root:Plot color "infection_status"...
 73%|███████▎  | 8/11 [00:09<00:03,  1.17s/it]INFO:root:Plot color "dataset_id"...
[Thu Mar  6 04:17:12 2025]
Finished job 261.
125 of 169 steps (74%) done
Select jobs to execute...

[Thu Mar  6 04:17:12 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/umap.done
    jobid: 260
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/neighbors.zarr
    wildcards: dataset=t_cells, file_id=filter:Lindeboom_2024_NP
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

 82%|████████▏ | 9/11 [00:10<00:02,  1.13s/it]INFO:root:Plot color "Compartment_prediction"...
 91%|█████████ | 10/11 [00:11<00:01,  1.15s/it]INFO:root:Plot color "modalities"...
100%|██████████| 11/11 [00:12<00:00,  1.12s/it]100%|██████████| 11/11 [00:12<00:00,  1.16s/it]
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:17:16 2025]
Finished job 312.
126 of 169 steps (75%) done
[Thu Mar  6 04:17:16 2025]
Finished job 265.
127 of 169 steps (75%) done
Select jobs to execute...

[Thu Mar  6 04:17:16 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/umap.done
    jobid: 311
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Ren_2021_10X_5_BALF
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpmi_hqmro.umap.py
Activating conda environment: rapids_singlecell

[Thu Mar  6 04:17:20 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/pca
    jobid: 181
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Yoshida_2021
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/umap.done.
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
[Thu Mar  6 04:17:20 2025]
Finished job 248.
128 of 169 steps (76%) done
Select jobs to execute...

[Thu Mar  6 04:17:20 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/pca
    jobid: 207
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Stephenson_2021
    resources: tmpdir=/tmp

python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpvzlrlzc4.umap.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp9dn5t2jg.plot.py
Activating conda environment: scanpy
Select jobs to execute...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpbvb0n8ll.plot.py
Activating conda environment: scanpy
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/neighbors.zarr...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:Yoshida_2021...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/pca.zarr...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:Stephenson_2021...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/pca.zarr...
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/umap.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 0.7819158502161997}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "tissue"...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 0.7300815501091472}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "tissue"...
  9%|▉         | 1/11 [00:01<00:18,  1.82s/it]INFO:root:Plot color "pathogen"...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/neighbors.zarr...
  9%|▉         | 1/11 [00:02<00:20,  2.01s/it]INFO:root:Plot color "Compartment_prediction"...
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/umap.zarr...
 18%|█▊        | 2/11 [00:03<00:16,  1.80s/it]INFO:root:Plot color "Lindeboom_broad"...
 18%|█▊        | 2/11 [00:04<00:18,  2.05s/it]INFO:root:Plot color "modalities"...
 27%|██▋       | 3/11 [00:05<00:16,  2.00s/it]INFO:root:Plot color "Compartment_prediction"...
 27%|██▋       | 3/11 [00:06<00:15,  2.00s/it]INFO:root:Plot color "infection_status"...
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/umap.done.
[Thu Mar  6 04:17:30 2025]
Finished job 260.
129 of 169 steps (76%) done

[Thu Mar  6 04:17:30 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/umap
    jobid: 259
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:Lindeboom_2024_NP
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpwfesko03.plot.py
Activating conda environment: scanpy
 36%|███▋      | 4/11 [00:07<00:14,  2.00s/it]INFO:root:Plot color "study"...
 36%|███▋      | 4/11 [00:08<00:14,  2.03s/it]INFO:root:Plot color "Cross_tissue_broad"...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:Lindeboom_2024_NP...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/umap.zarr...
 45%|████▌     | 5/11 [00:09<00:11,  1.93s/it]INFO:root:Plot color "Cross_tissue_broad"...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 6.570949830798042}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "infection_stage"...
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/umap.done.
[Thu Mar  6 04:17:33 2025]
Finished job 311.
130 of 169 steps (77%) done
Select jobs to execute...

[Thu Mar  6 04:17:33 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/umap
    jobid: 310
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:Ren_2021_10X_5_BALF
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
 45%|████▌     | 5/11 [00:10<00:12,  2.14s/it]INFO:root:Plot color "infection_stage"...
  9%|▉         | 1/11 [00:00<00:07,  1.43it/s]INFO:root:Plot color "study"...
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpxwdgshir.plot.py
Activating conda environment: scanpy
 18%|█▊        | 2/11 [00:01<00:05,  1.65it/s]INFO:root:Plot color "infection_status"...
 27%|██▋       | 3/11 [00:01<00:04,  1.63it/s]INFO:root:Plot color "dataset_id"...
 55%|█████▍    | 6/11 [00:11<00:10,  2.01s/it]INFO:root:Plot color "dataset_id"...
 36%|███▋      | 4/11 [00:02<00:04,  1.74it/s]INFO:root:Plot color "Cross_tissue_broad"...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:Ren_2021_10X_5_BALF...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/umap.zarr...
 55%|█████▍    | 6/11 [00:12<00:10,  2.10s/it]INFO:root:Plot color "Lindeboom_broad"...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 30.469226081657524}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "pathogen"...
  9%|▉         | 1/11 [00:00<00:03,  3.05it/s]INFO:root:Plot color "tissue"...
 45%|████▌     | 5/11 [00:03<00:03,  1.52it/s]INFO:root:Plot color "qc_status"...
 18%|█▊        | 2/11 [00:00<00:02,  3.17it/s]INFO:root:Plot color "infection_status"...
 55%|█████▍    | 6/11 [00:03<00:03,  1.59it/s]INFO:root:Plot color "tissue"...
 27%|██▋       | 3/11 [00:00<00:02,  3.05it/s]INFO:root:Plot color "modalities"...
 64%|██████▎   | 7/11 [00:13<00:07,  1.94s/it]INFO:root:Plot color "qc_status"...
 36%|███▋      | 4/11 [00:01<00:02,  3.10it/s]INFO:root:Plot color "study"...
 64%|██████▎   | 7/11 [00:04<00:02,  1.67it/s]INFO:root:Plot color "Lindeboom_broad"...
 45%|████▌     | 5/11 [00:01<00:01,  3.14it/s]INFO:root:Plot color "infection_stage"...
 55%|█████▍    | 6/11 [00:01<00:01,  3.15it/s]INFO:root:Plot color "Compartment_prediction"...
 64%|██████▎   | 7/11 [00:14<00:08,  2.18s/it]INFO:root:Plot color "qc_status"...
 64%|██████▎   | 7/11 [00:02<00:01,  2.94it/s]INFO:root:Plot color "Cross_tissue_broad"...
 73%|███████▎  | 8/11 [00:05<00:02,  1.31it/s]INFO:root:Plot color "pathogen"...
 73%|███████▎  | 8/11 [00:15<00:05,  1.92s/it]INFO:root:Plot color "infection_stage"...
 73%|███████▎  | 8/11 [00:03<00:01,  2.14it/s]INFO:root:Plot color "Lindeboom_broad"...
 82%|████████▏ | 9/11 [00:05<00:01,  1.46it/s]INFO:root:Plot color "Compartment_prediction"...
 91%|█████████ | 10/11 [00:06<00:00,  1.52it/s]INFO:root:Plot color "modalities"...
 82%|████████▏ | 9/11 [00:03<00:01,  1.78it/s]INFO:root:Plot color "dataset_id"...
 91%|█████████ | 10/11 [00:04<00:00,  2.06it/s]INFO:root:Plot color "qc_status"...
100%|██████████| 11/11 [00:07<00:00,  1.63it/s]100%|██████████| 11/11 [00:07<00:00,  1.57it/s]
 73%|███████▎  | 8/11 [00:16<00:06,  2.15s/it]INFO:root:Plot color "study"...
100%|██████████| 11/11 [00:04<00:00,  2.22it/s]100%|██████████| 11/11 [00:04<00:00,  2.45it/s]
[Thu Mar  6 04:17:40 2025]
Finished job 259.
131 of 169 steps (78%) done
Select jobs to execute...

[Thu Mar  6 04:17:40 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:BEAM/umap
    jobid: 247
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:BEAM
    resources: tmpdir=/tmp

 82%|████████▏ | 9/11 [00:17<00:03,  1.91s/it]INFO:root:Plot color "modalities"...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
[Thu Mar  6 04:17:41 2025]
Finished job 310.
132 of 169 steps (78%) done
Select jobs to execute...

[Thu Mar  6 04:17:41 2025]
rule filter:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/input_data/GSE182159_PBMCs.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~GSE182159_PBMCs.zarr
    jobid: 13
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~GSE182159_PBMCs.zarr
    wildcards: dataset=t_cells, file_id=GSE182159_PBMCs
    resources: tmpdir=/tmp, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp9hegw8ld.plot.py
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp68nzexls.filter.py
Activating conda environment: scanpy
 82%|████████▏ | 9/11 [00:18<00:04,  2.09s/it]INFO:root:Plot color "pathogen"...
 91%|█████████ | 10/11 [00:19<00:01,  1.87s/it]INFO:root:Plot color "infection_status"...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:BEAM...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/umap.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 1.9812573058863154}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "pathogen"...
 91%|█████████ | 10/11 [00:20<00:02,  2.05s/it]INFO:root:Plot color "dataset_id"...
100%|██████████| 11/11 [00:21<00:00,  1.87s/it]100%|██████████| 11/11 [00:21<00:00,  1.91s/it]
[Thu Mar  6 04:17:45 2025]
Finished job 181.
133 of 169 steps (79%) done
  9%|▉         | 1/11 [00:01<00:11,  1.13s/it]INFO:root:Plot color "Cross_tissue_broad"...
INFO:root:AnnData object with n_obs × n_vars = 77709 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status', 'scrublet_score', 'scrublet_prediction', 'doubletdetection_score', 'doubletdetection_prediction'
    var: 'feature_biotype', 'feature_name', 'feature_reference'
INFO:root:remove by columns...
INFO:root:{'barcode': ['/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/miscellaneous/non_t_cells_barcodes.csv']}
 18%|█▊        | 2/11 [00:02<00:10,  1.15s/it]INFO:root:Plot color "infection_stage"...
100%|██████████| 11/11 [00:22<00:00,  2.03s/it]100%|██████████| 11/11 [00:22<00:00,  2.07s/it]
[Thu Mar  6 04:17:46 2025]
Finished job 207.
134 of 169 steps (79%) done
 27%|██▋       | 3/11 [00:03<00:08,  1.06s/it]INFO:root:Plot color "Compartment_prediction"...
INFO:root:Add filtered column...
INFO:root:filtered
True    77709
Name: count, dtype: int64
INFO:root:remove genes except var_names_keep...
INFO:root:Add filtered_var column...
INFO:root:Read all slots for subsetting...
 36%|███▋      | 4/11 [00:04<00:07,  1.04s/it]INFO:root:Plot color "tissue"...
 45%|████▌     | 5/11 [00:05<00:06,  1.01s/it]INFO:root:Plot color "infection_status"...
 55%|█████▍    | 6/11 [00:06<00:04,  1.01it/s]INFO:root:Plot color "modalities"...
 64%|██████▎   | 7/11 [00:07<00:04,  1.01s/it]INFO:root:Plot color "study"...
 73%|███████▎  | 8/11 [00:08<00:02,  1.01it/s]INFO:root:Plot color "dataset_id"...
 82%|████████▏ | 9/11 [00:09<00:01,  1.02it/s]INFO:root:Plot color "qc_status"...
 91%|█████████ | 10/11 [00:10<00:01,  1.00s/it]INFO:root:Plot color "Lindeboom_broad"...
INFO:root:PCA with parameters: {'n_comps': 50}
100%|██████████| 11/11 [00:11<00:00,  1.11s/it]100%|██████████| 11/11 [00:11<00:00,  1.05s/it]
[Thu Mar  6 04:17:55 2025]
Finished job 247.
135 of 169 steps (80%) done
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 171503 × 10000
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
[Thu Mar  6 04:18:05 2025]
Finished job 192.
136 of 169 steps (80%) done
Select jobs to execute...

[Thu Mar  6 04:18:05 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/neighbors.zarr
    jobid: 270
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Liu_2021
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

[Thu Mar  6 04:18:09 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/pca
    jobid: 191
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Liu_2021
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpby1ilks8.neighbors.py
Activating conda environment: rapids_singlecell
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp2l7048jl.plot.py
Activating conda environment: scanpy
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:Liu_2021...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/pca.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 1.1661603587109264}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "Cross_tissue_broad"...
  9%|▉         | 1/11 [00:01<00:16,  1.66s/it]INFO:root:Plot color "study"...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/pca.zarr...
 18%|█▊        | 2/11 [00:02<00:13,  1.45s/it]INFO:root:Plot color "dataset_id"...
 27%|██▋       | 3/11 [00:04<00:11,  1.39s/it]INFO:root:Plot color "infection_stage"...
 36%|███▋      | 4/11 [00:05<00:09,  1.40s/it]INFO:root:Plot color "infection_status"...
 45%|████▌     | 5/11 [00:07<00:08,  1.38s/it]INFO:root:Plot color "tissue"...
 55%|█████▍    | 6/11 [00:08<00:06,  1.39s/it]INFO:root:Plot color "Compartment_prediction"...
 64%|██████▎   | 7/11 [00:09<00:05,  1.40s/it]INFO:root:Plot color "pathogen"...
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
 73%|███████▎  | 8/11 [00:11<00:04,  1.37s/it]INFO:root:Plot color "modalities"...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 149740 × 11025
    obs: '10X_3prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
 82%|████████▏ | 9/11 [00:12<00:02,  1.35s/it]INFO:root:Plot color "qc_status"...
 91%|█████████ | 10/11 [00:13<00:01,  1.36s/it]INFO:root:Plot color "Lindeboom_broad"...
[Thu Mar  6 04:18:28 2025]
Finished job 300.
137 of 169 steps (81%) done
Select jobs to execute...

[Thu Mar  6 04:18:28 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/umap.done
    jobid: 299
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/pca.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/neighbors.zarr
    wildcards: dataset=t_cells, file_id=filter:Hatje_2024_PBMCs
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

100%|██████████| 11/11 [00:15<00:00,  1.49s/it]100%|██████████| 11/11 [00:15<00:00,  1.42s/it]
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:18:31 2025]
Finished job 191.
138 of 169 steps (82%) done
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpxji3ivi0.umap.py
Activating conda environment: rapids_singlecell
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/neighbors.zarr...
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/umap.zarr...
INFO:root:Subset data by filters...
INFO:root:AnnData object with n_obs × n_vars = 77709 × 11025
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status', 'scrublet_score', 'scrublet_prediction', 'doubletdetection_score', 'doubletdetection_prediction', 'filtered'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var'
    layers: 'counts', 'final', 'raw_counts_keep'
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~GSE182159_PBMCs.zarr...
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/umap.done.
[Thu Mar  6 04:18:47 2025]
Finished job 299.
139 of 169 steps (82%) done
Select jobs to execute...

[Thu Mar  6 04:18:47 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/umap
    jobid: 298
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:Hatje_2024_PBMCs
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpajs05bbk.plot.py
Activating conda environment: scanpy
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:Hatje_2024_PBMCs...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/umap.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 1.3356484573260319}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "pathogen"...
  9%|▉         | 1/11 [00:01<00:12,  1.29s/it]INFO:root:Plot color "infection_stage"...
 18%|█▊        | 2/11 [00:02<00:11,  1.32s/it]INFO:root:Plot color "study"...
 27%|██▋       | 3/11 [00:03<00:10,  1.30s/it]INFO:root:Plot color "qc_status"...
 36%|███▋      | 4/11 [00:05<00:09,  1.33s/it]INFO:root:Plot color "modalities"...
 45%|████▌     | 5/11 [00:06<00:07,  1.31s/it]INFO:root:Plot color "tissue"...
 55%|█████▍    | 6/11 [00:07<00:06,  1.29s/it]INFO:root:Plot color "Lindeboom_broad"...
 64%|██████▎   | 7/11 [00:09<00:05,  1.44s/it]INFO:root:Plot color "infection_status"...
 73%|███████▎  | 8/11 [00:10<00:04,  1.41s/it]INFO:root:Plot color "Cross_tissue_broad"...
 82%|████████▏ | 9/11 [00:12<00:02,  1.42s/it]INFO:root:Plot color "Compartment_prediction"...
 91%|█████████ | 10/11 [00:13<00:01,  1.43s/it]INFO:root:Plot color "dataset_id"...
100%|██████████| 11/11 [00:15<00:00,  1.38s/it]100%|██████████| 11/11 [00:15<00:00,  1.37s/it]
[Thu Mar  6 04:19:06 2025]
Finished job 298.
140 of 169 steps (83%) done
[Thu Mar  6 04:19:10 2025]
Finished job 13.
141 of 169 steps (83%) done
Select jobs to execute...

[Thu Mar  6 04:19:10 2025]
localrule filter_all:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~BEAM.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~COMBAT_2022.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~Yoshida_2021.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~GSE180268.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~Lindeboom_2024_NP.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~GSE182536.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~GSE187515.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~Liu_2021.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~GSE217930.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~Waradon_Dengue.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~Lindeboom_2024_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~GSE182159_Liver.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~GSE173231.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~Reyes_2020.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~Stephenson_2021.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~GSE158769.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~Hatje_2024_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~Hatje_2024_Liver.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~Hatje_2024_SmartSeq2.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~Ren_2021_10X_3_BALF.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~Ren_2021_10X_5_BALF.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~Ren_2021_10X_3_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~Ren_2021_10X_5_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~Ren_2021_10X_3_Sputum.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~HRA000190.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~ESKD_2024.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~GSE234241_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~GSE234241_Liver.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~GSE259231_10X_5.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~GSE259231_mCEL_seq2_HBV.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~GSE259231_mCEL_seq2_HCV.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~GSE162097_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~GSE162097_TDL.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~GSE287808_NALT.zarr
    jobid: 0
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~GSE182159_PBMCs.zarr
    resources: tmpdir=/tmp

[Thu Mar  6 04:19:10 2025]
rule preprocessing_normalize:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~GSE182159_PBMCs.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/normalized.zarr
    jobid: 86
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/normalized.zarr; Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~GSE182159_PBMCs.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE182159_PBMCs
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

[Thu Mar  6 04:19:10 2025]
Finished job 0.
142 of 169 steps (84%) done
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpxsd856y_.normalize.py
Activating conda environment: scanpy
INFO:root:PCA with parameters: {'n_comps': 50}
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/filter/dataset~t_cells/file_id~GSE182159_PBMCs.zarr...
INFO:root:AnnData object with n_obs × n_vars = 77709 × 11025
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status', 'scrublet_score', 'scrublet_prediction', 'doubletdetection_score', 'doubletdetection_prediction', 'filtered'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var'
    uns: 'qc', 'scautoqc_ranges'
INFO:root:normalize_total with args={args}...
INFO:root:log-transform...
INFO:root:ensure sparse...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/normalized.zarr...
INFO:root:AnnData object with n_obs × n_vars = 77709 × 11025
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status', 'scrublet_score', 'scrublet_prediction', 'doubletdetection_score', 'doubletdetection_prediction', 'filtered'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var'
    uns: 'qc', 'scautoqc_ranges', 'log1p', 'preprocessing'
    layers: 'raw_counts', 'normcounts'
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 166683 × 10000
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
[Thu Mar  6 04:19:21 2025]
Finished job 228.
143 of 169 steps (85%) done
Select jobs to execute...

[Thu Mar  6 04:19:21 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/neighbors.zarr
    jobid: 324
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:HRA000190
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

[Thu Mar  6 04:19:26 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:HRA000190/pca
    jobid: 227
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:HRA000190
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp9tuvkjbs.neighbors.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp9rou0trz.plot.py
Activating conda environment: scanpy
[Thu Mar  6 04:19:27 2025]
Finished job 86.
144 of 169 steps (85%) done
Select jobs to execute...

[Thu Mar  6 04:19:27 2025]
rule preprocessing_highly_variable_genes:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/normalized.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/highly_variable_genes.zarr
    jobid: 87
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/highly_variable_genes.zarr; Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/normalized.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE182159_PBMCs
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

[Thu Mar  6 04:19:27 2025]
rule preprocessing_extra_hvgs:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/normalized.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/extra_hvgs.zarr
    jobid: 88
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/extra_hvgs.zarr; Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/normalized.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE182159_PBMCs
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpl06varw0.highly_variable_genes.py
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpixex7brh.extra_hvgs.py
Activating conda environment: rapids_singlecell
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:HRA000190...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/pca.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 1.1998824115236706}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "dataset_id"...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:{'n_top_genes': 10000, 'batch_key': 'dataset_id'}
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/normalized.zarr...
  9%|▉         | 1/11 [00:01<00:12,  1.21s/it]INFO:root:Plot color "study"...
INFO:root:AnnData object with n_obs × n_vars = 77709 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var'
    uns: 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
 18%|█▊        | 2/11 [00:02<00:11,  1.22s/it]INFO:root:Plot color "infection_status"...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/pca.zarr...
 27%|██▋       | 3/11 [00:03<00:09,  1.25s/it]INFO:root:Plot color "tissue"...
INFO:root:Using rapids_singlecell...
INFO:root:args: {'n_top_genes': 10000, 'batch_key': 'dataset_id'}
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/normalized.zarr...
INFO:root:AnnData object with n_obs × n_vars = 77709 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var'
    uns: 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
 36%|███▋      | 4/11 [00:04<00:08,  1.24s/it]INFO:root:Plot color "Compartment_prediction"...
INFO:root:Gene list from https://raw.githubusercontent.com/prabhakarlab/AIDA_Phase1/master/01_QualityControl/list_chrY_nonPAR_genes.txt: 522 genes
INFO:root:Remove 48 genes (subset data)...
INFO:root:Select features for all cells with arguments: {'n_top_genes': 10000, 'batch_key': 'dataset_id'}...
 45%|████▌     | 5/11 [00:06<00:07,  1.27s/it]INFO:root:Plot color "Cross_tissue_broad"...
 55%|█████▍    | 6/11 [00:07<00:06,  1.35s/it]INFO:root:Plot color "modalities"...
 64%|██████▎   | 7/11 [00:08<00:05,  1.30s/it]INFO:root:Plot color "Lindeboom_broad"...
 73%|███████▎  | 8/11 [00:10<00:04,  1.42s/it]INFO:root:Plot color "qc_status"...
INFO:root:Gene list from /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/miscellaneous/t_cell_object_var_names.csv: 11025 genes
 82%|████████▏ | 9/11 [00:11<00:02,  1.38s/it]INFO:root:Plot color "pathogen"...
INFO:root:Add 11025 user-provided genes...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/extra_hvgs.zarr...
INFO:root:Subset to 11024/11025 filtered genes...
 91%|█████████ | 10/11 [00:13<00:01,  1.32s/it]INFO:root:Plot color "infection_stage"...
100%|██████████| 11/11 [00:14<00:00,  1.31s/it]100%|██████████| 11/11 [00:14<00:00,  1.31s/it]
[Thu Mar  6 04:19:43 2025]
Finished job 88.
145 of 169 steps (86%) done
[Thu Mar  6 04:19:44 2025]
Finished job 227.
146 of 169 steps (86%) done
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 171002 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
[Thu Mar  6 04:19:51 2025]
Finished job 279.
147 of 169 steps (87%) done
Select jobs to execute...

[Thu Mar  6 04:19:51 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/umap.done
    jobid: 278
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Lindeboom_2024_PBMCs
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpmfd9tcfh.umap.py
Activating conda environment: rapids_singlecell
INFO:root:Select features with arguments: {'n_top_genes': 10000, 'batch_key': 'dataset_id'}...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/highly_variable_genes.zarr...
[Thu Mar  6 04:20:01 2025]
Finished job 87.
148 of 169 steps (88%) done
Select jobs to execute...

[Thu Mar  6 04:20:01 2025]
rule preprocessing_assemble:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/normalized.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/highly_variable_genes.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/extra_hvgs.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/preprocessed.zarr
    jobid: 85
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/preprocessed.zarr; Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/extra_hvgs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/highly_variable_genes.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/normalized.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE182159_PBMCs
    resources: tmpdir=/tmp, mem_mb=

[Thu Mar  6 04:20:01 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/pca.zarr
    jobid: 202
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/pca.zarr; Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE182159_PBMCs
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp6d1sr60c.pca.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpqbuoh48y.assemble.py
Activating conda environment: scanpy
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/neighbors.zarr...
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
INFO:root:Read first file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/normalized.zarr...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/umap.zarr...
INFO:root:add normalised counts
INFO:root:add highly variable genes
INFO:root:add highly variable genes
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/preprocessed.zarr...
INFO:root:Using rapids_singlecell...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/highly_variable_genes.zarr"...
INFO:root:AnnData object with n_obs × n_vars = 77709 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
[Thu Mar  6 04:20:08 2025]
Finished job 85.
149 of 169 steps (88%) done
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 171503 × 11015
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
INFO:root:PCA with parameters: {'n_comps': 50}
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 77709 × 10000
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/umap.done.
[Thu Mar  6 04:20:12 2025]
Finished job 278.
150 of 169 steps (89%) done
Select jobs to execute...

[Thu Mar  6 04:20:12 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/umap
    jobid: 277
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:Lindeboom_2024_PBMCs
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
[Thu Mar  6 04:20:13 2025]
Finished job 270.
151 of 169 steps (89%) done
Select jobs to execute...

[Thu Mar  6 04:20:13 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/umap.done
    jobid: 269
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/pca.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/neighbors.zarr
    wildcards: dataset=t_cells, file_id=filter:Liu_2021
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpykv_fz9g.plot.py
Activating conda environment: scanpy
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:Lindeboom_2024_PBMCs...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/umap.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 1.1695769640121167}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "Cross_tissue_broad"...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:20:16 2025]
Finished job 202.
152 of 169 steps (90%) done
Select jobs to execute...

[Thu Mar  6 04:20:16 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/neighbors.zarr
    jobid: 285
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/neighbors.zarr; Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE182159_PBMCs
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

[Thu Mar  6 04:20:16 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/pca
    jobid: 201
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/pca; Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE182159_PBMCs
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp6aefhu1f.umap.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpesopikyh.neighbors.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp4o6j5cf7.plot.py
Activating conda environment: scanpy
  9%|▉         | 1/11 [00:01<00:15,  1.55s/it]INFO:root:Plot color "dataset_id"...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE182159_PBMCs...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/pca.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 2.573704461516684}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "pathogen"...
 18%|█▊        | 2/11 [00:03<00:13,  1.49s/it]INFO:root:Plot color "qc_status"...
  9%|▉         | 1/11 [00:00<00:07,  1.27it/s]INFO:root:Plot color "Lindeboom_broad"...
 27%|██▋       | 3/11 [00:04<00:11,  1.47s/it]INFO:root:Plot color "Lindeboom_broad"...
 18%|█▊        | 2/11 [00:02<00:09,  1.04s/it]INFO:root:Plot color "dataset_id"...
 27%|██▋       | 3/11 [00:02<00:07,  1.09it/s]INFO:root:Plot color "infection_stage"...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/neighbors.zarr...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/pca.zarr...
 36%|███▋      | 4/11 [00:06<00:11,  1.62s/it]INFO:root:Plot color "infection_status"...
 36%|███▋      | 4/11 [00:03<00:06,  1.10it/s]INFO:root:Plot color "tissue"...
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
 45%|████▌     | 5/11 [00:04<00:05,  1.14it/s]INFO:root:Plot color "qc_status"...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/umap.zarr...
 45%|████▌     | 5/11 [00:07<00:09,  1.59s/it]INFO:root:Plot color "study"...
 55%|█████▍    | 6/11 [00:05<00:04,  1.16it/s]INFO:root:Plot color "study"...
 64%|██████▎   | 7/11 [00:06<00:03,  1.16it/s]INFO:root:Plot color "Cross_tissue_broad"...
 55%|█████▍    | 6/11 [00:09<00:07,  1.52s/it]INFO:root:Plot color "infection_stage"...
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
 73%|███████▎  | 8/11 [00:06<00:02,  1.19it/s]INFO:root:Plot color "Compartment_prediction"...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 77709 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
 64%|██████▎   | 7/11 [00:10<00:06,  1.50s/it]INFO:root:Plot color "modalities"...
 82%|████████▏ | 9/11 [00:07<00:01,  1.16it/s]INFO:root:Plot color "infection_status"...
 91%|█████████ | 10/11 [00:08<00:00,  1.12it/s]INFO:root:Plot color "modalities"...
 73%|███████▎  | 8/11 [00:12<00:04,  1.49s/it]INFO:root:Plot color "tissue"...
100%|██████████| 11/11 [00:09<00:00,  1.10it/s]100%|██████████| 11/11 [00:09<00:00,  1.12it/s]
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
[Thu Mar  6 04:20:29 2025]
Finished job 201.
153 of 169 steps (91%) done
[Thu Mar  6 04:20:30 2025]
Finished job 285.
154 of 169 steps (91%) done
Select jobs to execute...

[Thu Mar  6 04:20:30 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/umap.done
    jobid: 284
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/umap.zarr; Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/pca.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/neighbors.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE182159_PBMCs
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
 82%|████████▏ | 9/11 [00:13<00:02,  1.45s/it]INFO:root:Plot color "Compartment_prediction"...
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp7iapectf.umap.py
Activating conda environment: rapids_singlecell
 91%|█████████ | 10/11 [00:14<00:01,  1.46s/it]INFO:root:Plot color "pathogen"...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 481256 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
100%|██████████| 11/11 [00:16<00:00,  1.43s/it]100%|██████████| 11/11 [00:16<00:00,  1.49s/it]
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/umap.done.
[Thu Mar  6 04:20:33 2025]
Finished job 269.
155 of 169 steps (92%) done
Select jobs to execute...

[Thu Mar  6 04:20:33 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/umap
    jobid: 268
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:Liu_2021
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
[Thu Mar  6 04:20:33 2025]
Finished job 277.
156 of 169 steps (92%) done
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpe3gozzu_.plot.py
Activating conda environment: scanpy
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:Liu_2021...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/umap.zarr...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/neighbors.zarr...
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/umap.zarr...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 1.1661603587109264}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "infection_stage"...
[Thu Mar  6 04:20:37 2025]
Finished job 318.
157 of 169 steps (93%) done
Select jobs to execute...

[Thu Mar  6 04:20:37 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/umap.done
    jobid: 317
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Ren_2021_10X_5_PBMCs
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

  9%|▉         | 1/11 [00:01<00:14,  1.44s/it]INFO:root:Plot color "qc_status"...
 18%|█▊        | 2/11 [00:02<00:13,  1.46s/it]INFO:root:Plot color "modalities"...
 27%|██▋       | 3/11 [00:04<00:11,  1.42s/it]INFO:root:Plot color "dataset_id"...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpkjjwt2z9.umap.py
Activating conda environment: rapids_singlecell
 36%|███▋      | 4/11 [00:05<00:09,  1.41s/it]INFO:root:Plot color "study"...
 45%|████▌     | 5/11 [00:07<00:08,  1.40s/it]INFO:root:Plot color "tissue"...
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/umap.done.
[Thu Mar  6 04:20:44 2025]
Finished job 284.
158 of 169 steps (93%) done
Select jobs to execute...

[Thu Mar  6 04:20:44 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/umap
    jobid: 283
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/umap; Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE182159_PBMCs
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpca7xtg_3.plot.py
Activating conda environment: scanpy
 55%|█████▍    | 6/11 [00:08<00:06,  1.39s/it]INFO:root:Plot color "infection_status"...
 64%|██████▎   | 7/11 [00:09<00:05,  1.44s/it]INFO:root:Plot color "Compartment_prediction"...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE182159_PBMCs...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/umap.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/neighbors.zarr...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 2.573704461516684}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "dataset_id"...
 73%|███████▎  | 8/11 [00:11<00:04,  1.47s/it]INFO:root:Plot color "pathogen"...
  9%|▉         | 1/11 [00:00<00:09,  1.07it/s]INFO:root:Plot color "modalities"...
 18%|█▊        | 2/11 [00:01<00:07,  1.20it/s]INFO:root:Plot color "Compartment_prediction"...
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
 82%|████████▏ | 9/11 [00:12<00:02,  1.44s/it]INFO:root:Plot color "Cross_tissue_broad"...
 27%|██▋       | 3/11 [00:02<00:06,  1.19it/s]INFO:root:Plot color "qc_status"...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/umap.zarr...
 36%|███▋      | 4/11 [00:03<00:05,  1.21it/s]INFO:root:Plot color "Lindeboom_broad"...
 91%|█████████ | 10/11 [00:14<00:01,  1.51s/it]INFO:root:Plot color "Lindeboom_broad"...
 45%|████▌     | 5/11 [00:04<00:05,  1.04it/s]INFO:root:Plot color "infection_stage"...
 55%|█████▍    | 6/11 [00:05<00:04,  1.04it/s]INFO:root:Plot color "study"...
100%|██████████| 11/11 [00:16<00:00,  1.61s/it]100%|██████████| 11/11 [00:16<00:00,  1.49s/it]
[Thu Mar  6 04:20:53 2025]
Finished job 268.
159 of 169 steps (94%) done
 64%|██████▎   | 7/11 [00:06<00:03,  1.12it/s]INFO:root:Plot color "infection_status"...
 73%|███████▎  | 8/11 [00:07<00:02,  1.14it/s]INFO:root:Plot color "pathogen"...
 82%|████████▏ | 9/11 [00:07<00:01,  1.19it/s]INFO:root:Plot color "tissue"...
 91%|█████████ | 10/11 [00:08<00:00,  1.22it/s]INFO:root:Plot color "Cross_tissue_broad"...
100%|██████████| 11/11 [00:09<00:00,  1.25it/s]100%|██████████| 11/11 [00:09<00:00,  1.17it/s]
[Thu Mar  6 04:20:57 2025]
Finished job 283.
160 of 169 steps (95%) done
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/umap.done.
[Thu Mar  6 04:21:04 2025]
Finished job 317.
161 of 169 steps (95%) done
Select jobs to execute...

[Thu Mar  6 04:21:04 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/umap
    jobid: 316
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:Ren_2021_10X_5_PBMCs
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpv5jf97nc.plot.py
Activating conda environment: scanpy
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:Ren_2021_10X_5_PBMCs...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/umap.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 0.41557923433681865}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "infection_stage"...
  9%|▉         | 1/11 [00:03<00:32,  3.24s/it]INFO:root:Plot color "pathogen"...
 18%|█▊        | 2/11 [00:06<00:28,  3.11s/it]INFO:root:Plot color "infection_status"...
 27%|██▋       | 3/11 [00:09<00:24,  3.10s/it]INFO:root:Plot color "qc_status"...
 36%|███▋      | 4/11 [00:12<00:21,  3.11s/it]INFO:root:Plot color "dataset_id"...
 45%|████▌     | 5/11 [00:15<00:18,  3.07s/it]INFO:root:Plot color "Cross_tissue_broad"...
 55%|█████▍    | 6/11 [00:19<00:16,  3.27s/it]INFO:root:Plot color "tissue"...
 64%|██████▎   | 7/11 [00:22<00:12,  3.19s/it]INFO:root:Plot color "Compartment_prediction"...
 73%|███████▎  | 8/11 [00:25<00:09,  3.17s/it]INFO:root:Plot color "Lindeboom_broad"...
 82%|████████▏ | 9/11 [00:28<00:06,  3.26s/it]INFO:root:Plot color "modalities"...
 91%|█████████ | 10/11 [00:31<00:03,  3.19s/it]INFO:root:Plot color "study"...
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
100%|██████████| 11/11 [00:34<00:00,  3.14s/it]100%|██████████| 11/11 [00:34<00:00,  3.16s/it]
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 166683 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
[Thu Mar  6 04:21:44 2025]
Finished job 316.
162 of 169 steps (96%) done
[Thu Mar  6 04:21:47 2025]
Finished job 324.
163 of 169 steps (96%) done
Select jobs to execute...

[Thu Mar  6 04:21:47 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/umap.done
    jobid: 323
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:HRA000190
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp3xdi3yx7.umap.py
Activating conda environment: rapids_singlecell
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/neighbors.zarr...
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/umap.zarr...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE158769/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 489802 × 11025
    obs: '10X_3prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
[Thu Mar  6 04:22:05 2025]
Finished job 297.
164 of 169 steps (97%) done
Select jobs to execute...

[Thu Mar  6 04:22:05 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE158769/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE158769/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE158769/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE158769/umap.done
    jobid: 296
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE158769/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE158769/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE158769
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/umap.done.
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Thu Mar  6 04:22:10 2025]
Finished job 323.
165 of 169 steps (98%) done
Select jobs to execute...

[Thu Mar  6 04:22:10 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:HRA000190/umap
    jobid: 322
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:HRA000190
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp6no322r0.umap.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpd4pqpo8b.plot.py
Activating conda environment: scanpy
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:HRA000190...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/umap.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 1.1998824115236706}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "Lindeboom_broad"...
  9%|▉         | 1/11 [00:01<00:15,  1.55s/it]INFO:root:Plot color "infection_stage"...
 18%|█▊        | 2/11 [00:02<00:11,  1.32s/it]INFO:root:Plot color "pathogen"...
INFO:root:Using rapids_singlecell...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE158769/neighbors.zarr...
 27%|██▋       | 3/11 [00:03<00:09,  1.21s/it]INFO:root:Plot color "qc_status"...
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE158769/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
 36%|███▋      | 4/11 [00:04<00:08,  1.19s/it]INFO:root:Plot color "Compartment_prediction"...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE158769/umap.zarr...
 45%|████▌     | 5/11 [00:06<00:07,  1.23s/it]INFO:root:Plot color "infection_status"...
 55%|█████▍    | 6/11 [00:07<00:05,  1.19s/it]INFO:root:Plot color "tissue"...
 64%|██████▎   | 7/11 [00:08<00:04,  1.16s/it]INFO:root:Plot color "dataset_id"...
 73%|███████▎  | 8/11 [00:09<00:03,  1.14s/it]INFO:root:Plot color "study"...
 82%|████████▏ | 9/11 [00:10<00:02,  1.13s/it]INFO:root:Plot color "modalities"...
 91%|█████████ | 10/11 [00:11<00:01,  1.12s/it]INFO:root:Plot color "Cross_tissue_broad"...
100%|██████████| 11/11 [00:13<00:00,  1.16s/it]100%|██████████| 11/11 [00:13<00:00,  1.18s/it]
[Thu Mar  6 04:22:27 2025]
Finished job 322.
166 of 169 steps (98%) done
Touching output file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE158769/umap.done.
[Thu Mar  6 04:22:32 2025]
Finished job 296.
167 of 169 steps (99%) done
Select jobs to execute...

[Thu Mar  6 04:22:32 2025]
rule preprocessing_plot_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE158769/umap.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE158769/umap
    jobid: 295
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE158769/umap.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE158769
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp6ac2go7n.plot.py
Activating conda environment: scanpy
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE158769...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE158769/umap.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE158769/umap.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Parameters:
{'basis': 'X_umap', 'ncols': 1, 'size': 0.4083282632573979}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "study"...
  9%|▉         | 1/11 [00:03<00:33,  3.31s/it]INFO:root:Plot color "Lindeboom_broad"...
 18%|█▊        | 2/11 [00:06<00:31,  3.49s/it]INFO:root:Plot color "Cross_tissue_broad"...
 27%|██▋       | 3/11 [00:10<00:27,  3.43s/it]INFO:root:Plot color "infection_status"...
 36%|███▋      | 4/11 [00:13<00:23,  3.34s/it]INFO:root:Plot color "modalities"...
 45%|████▌     | 5/11 [00:16<00:19,  3.29s/it]INFO:root:Plot color "qc_status"...
 55%|█████▍    | 6/11 [00:19<00:16,  3.28s/it]INFO:root:Plot color "infection_stage"...
 64%|██████▎   | 7/11 [00:23<00:13,  3.25s/it]INFO:root:Plot color "pathogen"...
 73%|███████▎  | 8/11 [00:26<00:09,  3.24s/it]INFO:root:Plot color "dataset_id"...
 82%|████████▏ | 9/11 [00:29<00:06,  3.22s/it]INFO:root:Plot color "Compartment_prediction"...
 91%|█████████ | 10/11 [00:32<00:03,  3.24s/it]INFO:root:Plot color "tissue"...
100%|██████████| 11/11 [00:36<00:00,  3.22s/it]100%|██████████| 11/11 [00:36<00:00,  3.27s/it]
[Thu Mar  6 04:23:14 2025]
Finished job 295.
168 of 169 steps (99%) done
Select jobs to execute...

[Thu Mar  6 04:23:14 2025]
localrule preprocessing_all:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:BEAM/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE180268/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182536/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE187515/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE173231/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE158769/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:BEAM/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE180268/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE182536/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE187515/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE217930/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE173231/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE158769/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:HRA000190/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:BEAM/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE180268/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE182536/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE187515/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE217930/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE173231/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE158769/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:HRA000190/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/umap
    jobid: 36
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE173231/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:HRA000190/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE180268/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE217930/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE158769/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE182536/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE158769/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:HRA000190/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE187515/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE173231/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE180268/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:ESKD_2024/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/preprocessed.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_PBMCs/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE217930/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Liu_2021/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE234241_PBMCs/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_BALF/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE162097_TDL/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Waradon_Dengue/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_PBMCs/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Yoshida_2021/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:BEAM/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_BALF/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE182159_PBMCs/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_5_PBMCs/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE234241_Liver/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_Sputum/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:BEAM/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_SmartSeq2/umap, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE187515/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE182536/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:Stephenson_2021/pca, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/umap
    resources: tmpdir=/tmp

[Thu Mar  6 04:23:14 2025]
Finished job 36.
169 of 169 steps (100%) done
Complete log: .snakemake/log/2025-03-06T040058.454048.snakemake.log
