/tmp/1741193193.979518.shell: line 16: activate: No such file or directory
++ realpath ../sc-atlassing-toolbox
+ pipeline=/nfs/team205/ld21/repos/sc-atlassing-toolbox
+ snakemake --profile .profiles/local --configfile configs/resources.yaml configs/load_config.yaml configs/marker_genes.yaml configs/outputs.yaml configs/t_cells_0612.yaml --snakefile /nfs/team205/ld21/repos/sc-atlassing-toolbox/workflow/Snakefile --use-conda --rerun-incomplete --keep-going --printshellcmds filter_all preprocessing_all merge_all -c 10
Using profile .profiles/local for setting default command line arguments.
Config file configs/outputs.yaml is extended by additional config specified via the command line.
WARNING:ModuleConfig: No default target specified for module "collect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/collect/dataset~{dataset}.zarr..."
WARNING:ModuleConfig: No default target specified for module "uncollect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/uncollect/dataset~{dataset}/file_id~{file_id}/new_file_id~{new_file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "exploration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/exploration/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "sample_representation", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/sample_representation/dataset~{dataset}/file_id~{file_id}/method~{method}/input_type~{input_type}/use_rep~{use_rep}/var_mask~{var_mask}.zarr..."
WARNING:ModuleConfig: No default target specified for module "batch_analysis", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/batch_analysis/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "doublets", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "subset", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/subset/dataset~{dataset}/file_id~{file_id}/strategy~{strategy}.zarr..."
WARNING:ModuleConfig: No default target specified for module "label_transfer", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/label_transfer/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "integration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/integration/dataset~{dataset}/file_id~{file_id}/method~{method}/batch~{batch}/label~{label}/var_mask~{var_mask}/output_type~{output_type}.zarr..."
WARNING:ModuleConfig: No default target specified for module "marker_genes", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/marker_genes/dataset~{dataset}/file_id~{file_id}.zarr..."
Building DAG of jobs...
Using shell: /usr/local/bin/bash
Provided cores: 10
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Job stats:
job                                    count
-----------------------------------  -------
filter                                     1
filter_all                                 1
merge_all                                  1
merge_merge                                1
preprocessing_all                          1
preprocessing_assemble                     1
preprocessing_extra_hvgs                   1
preprocessing_highly_variable_genes        1
preprocessing_neighbors                   35
preprocessing_normalize                    1
preprocessing_pca                         35
preprocessing_plot_pca                    35
preprocessing_plot_umap                   35
preprocessing_umap                        35
total                                    184

Select jobs to execute...

[Wed Mar  5 16:46:50 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/pca.zarr
    jobid: 207
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:Reyes_2020
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

[Wed Mar  5 16:46:52 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/pca.zarr
    jobid: 239
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE259231_mCEL_seq2_HBV
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp6389s_26.pca.py
Activating conda environment: rapids_singlecell

[Wed Mar  5 16:46:53 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/pca.zarr
    jobid: 241
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE259231_mCEL_seq2_HCV
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpukmbhydm.pca.py
Activating conda environment: rapids_singlecell

[Wed Mar  5 16:46:53 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/pca.zarr
    jobid: 187
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:Lindeboom_2024_NP
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp3lw8t6_y.pca.py
Activating conda environment: rapids_singlecell

[Wed Mar  5 16:46:55 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/pca.zarr
    jobid: 243
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE162097_PBMCs
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell

[Wed Mar  5 16:46:55 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/pca.zarr
    jobid: 229
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:HRA000190
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpyukou1do.pca.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpk2fqgvnc.pca.py
Activating conda environment: rapids_singlecell
INFO:root:No GPU found...

[Wed Mar  5 16:46:56 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/pca.zarr
    jobid: 215
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:Hatje_2024_Liver
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmprga7iz4c.pca.py
Activating conda environment: rapids_singlecell
INFO:root:No GPU found...

[Wed Mar  5 16:46:57 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/pca.zarr
    jobid: 247
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE287808_NALT
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell

[Wed Mar  5 16:46:57 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/pca.zarr
    jobid: 201
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE182159_Liver
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/highly_variable_genes.zarr"...
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp01g5s3q7.pca.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpaq3b1m55.pca.py
Activating conda environment: rapids_singlecell
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/highly_variable_genes.zarr"...
INFO:root:No GPU found...

[Wed Mar  5 16:46:58 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/pca.zarr
    jobid: 195
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE217930
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpnsvn3kw8.pca.py
Activating conda environment: rapids_singlecell
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/highly_variable_genes.zarr"...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpwbn8r8pb.pca.py
Activating conda environment: rapids_singlecell
INFO:root:AnnData object with n_obs × n_vars = 4292 × 11017
    obs: 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'mCEL-seq2', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
INFO:root:No GPU found...
INFO:root:PCA with parameters: {'n_comps': 50}
INFO:root:No GPU found...
INFO:root:AnnData object with n_obs × n_vars = 817 × 11017
    obs: 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'mCEL-seq2', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
INFO:root:AnnData object with n_obs × n_vars = 32602 × 11025
    obs: '10X_3prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
INFO:root:No GPU found...
INFO:root:PCA with parameters: {'n_comps': 50}
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/highly_variable_genes.zarr"...
INFO:root:No GPU found...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/highly_variable_genes.zarr"...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/highly_variable_genes.zarr"...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/highly_variable_genes.zarr"...
INFO:root:No GPU found...
INFO:root:No GPU found...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 817 × 10000
    obs: 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'mCEL-seq2', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/highly_variable_genes.zarr"...
INFO:root:AnnData object with n_obs × n_vars = 6585 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
INFO:root:No GPU found...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/highly_variable_genes.zarr"...
INFO:root:PCA with parameters: {'n_comps': 50}
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 4292 × 10000
    obs: 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'mCEL-seq2', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
INFO:root:AnnData object with n_obs × n_vars = 58167 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/highly_variable_genes.zarr"...
INFO:root:AnnData object with n_obs × n_vars = 30437 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
[Wed Mar  5 16:47:06 2025]
Finished job 241.
1 of 184 steps (1%) done
Select jobs to execute...

[Wed Mar  5 16:47:06 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/pca
    jobid: 240
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE259231_mCEL_seq2_HCV
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpwel86m7m.plot.py
Activating conda environment: scanpy
INFO:root:AnnData object with n_obs × n_vars = 9891 × 11025
    obs: '10X_3prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
[Wed Mar  5 16:47:07 2025]
Finished job 239.
2 of 184 steps (1%) done
Select jobs to execute...

[Wed Mar  5 16:47:07 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/pca
    jobid: 238
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE259231_mCEL_seq2_HBV
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpnk11ntrd.plot.py
Activating conda environment: scanpy
INFO:root:PCA with parameters: {'n_comps': 50}
INFO:root:AnnData object with n_obs × n_vars = 77517 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
INFO:root:AnnData object with n_obs × n_vars = 166683 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
INFO:root:AnnData object with n_obs × n_vars = 84354 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
INFO:root:PCA with parameters: {'n_comps': 50}
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE162097_PBMCs/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 6585 × 10000
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE259231_mCEL_seq2_HCV...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE259231_mCEL_seq2_HBV...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/pca.zarr...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/pca.zarr...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 200.0}
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "infection_stage"...
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 46.59832246039143}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "qc_status"...
  9%|▉         | 1/11 [00:00<00:07,  1.35it/s]INFO:root:Plot color "study"...
  9%|▉         | 1/11 [00:00<00:07,  1.30it/s]INFO:root:Plot color "Compartment_prediction"...
 18%|█▊        | 2/11 [00:01<00:04,  2.04it/s]INFO:root:Plot color "tissue"...
 18%|█▊        | 2/11 [00:01<00:04,  1.89it/s]INFO:root:Plot color "dataset_id"...
 27%|██▋       | 3/11 [00:01<00:03,  2.47it/s]INFO:root:Plot color "Compartment_prediction"...
 27%|██▋       | 3/11 [00:01<00:03,  2.37it/s]INFO:root:Plot color "Lindeboom_broad"...
 36%|███▋      | 4/11 [00:01<00:02,  2.46it/s]INFO:root:Plot color "infection_status"...
[Wed Mar  5 16:47:14 2025]
Finished job 243.
3 of 184 steps (2%) done
Select jobs to execute...

[Wed Mar  5 16:47:14 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/neighbors.zarr
    jobid: 340
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE259231_mCEL_seq2_HBV
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

 36%|███▋      | 4/11 [00:02<00:03,  1.91it/s]INFO:root:Plot color "modalities"...
 45%|████▌     | 5/11 [00:02<00:02,  2.63it/s]INFO:root:Plot color "infection_stage"...
 45%|████▌     | 5/11 [00:02<00:02,  2.28it/s]INFO:root:Plot color "tissue"...
INFO:root:PCA with parameters: {'n_comps': 50}
 55%|█████▍    | 6/11 [00:02<00:01,  2.73it/s]INFO:root:Plot color "pathogen"...
 55%|█████▍    | 6/11 [00:02<00:01,  2.58it/s]INFO:root:Plot color "study"...
 64%|██████▎   | 7/11 [00:02<00:01,  2.97it/s]INFO:root:Plot color "dataset_id"...
 64%|██████▎   | 7/11 [00:02<00:01,  2.83it/s]INFO:root:Plot color "qc_status"...
 73%|███████▎  | 8/11 [00:02<00:00,  3.16it/s]INFO:root:Plot color "Lindeboom_broad"...
 73%|███████▎  | 8/11 [00:03<00:01,  2.94it/s]INFO:root:Plot color "pathogen"...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
 82%|████████▏ | 9/11 [00:03<00:00,  2.87it/s]INFO:root:Plot color "infection_status"...
 82%|████████▏ | 9/11 [00:03<00:00,  2.09it/s]INFO:root:Plot color "Cross_tissue_broad"...
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp_nzokwf1.neighbors.py
Activating conda environment: rapids_singlecell
 91%|█████████ | 10/11 [00:03<00:00,  2.88it/s]INFO:root:Plot color "Cross_tissue_broad"...
 91%|█████████ | 10/11 [00:04<00:00,  2.22it/s]INFO:root:Plot color "modalities"...
100%|██████████| 11/11 [00:04<00:00,  2.77it/s]100%|██████████| 11/11 [00:04<00:00,  2.51it/s]
100%|██████████| 11/11 [00:04<00:00,  2.52it/s]100%|██████████| 11/11 [00:04<00:00,  2.45it/s]
[Wed Mar  5 16:47:17 2025]
Finished job 240.
4 of 184 steps (2%) done
Select jobs to execute...

[Wed Mar  5 16:47:17 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/neighbors.zarr
    jobid: 343
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE259231_mCEL_seq2_HCV
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Wed Mar  5 16:47:19 2025]
Finished job 238.
5 of 184 steps (3%) done
Select jobs to execute...

[Wed Mar  5 16:47:19 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/pca.zarr
    jobid: 237
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE259231_10X_5
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp8k1jeyiu.neighbors.py
Activating conda environment: rapids_singlecell
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 32602 × 10000
    obs: '10X_3prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpzq8z10a5.pca.py
Activating conda environment: rapids_singlecell
INFO:root:No GPU found...
INFO:root:PCA with parameters: {'n_comps': 50}
INFO:root:No GPU found...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/pca.zarr...
[Wed Mar  5 16:47:23 2025]
Finished job 207.
6 of 184 steps (3%) done
Select jobs to execute...

[Wed Mar  5 16:47:23 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/neighbors.zarr
    jobid: 292
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Reyes_2020
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/pca.zarr...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Hatje_2024_Liver/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 9891 × 10000
    obs: '10X_3prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
INFO:root:No GPU found...
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmproj4r4c5.neighbors.py
Activating conda environment: rapids_singlecell
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/highly_variable_genes.zarr"...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 58167 × 10000
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
[Wed Mar  5 16:47:26 2025]
Finished job 215.
7 of 184 steps (4%) done
Select jobs to execute...

[Wed Mar  5 16:47:26 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/pca.zarr
    jobid: 181
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:COMBAT_2022
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

INFO:root:AnnData object with n_obs × n_vars = 4060 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Wed Mar  5 16:47:29 2025]
Finished job 247.
8 of 184 steps (4%) done
Select jobs to execute...

[Wed Mar  5 16:47:29 2025]
rule preprocessing_plot_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/pca
    jobid: 246
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/pca; Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE287808_NALT
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpnjbo6qpr.pca.py
Activating conda environment: rapids_singlecell
INFO:root:No GPU found...
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpwzjplsil.plot.py
Activating conda environment: scanpy
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/pca.zarr...
INFO:root:Wildcard string: dataset: t_cells
file_id: filter:GSE287808_NALT...
INFO:root:Read file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/pca.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/pca.zarr...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 817 × 11017
    obs: 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'mCEL-seq2', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/neighbors.zarr...
INFO:root:AnnData object with n_obs × n_vars = 4292 × 11017
    obs: 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'mCEL-seq2', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'dispersions', 'dispersions_norm', 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'highly_variable_intersection', 'highly_variable_nbatches', 'means'
    uns: 'hvg', 'log1p', 'pca', 'preprocessing', 'qc', 'scautoqc_ranges', 'neighbors'
    obsm: 'X_pca'
    layers: 'normcounts', 'raw_counts'
    obsp: 'distances', 'connectivities'
INFO:root:Configured colors:
['batch',
 'pool',
 'study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Colors after filtering:
['study',
 'dataset_id',
 'qc_status',
 'Lindeboom_broad',
 'Cross_tissue_broad',
 'Compartment_prediction',
 'pathogen',
 'infection_stage',
 'infection_status',
 'modalities',
 'tissue']
INFO:root:Remove outliers...
INFO:root:Shuffle cells...
INFO:root:Subset to requested genes...
INFO:root:No GPU found...
INFO:root:PCA with parameters: {'n_comps': 50}
INFO:root:Parameters:
{'basis': 'X_pca', 'ncols': 1, 'size': 3.4383757113139755}
  0%|          | 0/11 [00:00<?, ?it/s]INFO:root:Plot color "Compartment_prediction"...
  9%|▉         | 1/11 [00:00<00:09,  1.07it/s]INFO:root:Plot color "tissue"...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read "/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/highly_variable_genes.zarr"...
 18%|█▊        | 2/11 [00:01<00:07,  1.20it/s]INFO:root:Plot color "study"...
[Wed Mar  5 16:47:36 2025]
Finished job 340.
9 of 184 steps (5%) done
Select jobs to execute...

[Wed Mar  5 16:47:36 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/umap.done
    jobid: 339
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE259231_mCEL_seq2_HBV
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

 27%|██▋       | 3/11 [00:02<00:06,  1.25it/s]INFO:root:Plot color "infection_status"...
 36%|███▋      | 4/11 [00:03<00:05,  1.24it/s]INFO:root:Plot color "modalities"...
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 30437 × 10000
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
[Wed Mar  5 16:47:37 2025]
Finished job 343.
10 of 184 steps (5%) done
Select jobs to execute...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell

[Wed Mar  5 16:47:37 2025]
rule preprocessing_umap:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/umap.done
    jobid: 342
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/pca.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/neighbors.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE259231_mCEL_seq2_HCV
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpp5yf0zgi.umap.py
Activating conda environment: rapids_singlecell
 45%|████▌     | 5/11 [00:04<00:04,  1.27it/s]INFO:root:Plot color "dataset_id"...
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
 55%|█████▍    | 6/11 [00:04<00:03,  1.30it/s]INFO:root:Plot color "qc_status"...
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpr13a7uv5.umap.py
Activating conda environment: rapids_singlecell
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_10X_5/pca.zarr...
INFO:root:AnnData object with n_obs × n_vars = 4060 × 10000
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
 64%|██████▎   | 7/11 [00:05<00:03,  1.28it/s]INFO:root:Plot color "Cross_tissue_broad"...
[Wed Mar  5 16:47:39 2025]
Finished job 187.
11 of 184 steps (6%) done
Select jobs to execute...

[Wed Mar  5 16:47:39 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/neighbors.zarr
    jobid: 352
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/neighbors.zarr; Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:GSE287808_NALT
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpux4vdv2q.neighbors.py
Activating conda environment: rapids_singlecell
 73%|███████▎  | 8/11 [00:06<00:02,  1.15it/s]INFO:root:Plot color "Lindeboom_broad"...
[Wed Mar  5 16:47:41 2025]
Finished job 237.
12 of 184 steps (7%) done
Select jobs to execute...

[Wed Mar  5 16:47:41 2025]
rule preprocessing_neighbors:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/neighbors.zarr
    jobid: 262
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/pca.zarr
    wildcards: dataset=t_cells, file_id=filter:Lindeboom_2024_NP
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

INFO:root:No GPU found...
 82%|████████▏ | 9/11 [00:07<00:01,  1.01it/s]INFO:root:Plot color "pathogen"...
 91%|█████████ | 10/11 [00:08<00:00,  1.11it/s]INFO:root:Plot color "infection_stage"...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/neighbors.zarr...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
INFO:root:No GPU found...
INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp99jsy4hp.neighbors.py
Activating conda environment: rapids_singlecell
100%|██████████| 11/11 [00:09<00:00,  1.13it/s]100%|██████████| 11/11 [00:09<00:00,  1.16it/s]
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/neighbors.zarr...
[Wed Mar  5 16:47:44 2025]
Finished job 246.
13 of 184 steps (7%) done
Select jobs to execute...

[Wed Mar  5 16:47:44 2025]
rule preprocessing_pca:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/pca.zarr
    jobid: 223
    reason: Updated input files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/highly_variable_genes.zarr
    wildcards: dataset=t_cells, file_id=filter:Ren_2021_10X_3_PBMCs
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

INFO:root:Read representation file /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/pca.zarr for use_rep="X_pca"...
INFO:root:Compute UMAP...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
INFO:root:No GPU found...
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpslh_bbp_.pca.py
Activating conda environment: rapids_singlecell
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/pca.zarr...
INFO:root:PCA with parameters: {'n_comps': 50}
INFO:root:No GPU found...
INFO:root:AnnData object with n_obs × n_vars = 430171 × 11025
    obs: '10X_5prime', 'Compartment_prediction', 'Cross_tissue_broad', 'Cross_tissue_detailed', 'IR_VDJ_1_j_call', 'IR_VDJ_1_junction_aa', 'IR_VDJ_1_v_call', 'IR_VJ_1_j_call', 'IR_VJ_1_junction_aa', 'IR_VJ_1_v_call', 'Lindeboom_broad', 'Lindeboom_detailed', 'age', 'alternative_qc_status', 'assay', 'assay_ontology_term_id', 'author_annotation', 'barcode', 'batch_condition', 'cell_passed_qc', 'cell_type', 'cell_type_ontology_term_id', 'dataset', 'dataset_id', 'development_stage', 'development_stage_ontology_term_id', 'disease', 'disease_ontology_term_id', 'doi', 'donor', 'donor_id', 'doubletdetection_prediction', 'doubletdetection_score', 'filtered', 'infection_stage', 'infection_status', 'institution', 'is_primary_data', 'log1p_n_counts', 'log1p_n_genes', 'modalities', 'n_counts', 'n_counts_hb', 'n_counts_mito', 'n_counts_ribo', 'n_genes', 'organ', 'organism', 'organism_ontology_term_id', 'original_annotation', 'passed_qc', 'pathogen', 'percent_hb', 'percent_mito', 'percent_ribo', 'percent_top50', 'pipeline_version', 'qc_status', 'reference', 'sample', 'sample_id', 'scrublet_prediction', 'scrublet_score', 'self_reported_ethnicity', 'self_reported_ethnicity_ontology_term_id', 'sex', 'sex_ontology_term_id', 'study', 'suspension_type', 'tissue', 'tissue_ontology_term_id', 'user_qc_status'
    var: 'feature_biotype', 'feature_name', 'feature_reference', 'filtered_var', 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'highly_variable_nbatches', 'highly_variable_intersection'
    uns: 'hvg', 'log1p', 'preprocessing', 'qc', 'scautoqc_ranges'
INFO:root:Subset to highly variable genes...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/pca.zarr...
INFO:root:parameters: {'use_rep': 'X_pca', 'n_pcs': 50, 'n_neighbors': 15}
INFO:root:Write to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/umap.zarr...
Exception ignored in: <function ObjectRef.__del__ at 0x14a230550860>
Traceback (most recent call last):
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/llvmlite/binding/ffi.py", line 372, in __del__
Terminating processes on user request, this might take some time.
Traceback (most recent call last):
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmprga7iz4c.pca.py", line 66, in <module>
Traceback (most recent call last):
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpr13a7uv5.umap.py", line 100, in <module>
Traceback (most recent call last):
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpnjbo6qpr.pca.py", line 66, in <module>
    adata.write_zarr(output_file)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/_core/anndata.py", line 1926, in write_zarr
    adata, _ = subset_hvg(adata, var_column=hvg_key)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/workflow/preprocessing/rules/../scripts/utils/accessors.py", line 95, in subset_hvg
    adata, _ = subset_hvg(adata, var_column=hvg_key)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/workflow/preprocessing/rules/../scripts/utils/accessors.py", line 95, in subset_hvg
    adata = dask_compute(adata, layers=to_memory)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/workflow/preprocessing/rules/../scripts/utils/misc.py", line 188, in dask_compute
    adata = dask_compute(adata, layers=to_memory)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/workflow/preprocessing/rules/../scripts/utils/misc.py", line 188, in dask_compute
Traceback (most recent call last):
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpwbn8r8pb.pca.py", line 66, in <module>
    def __del__(self, _is_shutting_down=_is_shutting_down):

KeyboardInterrupt: 
Traceback (most recent call last):
    adata, _ = subset_hvg(adata, var_column=hvg_key)
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp99jsy4hp.neighbors.py", line 24, in <module>
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/workflow/preprocessing/rules/../scripts/utils/accessors.py", line 95, in subset_hvg
Traceback (most recent call last):
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmproj4r4c5.neighbors.py", line 69, in <module>
    adata = dask_compute(adata, layers=to_memory)
    adata = read_anndata(input_file, obs='obs', obsm='obsm', uns='uns', var='var', layers='layers')
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/workflow/preprocessing/rules/../scripts/utils/misc.py", line 188, in dask_compute
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/workflow/preprocessing/rules/../scripts/utils/io.py", line 94, in read_anndata
    sc.pp.neighbors(adata, **params)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/scanpy/neighbors/__init__.py", line 191, in neighbors
    adata = read_partial(
            ^^^^^^^^^^^^^
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/workflow/preprocessing/rules/../scripts/utils/io.py", line 149, in read_partial
    return apply_layers(
           ^^^^^^^^^^^^^
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/workflow/preprocessing/rules/../scripts/utils/misc.py", line 208, in apply_layers
    return apply_layers(
           ^^^^^^^^^^^^^
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/workflow/preprocessing/rules/../scripts/utils/misc.py", line 208, in apply_layers
    return apply_layers(
           ^^^^^^^^^^^^^
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/workflow/preprocessing/rules/../scripts/utils/misc.py", line 208, in apply_layers
    adata.X = func(adata.X, **kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/workflow/preprocessing/rules/../scripts/utils/misc.py", line 190, in <lambda>
    adata.X = func(adata.X, **kwargs)
    slots[to_slot] = {
              ^^^^^^^^^^^^^^^^^^^^^^^
                     ^
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/workflow/preprocessing/rules/../scripts/utils/misc.py", line 190, in <lambda>
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/workflow/preprocessing/rules/../scripts/utils/io.py", line 150, in <dictcomp>
    adata.X = func(adata.X, **kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/workflow/preprocessing/rules/../scripts/utils/misc.py", line 190, in <lambda>
    func=lambda x: x.compute() if isinstance(x, da.Array) else x,
                   ^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/dask/base.py", line 375, in compute
Traceback (most recent call last):
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpux4vdv2q.neighbors.py", line 69, in <module>
    func=lambda x: x.compute() if isinstance(x, da.Array) else x,
                   ^^^^^^^^^^^
    sub_slot: read_slot(
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/dask/base.py", line 375, in compute
              ^^^^^^^^^^
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/workflow/preprocessing/rules/../scripts/utils/io.py", line 201, in read_slot
    func=lambda x: x.compute() if isinstance(x, da.Array) else x,
                   ^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/dask/base.py", line 375, in compute
    return _read_slot_default(
           ^^^^^^^^^^^^^^^^^^^
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/workflow/preprocessing/rules/../scripts/utils/io.py", line 250, in _read_slot_default
    sc.pp.neighbors(adata, **params)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/scanpy/neighbors/__init__.py", line 191, in neighbors
    neighbors.compute_neighbors(
    return read_elem(elem)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/scanpy/neighbors/__init__.py", line 565, in compute_neighbors
           ^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/_io/specs/registry.py", line 351, in read_elem
    neighbors.compute_neighbors(
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/scanpy/neighbors/__init__.py", line 576, in compute_neighbors
    method, transformer, shortcut = self._handle_transformer(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/scanpy/neighbors/__init__.py", line 687, in _handle_transformer
    self._distances = transformer.fit_transform(X)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/sklearn/utils/_set_output.py", line 316, in wrapped
    (result,) = compute(self, traverse=False, **kwargs)
    (result,) = compute(self, traverse=False, **kwargs)
    from pynndescent import PyNNDescentTransformer
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/dask/base.py", line 661, in compute
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/pynndescent/__init__.py", line 5, in <module>
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/dask/base.py", line 661, in compute
    (result,) = compute(self, traverse=False, **kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/dask/base.py", line 661, in compute
    return Reader(_REGISTRY).read_elem(elem)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/_io/utils.py", line 211, in func_wrapper
    results = schedule(dsk, keys, **kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/queue.py", line 171, in get
    results = schedule(dsk, keys, **kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/queue.py", line 171, in get
    results = schedule(dsk, keys, **kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/queue.py", line 171, in get
    from .pynndescent_ import NNDescent, PyNNDescentTransformer
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/pynndescent/pynndescent_.py", line 22, in <module>
Traceback (most recent call last):
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpp5yf0zgi.umap.py", line 92, in <module>
    import pynndescent.sparse as sparse
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/pynndescent/sparse.py", line 11, in <module>
    from pynndescent.distances import (
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/pynndescent/distances.py", line 411, in <module>
    @numba.njit(
     ^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/decorators.py", line 232, in wrapper
    data_to_wrap = f(self, X, *args, **kwargs)
    self.not_empty.wait()
    self.not_empty.wait()
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/threading.py", line 327, in wait
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/threading.py", line 327, in wait
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/pynndescent/pynndescent_.py", line 2256, in fit_transform
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/_io/specs/registry.py", line 274, in read_elem
    self.not_empty.wait()
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/threading.py", line 327, in wait
    sc.tl.umap(adata, **params)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/legacy_api_wrap/__init__.py", line 80, in fn_compatible
    self.fit(X, compress_index=False)
    return read_func(elem)
           ^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/pynndescent/pynndescent_.py", line 2174, in fit
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/_io/specs/methods.py", line 724, in read_sparse
    self.index_ = NNDescent(
                  ^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/pynndescent/pynndescent_.py", line 923, in __init__
    self._neighbor_graph = nn_descent(
                           ^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/dispatcher.py", line 375, in _compile_for_args
    disp.compile(sig)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/dispatcher.py", line 905, in compile
    return fn(*args_all, **kw)
           ^^^^^^^^^^^^^^^^^^^
    waiter.acquire()
    waiter.acquire()
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/scanpy/tools/_umap.py", line 209, in umap
KeyboardInterrupt
KeyboardInterrupt
    waiter.acquire()
KeyboardInterrupt
    return sparse_dataset(elem).to_memory()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/_core/sparse_dataset.py", line 575, in to_memory
    X_umap, _ = simplicial_set_embedding(
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/umap/umap_.py", line 1193, in simplicial_set_embedding
    return_val = self.compile(tuple(argtypes))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/dispatcher.py", line 905, in compile
    embedding = optimize_layout_euclidean(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/umap/layouts.py", line 380, in optimize_layout_euclidean
    cres = self._compiler.compile(args, return_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/dispatcher.py", line 80, in compile
    status, retval = self._compile_cached(args, return_type)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/dispatcher.py", line 94, in _compile_cached
    cres = self._compiler.compile(args, return_type)
    retval = self._compile_core(args, return_type)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/dispatcher.py", line 107, in _compile_core
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/dispatcher.py", line 80, in compile
    cres = compiler.compile_extra(self.targetdescr.typing_context,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler.py", line 744, in compile_extra
    status, retval = self._compile_cached(args, return_type)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/dispatcher.py", line 94, in _compile_cached
    retval = self._compile_core(args, return_type)
    optimize_fn(
KeyboardInterrupt
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/dispatcher.py", line 107, in _compile_core
    cres = compiler.compile_extra(self.targetdescr.typing_context,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler.py", line 744, in compile_extra
    mtx.data = self.group["data"][...]
               ~~~~~~~~~~~~~~~~~~^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/zarr/core.py", line 797, in __getitem__
    return pipeline.compile_extra(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler.py", line 438, in compile_extra
    return pipeline.compile_extra(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler.py", line 438, in compile_extra
    return self._compile_bytecode()
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler.py", line 506, in _compile_bytecode
    return self._compile_bytecode()
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler.py", line 506, in _compile_bytecode
    return self._compile_core()
           ^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler.py", line 472, in _compile_core
    return self._compile_core()
           ^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler.py", line 472, in _compile_core
    pm.run(self.state)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler_machinery.py", line 356, in run
    pm.run(self.state)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler_machinery.py", line 356, in run
    result = self.get_basic_selection(pure_selection, fields=fields)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/zarr/core.py", line 923, in get_basic_selection
    return self._get_basic_selection_nd(selection=selection, out=out, fields=fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/zarr/core.py", line 965, in _get_basic_selection_nd
    return self._get_selection(indexer=indexer, out=out, fields=fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/zarr/core.py", line 1340, in _get_selection
    self._runPass(idx, pass_inst, state)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler_lock.py", line 35, in _acquire_compile_lock
    self._chunk_getitems(
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/zarr/core.py", line 2181, in _chunk_getitems
    self._runPass(idx, pass_inst, state)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler_lock.py", line 35, in _acquire_compile_lock
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler_machinery.py", line 311, in _runPass
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler_machinery.py", line 311, in _runPass
    mutated |= check(pss.run_pass, internal_state)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler_machinery.py", line 273, in check
    mangled = func(compiler_state)
              ^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/typed_passes.py", line 497, in run_pass
    mutated |= check(pss.run_pass, internal_state)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler_machinery.py", line 273, in check
    mangled = func(compiler_state)
              ^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/typed_passes.py", line 112, in run_pass
    typemap, return_type, calltypes, errs = type_inference_stage(
                                            ^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/typed_passes.py", line 93, in type_inference_stage
    errs = infer.propagate(raise_errors=raise_errors)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/typeinfer.py", line 1083, in propagate
    cfunc = targetctx.get_executable(library, fndesc, env)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/cpu.py", line 239, in get_executable
    errors = self.constraints.propagate(self)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/typeinfer.py", line 160, in propagate
    fnptr = library.get_pointer_to_function(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/codegen.py", line 989, in get_pointer_to_function
    constraint(typeinfer)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/typeinfer.py", line 583, in __call__
Traceback (most recent call last):
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpnsvn3kw8.pca.py", line 72, in <module>
    self.resolve(typeinfer, typevars, fnty)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/typeinfer.py", line 606, in resolve
    sig = typeinfer.resolve_call(fnty, pos_args, kw_args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/typeinfer.py", line 1577, in resolve_call
    sc.pp.pca(adata, **args)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/scanpy/preprocessing/_pca.py", line 285, in pca
    return self.context.resolve_function_type(fnty, pos_args, kw_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/typing/context.py", line 196, in resolve_function_type
    self._ensure_finalized()
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/codegen.py", line 567, in _ensure_finalized
    res = self._resolve_user_function_type(func, args, kws)
    self.finalize()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/codegen.py", line 762, in finalize
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/typing/context.py", line 248, in _resolve_user_function_type
    self._optimize_final_module()
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/codegen.py", line 682, in _optimize_final_module
    self._codegen._mpm_full.run(self._final_module)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/llvmlite/binding/passmanagers.py", line 698, in run
    X_pca, pca_ = _pca_with_sparse(
    return func.get_call_type(self, args, kws)
                  ^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/scanpy/preprocessing/_pca.py", line 442, in _pca_with_sparse
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/types/functions.py", line 541, in get_call_type
    self.dispatcher.get_call_template(args, kws)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/dispatcher.py", line 318, in get_call_template
    self.compile(tuple(args))
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/dispatcher.py", line 905, in compile
    u, s, v = svds(XL, solver=solver, k=n_pcs, v0=random_init)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/scipy/sparse/linalg/_eigen/_svds.py", line 515, in svds
    cres = self._compiler.compile(args, return_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/dispatcher.py", line 80, in compile
    status, retval = self._compile_cached(args, return_type)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/dispatcher.py", line 94, in _compile_cached
    retval = self._compile_core(args, return_type)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/dispatcher.py", line 107, in _compile_core
    cres = compiler.compile_extra(self.targetdescr.typing_context,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler.py", line 744, in compile_extra
    return pipeline.compile_extra(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler.py", line 438, in compile_extra
    return self._compile_bytecode()
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler.py", line 506, in _compile_bytecode
    return ffi.lib.LLVMPY_RunPassManager(self, module)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/llvmlite/binding/ffi.py", line 192, in __call__
    return self._compile_core()
           ^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler.py", line 472, in _compile_core
    pm.run(self.state)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler_machinery.py", line 356, in run
    return self._cfn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpux4vdv2q.neighbors.py", line 77, in <module>
    self._runPass(idx, pass_inst, state)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler_lock.py", line 35, in _acquire_compile_lock
    _, eigvec = eigsh(XH_X, k=k, tol=tol ** 2, maxiter=maxiter,
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/scipy/sparse/linalg/_eigen/arpack/arpack.py", line 1700, in eigsh
    assert_neighbors(adata)
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/workflow/preprocessing/rules/../scripts/utils/assertions.py", line 22, in assert_neighbors
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler_machinery.py", line 311, in _runPass
    mutated |= check(pss.run_pass, internal_state)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler_machinery.py", line 273, in check
    mangled = func(compiler_state)
              ^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/typed_passes.py", line 112, in run_pass
    typemap, return_type, calltypes, errs = type_inference_stage(
                                            ^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/typed_passes.py", line 93, in type_inference_stage
    errs = infer.propagate(raise_errors=raise_errors)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/typeinfer.py", line 1083, in propagate
Traceback (most recent call last):
    errors = self.constraints.propagate(self)
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpslh_bbp_.pca.py", line 16, in <module>
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/typeinfer.py", line 160, in propagate
    constraint(typeinfer)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/typeinfer.py", line 583, in __call__
    self.resolve(typeinfer, typevars, fnty)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/typeinfer.py", line 606, in resolve
    assert neighbors_key in adata.uns, f'neighbors key "{neighbors_key}" not on .uns'
    from utils.accessors import subset_hvg
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: neighbors key "neighbors" not on .uns
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/workflow/preprocessing/rules/../scripts/utils/accessors.py", line 3, in <module>
    sig = typeinfer.resolve_call(fnty, pos_args, kw_args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/typeinfer.py", line 1577, in resolve_call
    import anndata as ad
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/__init__.py", line 27, in <module>
    from ._io import (
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/_io/__init__.py", line 3, in <module>
    return self.context.resolve_function_type(fnty, pos_args, kw_args)
    from .h5ad import read_h5ad, write_h5ad
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/typing/context.py", line 196, in resolve_function_type
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/_io/h5ad.py", line 25, in <module>
    from ..experimental import read_dispatched
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/experimental/__init__.py", line 12, in <module>
    res = self._resolve_user_function_type(func, args, kws)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/typing/context.py", line 248, in _resolve_user_function_type
    from .pytorch import AnnLoader
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/experimental/pytorch/__init__.py", line 3, in <module>
    return func.get_call_type(self, args, kws)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/types/functions.py", line 541, in get_call_type
    from ._annloader import AnnLoader
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/experimental/pytorch/_annloader.py", line 18, in <module>
    import torch
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/torch/__init__.py", line 2487, in <module>
    self.dispatcher.get_call_template(args, kws)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/dispatcher.py", line 318, in get_call_template
    self.compile(tuple(args))
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/dispatcher.py", line 905, in compile
    from torch import _meta_registrations
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/torch/_meta_registrations.py", line 10, in <module>
    from torch._decomp import (
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/torch/_decomp/__init__.py", line 250, in <module>
    cres = self._compiler.compile(args, return_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/dispatcher.py", line 80, in compile
    status, retval = self._compile_cached(args, return_type)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/dispatcher.py", line 94, in _compile_cached
    retval = self._compile_core(args, return_type)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/dispatcher.py", line 107, in _compile_core
    cres = compiler.compile_extra(self.targetdescr.typing_context,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler.py", line 744, in compile_extra
    return pipeline.compile_extra(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler.py", line 438, in compile_extra
    return self._compile_bytecode()
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler.py", line 506, in _compile_bytecode
    return self._compile_core()
           ^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler.py", line 472, in _compile_core
    pm.run(self.state)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler_machinery.py", line 356, in run
    self._runPass(idx, pass_inst, state)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler_lock.py", line 35, in _acquire_compile_lock
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler_machinery.py", line 311, in _runPass
    import torch._refs
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/torch/_refs/__init__.py", line 1686, in <module>
    mutated |= check(pss.run_pass, internal_state)
    write_zarr(store, self, chunks=chunks)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler_machinery.py", line 273, in check
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/_io/__init__.py", line 20, in write_zarr
    mangled = func(compiler_state)
              ^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/typed_passes.py", line 468, in run_pass
    return write_zarr(*args, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/_io/zarr.py", line 48, in write_zarr
    lower.lower()
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/lowering.py", line 187, in lower
    write_dispatched(f, "/", adata, callback=callback, dataset_kwargs=ds_kwargs)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/experimental/_dispatch_io.py", line 77, in write_dispatched
    self.lower_normal_function(self.fndesc)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/lowering.py", line 226, in lower_normal_function
    @out_wrapper()
     ^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/torch/_prims_common/wrappers.py", line 263, in _out_wrapper
    writer.write_elem(store, key, elem, dataset_kwargs=dataset_kwargs)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/_io/utils.py", line 247, in func_wrapper
    entry_block_tail = self.lower_function_body()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/lowering.py", line 256, in lower_function_body
    self.lower_block(block)
    return func(*args, **kwargs)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/lowering.py", line 270, in lower_block
           ^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/_io/specs/registry.py", line 329, in write_elem
    self.lower_inst(inst)
    return self.callback(
           ^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/_io/zarr.py", line 46, in callback
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/parfors/parfor_lowering.py", line 51, in lower_inst
    _lower_parfor_parallel(self, inst)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/parfors/parfor_lowering.py", line 67, in _lower_parfor_parallel
    return _lower_parfor_parallel_std(lowerer, parfor)
    func(s, k, elem, dataset_kwargs=dataset_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/parfors/parfor_lowering.py", line 349, in _lower_parfor_parallel_std
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/_io/specs/registry.py", line 71, in wrapper
    @wraps(fn)
     ^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/functools.py", line 58, in update_wrapper
    result = func(g, k, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/_io/specs/methods.py", line 275, in write_anndata
    exp_name_to_tuple_var) = _create_gufunc_for_parfor_body(
    getattr(wrapper, attr).update(getattr(wrapped, attr, {}))
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/parfors/parfor_lowering.py", line 1586, in _create_gufunc_for_parfor_body
INFO:torch._subclasses.fake_tensor:FakeTensor cache stats:
    _writer.write_elem(g, "obs", adata.obs, dataset_kwargs=dataset_kwargs)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/_io/utils.py", line 247, in func_wrapper
    kernel_func = compiler.compile_ir(
                  ^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler.py", line 807, in compile_ir
INFO:torch._subclasses.fake_tensor:  cache_hits: 0
    return func(*args, **kwargs)
INFO:torch._subclasses.fake_tensor:  cache_misses: 0
           ^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/_io/specs/registry.py", line 329, in write_elem
    return self.callback(
           ^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/_io/zarr.py", line 46, in callback
    return pipeline.compile_ir(func_ir=func_ir, lifted=lifted,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler.py", line 448, in compile_ir
    func(s, k, elem, dataset_kwargs=dataset_kwargs)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/_io/specs/registry.py", line 71, in wrapper
    result = func(g, k, *args, **kwargs)
    return self._compile_ir()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/_io/specs/methods.py", line 830, in write_dataframe
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler.py", line 513, in _compile_ir
    _writer.write_elem(
    return self._compile_core()
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/_io/utils.py", line 247, in func_wrapper
           ^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler.py", line 472, in _compile_core
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/_io/specs/registry.py", line 329, in write_elem
    pm.run(self.state)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler_machinery.py", line 356, in run
    return self.callback(
           ^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/_io/zarr.py", line 46, in callback
    self._runPass(idx, pass_inst, state)
    func(s, k, elem, dataset_kwargs=dataset_kwargs)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/_io/specs/registry.py", line 71, in wrapper
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler_lock.py", line 35, in _acquire_compile_lock
    result = func(g, k, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/_io/specs/methods.py", line 942, in write_categorical
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler_machinery.py", line 311, in _runPass
    _writer.write_elem(
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/_io/utils.py", line 247, in func_wrapper
    mutated |= check(pss.run_pass, internal_state)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/compiler_machinery.py", line 273, in check
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/_io/specs/registry.py", line 329, in write_elem
    mangled = func(compiler_state)
              ^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/typed_passes.py", line 497, in run_pass
    return self.callback(
           ^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/_io/zarr.py", line 46, in callback
    func(s, k, elem, dataset_kwargs=dataset_kwargs)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/_io/specs/registry.py", line 71, in wrapper
    cfunc = targetctx.get_executable(library, fndesc, env)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/cpu.py", line 239, in get_executable
    result = func(g, k, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/anndata/_io/specs/methods.py", line 520, in write_vlen_string_array_zarr
    f[k][:] = elem
    ~~~~^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/zarr/core.py", line 1449, in __setitem__
    fnptr = library.get_pointer_to_function(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    self.set_basic_selection(pure_selection, value, fields=fields)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/codegen.py", line 989, in get_pointer_to_function
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/zarr/core.py", line 1545, in set_basic_selection
    self._ensure_finalized()
    return self._set_basic_selection_nd(selection, value, fields=fields)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/codegen.py", line 567, in _ensure_finalized
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/zarr/core.py", line 1935, in _set_basic_selection_nd
    self.finalize()
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/codegen.py", line 765, in finalize
    self._finalize_final_module()
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/codegen.py", line 794, in _finalize_final_module
    cleanup = self._codegen._add_module(self._final_module)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/codegen.py", line 1413, in _add_module
    self._engine.add_module(module)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/codegen.py", line 1098, in add_module
    self._load_defined_symbols(module)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/codegen.py", line 1091, in _load_defined_symbols
    self._defined_symbols |= {gv.name for gv in gsets
                             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/codegen.py", line 1092, in <setcomp>
    if not gv.is_declaration}
           ^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/llvmlite/binding/value.py", line 229, in is_declaration
    return ffi.lib.LLVMPY_IsDeclaration(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/llvmlite/binding/ffi.py", line 191, in __call__
    with self._lock:
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/llvmlite/binding/ffi.py", line 81, in __exit__
    rel_fn()
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/base.py", line 1250, in exit_fn
    event.end_event("numba:llvm_lock")
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/event.py", line 419, in end_event
    broadcast(evt)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/numba/core/event.py", line 217, in broadcast
    listener.notify(event)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmproj4r4c5.neighbors.py", line 77, in <module>
    assert_neighbors(adata)
  File "/nfs/team205/ld21/repos/sc-atlassing-toolbox/workflow/preprocessing/rules/../scripts/utils/assertions.py", line 22, in assert_neighbors
    assert neighbors_key in adata.uns, f'neighbors key "{neighbors_key}" not on .uns'
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: neighbors key "neighbors" not on .uns
    self._set_selection(indexer, value, fields=fields)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/zarr/core.py", line 1988, in _set_selection
    cdatas = self.chunk_store.getitems(ckeys, contexts=contexts)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/zarr/_storage/store.py", line 179, in getitems
    self._chunk_setitem(chunk_coords, chunk_selection, chunk_value, fields=fields)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/zarr/core.py", line 2261, in _chunk_setitem
    self._chunk_setitem_nosync(chunk_coords, chunk_selection, value, fields=fields)
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/zarr/core.py", line 2271, in _chunk_setitem_nosync
    self.chunk_store[ckey] = self._encode_chunk(cdata)
    ~~~~~~~~~~~~~~~~^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/zarr/storage.py", line 1156, in __setitem__
    return {k: self[k] for k in keys if k in self}
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/zarr/_storage/store.py", line 179, in <dictcomp>
    return {k: self[k] for k in keys if k in self}
               ~~~~^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/zarr/storage.py", line 1118, in __getitem__
    retry_call(os.replace, (temp_path, file_path), exceptions=(PermissionError,))
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/zarr/util.py", line 693, in retry_call
    return self._fromfile(filepath)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/zarr/storage.py", line 1093, in _fromfile
    return f.read()
           ^^^^^^^^
KeyboardInterrupt
    return callabl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
    params.iterate()
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/scipy/sparse/linalg/_eigen/arpack/arpack.py", line 549, in iterate
    self.workd[yslice] = self.OP(self.workd[xslice])
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/scipy/sparse/linalg/_interface.py", line 236, in matvec
    y = self._matvec(x)
        ^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/scipy/sparse/linalg/_interface.py", line 593, in _matvec
    return self.__matvec_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/scipy/sparse/linalg/_eigen/_svds.py", line 465, in matvec_XH_X
    return XH_dot(X_dot(x))
                  ^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/scipy/sparse/linalg/_interface.py", line 236, in matvec
    y = self._matvec(x)
        ^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/scipy/sparse/linalg/_interface.py", line 593, in _matvec
    return self.__matvec_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/scanpy/preprocessing/_pca.py", line 422, in matvec
    return Xdot(x) - mdot(x)
           ^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/scipy/sparse/_base.py", line 450, in dot
    return self @ other
           ~~~~~^~~~~~~
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/scipy/sparse/_base.py", line 669, in __matmul__
    return self._matmul_dispatch(other)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/scipy/sparse/_base.py", line 564, in _matmul_dispatch
    return self._matmul_vector(other)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/rapids_singlecell/lib/python3.11/site-packages/scipy/sparse/_compressed.py", line 492, in _matmul_vector
    fn(M, N, self.indptr, self.indices, self.data, other, result)
KeyboardInterrupt
[Wed Mar  5 16:47:50 2025]
Error in rule preprocessing_pca:
    jobid: 223
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Ren_2021_10X_3_PBMCs/pca.zarr
    conda-env: rapids_singlecell

[Wed Mar  5 16:47:50 2025]
Error in rule preprocessing_umap:
    jobid: 342
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HCV/umap.done
    conda-env: rapids_singlecell

[Wed Mar  5 16:47:50 2025]
Error in rule preprocessing_neighbors:
    jobid: 352
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE287808_NALT/neighbors.zarr
    conda-env: rapids_singlecell

[Wed Mar  5 16:47:50 2025]
Error in rule preprocessing_neighbors:
    jobid: 262
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Lindeboom_2024_NP/neighbors.zarr
    conda-env: rapids_singlecell

[Wed Mar  5 16:47:50 2025]
Error in rule preprocessing_pca:
    jobid: 229
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:HRA000190/pca.zarr
    conda-env: rapids_singlecell

[Wed Mar  5 16:47:50 2025]
Error in rule preprocessing_umap:
    jobid: 339
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/neighbors.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/umap.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE259231_mCEL_seq2_HBV/umap.done
    conda-env: rapids_singlecell

[Wed Mar  5 16:47:50 2025]
Error in rule preprocessing_pca:
    jobid: 181
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:COMBAT_2022/pca.zarr
    conda-env: rapids_singlecell

[Wed Mar  5 16:47:51 2025]
Error in rule preprocessing_pca:
    jobid: 201
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE182159_Liver/pca.zarr
    conda-env: rapids_singlecell

[Wed Mar  5 16:47:51 2025]
Error in rule preprocessing_neighbors:
    jobid: 292
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/pca.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:Reyes_2020/neighbors.zarr
    conda-env: rapids_singlecell

[Wed Mar  5 16:47:51 2025]
Error in rule preprocessing_pca:
    jobid: 195
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/highly_variable_genes.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/preprocessing/dataset~t_cells/file_id~filter:GSE217930/pca.zarr
    conda-env: rapids_singlecell

Terminated
