/tmp/1741190397.963512.shell: line 16: activate: No such file or directory
++ realpath ../sc-atlassing-toolbox
+ pipeline=/nfs/team205/ld21/repos/sc-atlassing-toolbox
+ snakemake --profile .profiles/local --configfile configs/outputs.yaml configs/resources.yaml configs/load_config.yaml configs/defaults.yaml configs/marker_genes.yaml configs/merge.yaml --snakefile /nfs/team205/ld21/repos/sc-atlassing-toolbox/workflow/Snakefile --use-conda --rerun-incomplete --keep-going --printshellcmds doublets_all -c 10
Using profile .profiles/local for setting default command line arguments.
Config file configs/outputs.yaml is extended by additional config specified via the command line.
WARNING:ModuleConfig: No default target specified for module "collect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/collect/dataset~{dataset}.zarr..."
WARNING:ModuleConfig: No default target specified for module "uncollect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/uncollect/dataset~{dataset}/file_id~{file_id}/new_file_id~{new_file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "exploration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/exploration/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "sample_representation", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/sample_representation/dataset~{dataset}/file_id~{file_id}/method~{method}/input_type~{input_type}/use_rep~{use_rep}/var_mask~{var_mask}.zarr..."
WARNING:ModuleConfig: No default target specified for module "batch_analysis", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/batch_analysis/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "doublets", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "subset", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/subset/dataset~{dataset}/file_id~{file_id}/strategy~{strategy}.zarr..."
WARNING:ModuleConfig: No default target specified for module "label_transfer", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/label_transfer/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "integration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/integration/dataset~{dataset}/file_id~{file_id}/method~{method}/batch~{batch}/label~{label}/var_mask~{var_mask}/output_type~{output_type}.zarr..."
WARNING:ModuleConfig: No default target specified for module "marker_genes", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/marker_genes/dataset~{dataset}/file_id~{file_id}.zarr..."
Building DAG of jobs...
Using shell: /usr/local/bin/bash
Provided cores: 10
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Job stats:
job                       count
----------------------  -------
doublets_all                  1
doublets_collect              1
doublets_split_batches        1
qc_autoqc                     1
qc_get_thresholds             1
total                         5

Select jobs to execute...

[Wed Mar  5 16:00:32 2025]
rule qc_autoqc:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/load_data/harmonize_metadata/GSE182159_PBMCs.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/autoqc/dataset~complete/file_id~GSE182159_PBMCs.zarr
    jobid: 8
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/autoqc/dataset~complete/file_id~GSE182159_PBMCs.zarr
    wildcards: dataset=complete, file_id=GSE182159_PBMCs
    resources: tmpdir=/tmp, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: qc
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpyjq5kr4f.autoqc.py
Activating conda environment: qc
INFO:root:Calculate QC metrics...
INFO:root:Calculate cell-wise QC...
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/sctk/_pipeline.py:237: RuntimeWarning: divide by zero encountered in divide
  return 5.0 / (xmax - xmin)
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/sctk/_pipeline.py:290: RuntimeWarning: invalid value encountered in multiply
  x_fit = (x_fit * f).reshape(-1, 1)
WARNING: Failed to find lower bound, using min value instead.
INFO:root:
                      low         high
n_counts      1544.257080  4128.724121
n_genes        559.857971  6312.999023
percent_mito     0.000000     3.131949
percent_ribo     0.000000   100.000000
percent_hb       0.000000     0.002409
INFO:root:Write zarr file to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/autoqc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
[Wed Mar  5 16:05:02 2025]
Finished job 8.
1 of 5 steps (20%) done
Select jobs to execute...

[Wed Mar  5 16:05:02 2025]
rule qc_get_thresholds:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/autoqc/dataset~complete/file_id~GSE182159_PBMCs.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/qc/dataset~complete/file_id~GSE182159_PBMCs/thresholds.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/qc/dataset~complete/file_id~GSE182159_PBMCs/qc_stats.tsv
    jobid: 7
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr; Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/autoqc/dataset~complete/file_id~GSE182159_PBMCs.zarr
    wildcards: dataset=complete, file_id=GSE182159_PBMCs
    resources: tmpdir=/tmp

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: qc
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpitkf43er.get_thresholds.py
Activating conda environment: qc
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/autoqc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
/nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpitkf43er.get_thresholds.py:81: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  df = pd.concat(
INFO:root:Write thresholds to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/qc/dataset~complete/file_id~GSE182159_PBMCs/thresholds.tsv...
INFO:root:Write QC stats to /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/images/qc/dataset~complete/file_id~GSE182159_PBMCs/qc_stats.tsv...
INFO:root:Write /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
[Wed Mar  5 16:05:13 2025]
Finished job 7.
2 of 5 steps (40%) done
Select jobs to execute...

[Wed Mar  5 16:05:13 2025]
checkpoint doublets_split_batches:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches
    jobid: 10
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches; Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs
    resources: tmpdir=/tmp, mem_mb=
DAG of jobs will be updated after completion.

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmppz9jwzse.split_batches.py
Activating conda environment: scanpy
INFO:root:Value counts: sample_id
GSM5519511    8081
GSM5519509    6901
GSM5519507    6889
GSM5519503    6273
GSM5519501    5458
GSM5519500    5029
GSM5519492    4793
GSM5519478    4526
GSM5519479    4040
GSM5519498    3991
GSM5519505    3349
GSM5519476    3231
GSM5519489    2875
GSM5519490    2686
GSM5519493    2686
GSM5519474    1877
GSM5519473    1782
GSM5519470    1327
GSM5519467     696
GSM5519468     655
GSM5519481     287
GSM5519480     197
GSM5519482      80
Name: count, dtype: int64
INFO:root:Batch=GSM5519482
INFO:root:Batch=GSM5519476
INFO:root:Batch=GSM5519480
INFO:root:Batch=GSM5519509
INFO:root:Batch=GSM5519481
INFO:root:Batch=GSM5519492
INFO:root:Batch=GSM5519503
INFO:root:Batch=GSM5519468
INFO:root:Batch=GSM5519470
INFO:root:Batch=GSM5519500
INFO:root:Batch=GSM5519501
INFO:root:Batch=GSM5519493
INFO:root:Batch=GSM5519505
INFO:root:Batch=GSM5519467
INFO:root:Batch=GSM5519490
INFO:root:Batch=GSM5519489
INFO:root:Batch=GSM5519473
INFO:root:Batch=GSM5519479
INFO:root:Batch=GSM5519507
INFO:root:Batch=GSM5519478
INFO:root:Batch=GSM5519474
INFO:root:Batch=GSM5519511
INFO:root:Batch=GSM5519498
[Wed Mar  5 16:05:24 2025]
Finished job 10.
3 of 5 steps (60%) done
Select jobs to execute...

[Wed Mar  5 16:05:25 2025]
rule doublets_scrublet:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519498.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519498.tsv
    jobid: 221
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519498.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519498
    priority: 1
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

[Wed Mar  5 16:05:25 2025]
rule doublets_scrublet:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519473.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519473.tsv
    jobid: 223
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519473.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519473
    priority: 1
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

[Wed Mar  5 16:05:25 2025]
rule doublets_scrublet:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519470.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519470.tsv
    jobid: 236
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519470.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519470
    priority: 1
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

[Wed Mar  5 16:05:25 2025]
rule doublets_scrublet:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519474.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519474.tsv
    jobid: 226
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519474.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519474
    priority: 1
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
Activating conda environment: rapids_singlecell
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell

[Wed Mar  5 16:05:25 2025]
rule doublets_scrublet:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519492.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519492.tsv
    jobid: 238
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519492.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519492
    priority: 1
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell

[Wed Mar  5 16:05:25 2025]
rule doublets_scrublet:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519489.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519489.tsv
    jobid: 229
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519489.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519489
    priority: 1
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell

[Wed Mar  5 16:05:25 2025]
rule doublets_scrublet:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519505.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519505.tsv
    jobid: 231
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519505.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519505
    priority: 1
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell

[Wed Mar  5 16:05:25 2025]
rule doublets_scrublet:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519511.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519511.tsv
    jobid: 237
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519511.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519511
    priority: 1
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell

[Wed Mar  5 16:05:25 2025]
rule doublets_scrublet:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519500.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519500.tsv
    jobid: 235
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519500.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519500
    priority: 1
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell

[Wed Mar  5 16:05:25 2025]
rule doublets_scrublet:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519490.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519490.tsv
    jobid: 219
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519490.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519490
    priority: 1
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp3d4f1vvq.scrublet.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpdm1st2oy.scrublet.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpp2t5174q.scrublet.py
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpunza4kdg.scrublet.py
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpy8qvf35z.scrublet.py
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpla3u3q30.scrublet.py
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp_02ex5uf.scrublet.py
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpc7n5wtqo.scrublet.py
Activating conda environment: rapids_singlecell
Activating conda environment: rapids_singlecell
Activating conda environment: rapids_singlecell
Activating conda environment: rapids_singlecell
Activating conda environment: rapids_singlecell
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpe3476u3j.scrublet.py
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpctmutm3y.scrublet.py
Activating conda environment: rapids_singlecell
Activating conda environment: rapids_singlecell
INFO:root:No GPU found...
INFO:root:No GPU found...
INFO:root:No GPU found...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:No GPU found...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:No GPU found...
INFO:root:No GPU found...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:No GPU found...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:No GPU found...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:No GPU found...
INFO:root:No GPU found...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Subset to batch GSM5519505...
INFO:root:Subset to batch GSM5519474...
INFO:root:Subset to batch GSM5519470...
INFO:root:Subset to batch GSM5519511...
INFO:root:Subset to batch GSM5519498...
INFO:root:Subset to batch GSM5519492...
INFO:root:Subset to batch GSM5519473...
INFO:root:Subset to batch GSM5519490...
INFO:root:Subset to batch GSM5519500...
INFO:root:Subset to batch GSM5519489...
INFO:root:AnnData object with n_obs × n_vars = 1327 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:AnnData object with n_obs × n_vars = 1877 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:AnnData object with n_obs × n_vars = 1782 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:AnnData object with n_obs × n_vars = 2875 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:AnnData object with n_obs × n_vars = 2686 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:AnnData object with n_obs × n_vars = 3349 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:AnnData object with n_obs × n_vars = 3991 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:AnnData object with n_obs × n_vars = 4793 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:AnnData object with n_obs × n_vars = 5029 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:AnnData object with n_obs × n_vars = 8081 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:Run scrublet...
INFO:root:Run scrublet...
INFO:root:Run scrublet...
INFO:root:Run scrublet...
INFO:root:Run scrublet...
INFO:root:Run scrublet...
INFO:root:Run scrublet...
INFO:root:Run scrublet...
INFO:root:Run scrublet...
INFO:root:Run scrublet...
INFO:root:Save results...
INFO:root:Save results...
INFO:root:Save results...
INFO:root:Save results...
INFO:root:Save results...
INFO:root:Save results...
INFO:root:Save results...
INFO:root:Save results...
INFO:root:Save results...
INFO:root:Save results...
[Wed Mar  5 16:16:35 2025]
Finished job 236.
4 of 51 steps (8%) done
Select jobs to execute...

[Wed Mar  5 16:16:35 2025]
rule doublets_scrublet:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519478.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519478.tsv
    jobid: 224
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519478.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519478
    priority: 1
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Wed Mar  5 16:16:35 2025]
Finished job 226.
5 of 51 steps (10%) done
[Wed Mar  5 16:16:35 2025]
Finished job 223.
6 of 51 steps (12%) done
[Wed Mar  5 16:16:35 2025]
Finished job 229.
7 of 51 steps (14%) done
[Wed Mar  5 16:16:35 2025]
Finished job 219.
8 of 51 steps (16%) done
[Wed Mar  5 16:16:35 2025]
Finished job 235.
9 of 51 steps (18%) done
Select jobs to execute...

[Wed Mar  5 16:16:35 2025]
rule doublets_scrublet:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519509.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519509.tsv
    jobid: 239
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519509.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519509
    priority: 1
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

[Wed Mar  5 16:16:35 2025]
rule doublets_scrublet:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519476.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519476.tsv
    jobid: 232
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519476.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519476
    priority: 1
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell

[Wed Mar  5 16:16:35 2025]
rule doublets_scrublet:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519493.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519493.tsv
    jobid: 217
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519493.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519493
    priority: 1
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell

[Wed Mar  5 16:16:35 2025]
rule doublets_scrublet:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519507.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519507.tsv
    jobid: 218
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519507.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519507
    priority: 1
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell

[Wed Mar  5 16:16:35 2025]
rule doublets_scrublet:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519479.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519479.tsv
    jobid: 233
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519479.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519479
    priority: 1
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Wed Mar  5 16:16:35 2025]
Finished job 238.
10 of 51 steps (20%) done
[Wed Mar  5 16:16:35 2025]
Finished job 221.
11 of 51 steps (22%) done
[Wed Mar  5 16:16:35 2025]
Finished job 231.
12 of 51 steps (24%) done
Select jobs to execute...

[Wed Mar  5 16:16:35 2025]
rule doublets_scrublet:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519467.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519467.tsv
    jobid: 234
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519467.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519467
    priority: 1
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

[Wed Mar  5 16:16:35 2025]
rule doublets_scrublet:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519501.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519501.tsv
    jobid: 227
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519501.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519501
    priority: 1
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell

[Wed Mar  5 16:16:35 2025]
rule doublets_scrublet:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519503.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519503.tsv
    jobid: 228
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519503.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519503
    priority: 1
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
[Wed Mar  5 16:16:35 2025]
Finished job 237.
13 of 51 steps (25%) done
Select jobs to execute...

[Wed Mar  5 16:16:35 2025]
rule doublets_scrublet:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519468.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519468.tsv
    jobid: 225
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519468.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519468
    priority: 1
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

Select jobs to execute...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmprvwdcqcg.scrublet.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpq5jbgar5.scrublet.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmppp8zwgit.scrublet.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpsxfqgyso.scrublet.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmppceiozq8.scrublet.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp2_zckfgb.scrublet.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpl_4fr5nr.scrublet.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpgdjgfnad.scrublet.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmphxnz_mhv.scrublet.py
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpsvzgzaik.scrublet.py
Activating conda environment: rapids_singlecell
INFO:root:No GPU found...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:No GPU found...
INFO:root:No GPU found...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:No GPU found...
INFO:root:No GPU found...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:No GPU found...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:No GPU found...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:No GPU found...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:No GPU found...
INFO:root:No GPU found...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Subset to batch GSM5519468...
INFO:root:Subset to batch GSM5519507...
INFO:root:Subset to batch GSM5519476...
INFO:root:AnnData object with n_obs × n_vars = 655 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:Subset to batch GSM5519467...
INFO:root:Subset to batch GSM5519478...
INFO:root:Subset to batch GSM5519501...
INFO:root:Subset to batch GSM5519503...
INFO:root:Subset to batch GSM5519479...
INFO:root:Subset to batch GSM5519493...
INFO:root:Subset to batch GSM5519509...
INFO:root:AnnData object with n_obs × n_vars = 6889 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:AnnData object with n_obs × n_vars = 696 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:AnnData object with n_obs × n_vars = 3231 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:AnnData object with n_obs × n_vars = 4526 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:AnnData object with n_obs × n_vars = 2686 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:AnnData object with n_obs × n_vars = 4040 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:AnnData object with n_obs × n_vars = 6273 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:AnnData object with n_obs × n_vars = 5458 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:AnnData object with n_obs × n_vars = 6901 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:Run scrublet...
INFO:root:Run scrublet...
INFO:root:Run scrublet...
INFO:root:Run scrublet...
INFO:root:Run scrublet...
INFO:root:Run scrublet...
INFO:root:Run scrublet...
INFO:root:Run scrublet...
INFO:root:Run scrublet...
INFO:root:Run scrublet...
INFO:root:Save results...
[Wed Mar  5 16:17:35 2025]
Finished job 225.
14 of 51 steps (27%) done

[Wed Mar  5 16:17:35 2025]
rule doublets_scrublet:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519480.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519480.tsv
    jobid: 230
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519480.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519480
    priority: 1
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp2nzgn5pf.scrublet.py
Activating conda environment: rapids_singlecell
INFO:root:Save results...
[Wed Mar  5 16:17:43 2025]
Finished job 234.
15 of 51 steps (29%) done
Select jobs to execute...

[Wed Mar  5 16:17:43 2025]
rule doublets_scrublet:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519481.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519481.tsv
    jobid: 222
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519481.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519481
    priority: 1
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpy1mx4r52.scrublet.py
Activating conda environment: rapids_singlecell
INFO:root:Save results...
[Wed Mar  5 16:17:48 2025]
Finished job 217.
16 of 51 steps (31%) done
Select jobs to execute...

[Wed Mar  5 16:17:48 2025]
rule doublets_scrublet:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519482.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519482.tsv
    jobid: 220
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519482.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519482
    priority: 1
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: rapids_singlecell
INFO:root:No GPU found...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmp1byjxjzn.scrublet.py
Activating conda environment: rapids_singlecell
INFO:root:Save results...
INFO:root:Save results...
[Wed Mar  5 16:17:52 2025]
Finished job 232.
17 of 51 steps (33%) done
Select jobs to execute...
INFO:root:Subset to batch GSM5519480...
INFO:root:AnnData object with n_obs × n_vars = 197 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:Run scrublet...
INFO:root:No GPU found...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
[Wed Mar  5 16:17:53 2025]
Finished job 233.
18 of 51 steps (35%) done
INFO:root:Subset to batch GSM5519481...
INFO:root:AnnData object with n_obs × n_vars = 287 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:Save results...
INFO:root:Run scrublet...
[Wed Mar  5 16:17:55 2025]
Finished job 224.
19 of 51 steps (37%) done

[Wed Mar  5 16:17:55 2025]
rule doublets_doubletdetection:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519505.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519505.tsv
    jobid: 254
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519505.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519505
    threads: 3
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

INFO:root:No GPU found...
INFO:root:Importing rapids failed, using scanpy...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
Config file configs/outputs.yaml is extended by additional config specified via the command line.
INFO:root:Subset to batch GSM5519482...
INFO:root:AnnData object with n_obs × n_vars = 80 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:Save results...
INFO:root:Run scrublet...
WARNING:ModuleConfig: No default target specified for module "collect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/collect/dataset~{dataset}.zarr..."
WARNING:ModuleConfig: No default target specified for module "uncollect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/uncollect/dataset~{dataset}/file_id~{file_id}/new_file_id~{new_file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "exploration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/exploration/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "sample_representation", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/sample_representation/dataset~{dataset}/file_id~{file_id}/method~{method}/input_type~{input_type}/use_rep~{use_rep}/var_mask~{var_mask}.zarr..."
WARNING:ModuleConfig: No default target specified for module "batch_analysis", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/batch_analysis/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "doublets", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "subset", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/subset/dataset~{dataset}/file_id~{file_id}/strategy~{strategy}.zarr..."
WARNING:ModuleConfig: No default target specified for module "label_transfer", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/label_transfer/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "integration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/integration/dataset~{dataset}/file_id~{file_id}/method~{method}/batch~{batch}/label~{label}/var_mask~{var_mask}/output_type~{output_type}.zarr..."
[Wed Mar  5 16:17:59 2025]
Finished job 227.
20 of 51 steps (39%) done
Select jobs to execute...
INFO:root:Save results...
WARNING:ModuleConfig: No default target specified for module "marker_genes", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/marker_genes/dataset~{dataset}/file_id~{file_id}.zarr..."
Building DAG of jobs...
Using shell: /usr/local/bin/bash
Provided cores: 10
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Select jobs to execute...
Changing to shadow directory: /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmp1r7t9n20
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
[Wed Mar  5 16:18:01 2025]
Finished job 228.
21 of 51 steps (41%) done
Activating conda environment: qc
INFO:root:Save results...
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmp1r7t9n20/.snakemake/scripts/tmp_7dt07pt.doubletdetection.py
Activating conda environment: qc
[Wed Mar  5 16:18:03 2025]
Finished job 218.
22 of 51 steps (43%) done

[Wed Mar  5 16:18:03 2025]
rule doublets_doubletdetection:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519478.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519478.tsv
    jobid: 247
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519478.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519478
    threads: 3
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

Config file configs/outputs.yaml is extended by additional config specified via the command line.
WARNING:ModuleConfig: No default target specified for module "collect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/collect/dataset~{dataset}.zarr..."
WARNING:ModuleConfig: No default target specified for module "uncollect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/uncollect/dataset~{dataset}/file_id~{file_id}/new_file_id~{new_file_id}.zarr..."
INFO:root:Save results...
WARNING:ModuleConfig: No default target specified for module "exploration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/exploration/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "sample_representation", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/sample_representation/dataset~{dataset}/file_id~{file_id}/method~{method}/input_type~{input_type}/use_rep~{use_rep}/var_mask~{var_mask}.zarr..."
WARNING:ModuleConfig: No default target specified for module "batch_analysis", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/batch_analysis/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "doublets", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "subset", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/subset/dataset~{dataset}/file_id~{file_id}/strategy~{strategy}.zarr..."
WARNING:ModuleConfig: No default target specified for module "label_transfer", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/label_transfer/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "integration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/integration/dataset~{dataset}/file_id~{file_id}/method~{method}/batch~{batch}/label~{label}/var_mask~{var_mask}/output_type~{output_type}.zarr..."
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
WARNING:ModuleConfig: No default target specified for module "marker_genes", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/marker_genes/dataset~{dataset}/file_id~{file_id}.zarr..."
Building DAG of jobs...
[Wed Mar  5 16:18:07 2025]
Finished job 239.
23 of 51 steps (45%) done
Select jobs to execute...
Using shell: /usr/local/bin/bash
Provided cores: 10
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Select jobs to execute...
Changing to shadow directory: /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpn8pb1d5k
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
INFO:root:Subset to batch GSM5519505...
INFO:root:AnnData object with n_obs × n_vars = 3349 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
Activating conda environment: qc
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpn8pb1d5k/.snakemake/scripts/tmpdy4d7j5v.doubletdetection.py
Activating conda environment: qc
INFO:root:Run doubletdetection...
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:116: UserWarning: Leiden clustering is experimental and results have not been validated.
  warnings.warn("Leiden clustering is experimental and results have not been validated.")
  0%|          | 0/10 [00:00<?, ?it/s]INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Subset to batch GSM5519478...
INFO:root:AnnData object with n_obs × n_vars = 4526 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:Run doubletdetection...
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:116: UserWarning: Leiden clustering is experimental and results have not been validated.
  warnings.warn("Leiden clustering is experimental and results have not been validated.")
  0%|          | 0/10 [00:00<?, ?it/s]/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:350: FutureWarning: In the future, the default backend for leiden will be igraph instead of leidenalg.

 To achieve the future defaults please pass: flavor="igraph" and n_iterations=2.  directed must also be False to work with igraph's implementation.
  clus(
 10%|█         | 1/10 [00:13<02:02, 13.65s/it]INFO:root:Save results...
INFO:root:Save results...
 20%|██        | 2/10 [00:16<00:57,  7.23s/it]INFO:root:Save results...
[Wed Mar  5 16:18:27 2025]
Finished job 230.
24 of 51 steps (47%) done
[Wed Mar  5 16:18:27 2025]
Finished job 220.
25 of 51 steps (49%) done

[Wed Mar  5 16:18:27 2025]
rule doublets_doubletdetection:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519493.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519493.tsv
    jobid: 240
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519493.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519493
    threads: 3
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:350: FutureWarning: In the future, the default backend for leiden will be igraph instead of leidenalg.

 To achieve the future defaults please pass: flavor="igraph" and n_iterations=2.  directed must also be False to work with igraph's implementation.
  clus(
[Wed Mar  5 16:18:28 2025]
Finished job 222.
26 of 51 steps (51%) done
Select jobs to execute...
Config file configs/outputs.yaml is extended by additional config specified via the command line.
WARNING:ModuleConfig: No default target specified for module "collect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/collect/dataset~{dataset}.zarr..."
WARNING:ModuleConfig: No default target specified for module "uncollect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/uncollect/dataset~{dataset}/file_id~{file_id}/new_file_id~{new_file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "exploration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/exploration/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "sample_representation", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/sample_representation/dataset~{dataset}/file_id~{file_id}/method~{method}/input_type~{input_type}/use_rep~{use_rep}/var_mask~{var_mask}.zarr..."
WARNING:ModuleConfig: No default target specified for module "batch_analysis", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/batch_analysis/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "doublets", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "subset", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/subset/dataset~{dataset}/file_id~{file_id}/strategy~{strategy}.zarr..."
WARNING:ModuleConfig: No default target specified for module "label_transfer", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/label_transfer/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "integration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/integration/dataset~{dataset}/file_id~{file_id}/method~{method}/batch~{batch}/label~{label}/var_mask~{var_mask}/output_type~{output_type}.zarr..."
WARNING:ModuleConfig: No default target specified for module "marker_genes", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/marker_genes/dataset~{dataset}/file_id~{file_id}.zarr..."
Building DAG of jobs...
Using shell: /usr/local/bin/bash
Provided cores: 10
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Select jobs to execute...
Changing to shadow directory: /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpgsx7q9rp
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
 30%|███       | 3/10 [00:20<00:41,  5.95s/it] 10%|█         | 1/10 [00:17<02:40, 17.78s/it]Activating conda environment: qc
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpgsx7q9rp/.snakemake/scripts/tmpdex8fdod.doubletdetection.py
Activating conda environment: qc
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
 40%|████      | 4/10 [00:25<00:31,  5.29s/it]INFO:root:Subset to batch GSM5519493...
INFO:root:AnnData object with n_obs × n_vars = 2686 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:Run doubletdetection...
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:116: UserWarning: Leiden clustering is experimental and results have not been validated.
  warnings.warn("Leiden clustering is experimental and results have not been validated.")
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:23<01:24, 10.54s/it] 50%|█████     | 5/10 [00:29<00:23,  4.79s/it] 30%|███       | 3/10 [00:27<00:53,  7.62s/it] 60%|██████    | 6/10 [00:34<00:20,  5.14s/it] 40%|████      | 4/10 [00:31<00:36,  6.16s/it]/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:350: FutureWarning: In the future, the default backend for leiden will be igraph instead of leidenalg.

 To achieve the future defaults please pass: flavor="igraph" and n_iterations=2.  directed must also be False to work with igraph's implementation.
  clus(
 10%|█         | 1/10 [00:13<02:00, 13.37s/it] 50%|█████     | 5/10 [00:35<00:27,  5.48s/it] 70%|███████   | 7/10 [00:40<00:15,  5.25s/it] 20%|██        | 2/10 [00:16<00:58,  7.30s/it] 80%|████████  | 8/10 [00:43<00:09,  4.57s/it] 60%|██████    | 6/10 [00:40<00:20,  5.21s/it] 30%|███       | 3/10 [00:18<00:35,  5.01s/it] 90%|█████████ | 9/10 [00:46<00:03,  4.00s/it] 40%|████      | 4/10 [00:20<00:23,  3.91s/it] 70%|███████   | 7/10 [00:44<00:14,  4.90s/it] 50%|█████     | 5/10 [00:23<00:17,  3.41s/it]100%|██████████| 10/10 [00:49<00:00,  3.79s/it]100%|██████████| 10/10 [00:49<00:00,  4.95s/it]
INFO:root:Save results...
Not cleaning up /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmp1r7t9n20/.snakemake/scripts/tmp_7dt07pt.doubletdetection.py
 60%|██████    | 6/10 [00:26<00:12,  3.17s/it][Wed Mar  5 16:19:02 2025]
Finished job 254.
27 of 51 steps (53%) done

[Wed Mar  5 16:19:02 2025]
rule doublets_doubletdetection:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519509.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519509.tsv
    jobid: 262
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519509.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519509
    threads: 3
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

 80%|████████  | 8/10 [00:49<00:09,  4.90s/it]Config file configs/outputs.yaml is extended by additional config specified via the command line.
 70%|███████   | 7/10 [00:29<00:09,  3.09s/it]WARNING:ModuleConfig: No default target specified for module "collect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/collect/dataset~{dataset}.zarr..."
WARNING:ModuleConfig: No default target specified for module "uncollect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/uncollect/dataset~{dataset}/file_id~{file_id}/new_file_id~{new_file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "exploration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/exploration/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "sample_representation", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/sample_representation/dataset~{dataset}/file_id~{file_id}/method~{method}/input_type~{input_type}/use_rep~{use_rep}/var_mask~{var_mask}.zarr..."
WARNING:ModuleConfig: No default target specified for module "batch_analysis", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/batch_analysis/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "doublets", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "subset", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/subset/dataset~{dataset}/file_id~{file_id}/strategy~{strategy}.zarr..."
WARNING:ModuleConfig: No default target specified for module "label_transfer", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/label_transfer/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "integration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/integration/dataset~{dataset}/file_id~{file_id}/method~{method}/batch~{batch}/label~{label}/var_mask~{var_mask}/output_type~{output_type}.zarr..."
WARNING:ModuleConfig: No default target specified for module "marker_genes", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/marker_genes/dataset~{dataset}/file_id~{file_id}.zarr..."
Building DAG of jobs...
Using shell: /usr/local/bin/bash
Provided cores: 10
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Select jobs to execute...
Changing to shadow directory: /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmp0bhvufar
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
 90%|█████████ | 9/10 [00:53<00:04,  4.67s/it]Activating conda environment: qc
 80%|████████  | 8/10 [00:31<00:05,  2.94s/it]python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmp0bhvufar/.snakemake/scripts/tmpnr9f6oum.doubletdetection.py
Activating conda environment: qc
 90%|█████████ | 9/10 [00:34<00:02,  2.93s/it]INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Subset to batch GSM5519509...
100%|██████████| 10/10 [00:58<00:00,  4.61s/it]100%|██████████| 10/10 [00:58<00:00,  5.81s/it]
INFO:root:Save results...
INFO:root:AnnData object with n_obs × n_vars = 6901 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:Run doubletdetection...
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:116: UserWarning: Leiden clustering is experimental and results have not been validated.
  warnings.warn("Leiden clustering is experimental and results have not been validated.")
  0%|          | 0/10 [00:00<?, ?it/s]Not cleaning up /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpn8pb1d5k/.snakemake/scripts/tmpdy4d7j5v.doubletdetection.py
100%|██████████| 10/10 [00:36<00:00,  2.72s/it]100%|██████████| 10/10 [00:36<00:00,  3.68s/it]
INFO:root:Save results...
Not cleaning up /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpgsx7q9rp/.snakemake/scripts/tmpdex8fdod.doubletdetection.py
[Wed Mar  5 16:19:16 2025]
Finished job 247.
28 of 51 steps (55%) done
Select jobs to execute...

[Wed Mar  5 16:19:16 2025]
rule doublets_doubletdetection:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519476.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519476.tsv
    jobid: 255
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519476.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519476
    threads: 3
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

[Wed Mar  5 16:19:17 2025]
Finished job 240.
29 of 51 steps (57%) done
Select jobs to execute...

[Wed Mar  5 16:19:17 2025]
rule doublets_doubletdetection:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519479.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519479.tsv
    jobid: 256
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519479.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519479
    threads: 3
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

Config file configs/outputs.yaml is extended by additional config specified via the command line.
WARNING:ModuleConfig: No default target specified for module "collect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/collect/dataset~{dataset}.zarr..."
WARNING:ModuleConfig: No default target specified for module "uncollect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/uncollect/dataset~{dataset}/file_id~{file_id}/new_file_id~{new_file_id}.zarr..."
Config file configs/outputs.yaml is extended by additional config specified via the command line.
WARNING:ModuleConfig: No default target specified for module "exploration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/exploration/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "sample_representation", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/sample_representation/dataset~{dataset}/file_id~{file_id}/method~{method}/input_type~{input_type}/use_rep~{use_rep}/var_mask~{var_mask}.zarr..."
WARNING:ModuleConfig: No default target specified for module "batch_analysis", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/batch_analysis/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "doublets", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "subset", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/subset/dataset~{dataset}/file_id~{file_id}/strategy~{strategy}.zarr..."
WARNING:ModuleConfig: No default target specified for module "collect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/collect/dataset~{dataset}.zarr..."
WARNING:ModuleConfig: No default target specified for module "label_transfer", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/label_transfer/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "uncollect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/uncollect/dataset~{dataset}/file_id~{file_id}/new_file_id~{new_file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "integration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/integration/dataset~{dataset}/file_id~{file_id}/method~{method}/batch~{batch}/label~{label}/var_mask~{var_mask}/output_type~{output_type}.zarr..."
WARNING:ModuleConfig: No default target specified for module "exploration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/exploration/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "sample_representation", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/sample_representation/dataset~{dataset}/file_id~{file_id}/method~{method}/input_type~{input_type}/use_rep~{use_rep}/var_mask~{var_mask}.zarr..."
WARNING:ModuleConfig: No default target specified for module "marker_genes", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/marker_genes/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "batch_analysis", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/batch_analysis/dataset~{dataset}/file_id~{file_id}.zarr..."
Building DAG of jobs...
Using shell: /usr/local/bin/bash
Provided cores: 10
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Select jobs to execute...
WARNING:ModuleConfig: No default target specified for module "doublets", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~{dataset}/file_id~{file_id}.zarr..."
Changing to shadow directory: /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpf3bp1tpy
WARNING:ModuleConfig: No default target specified for module "subset", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/subset/dataset~{dataset}/file_id~{file_id}/strategy~{strategy}.zarr..."
WARNING:ModuleConfig: No default target specified for module "label_transfer", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/label_transfer/dataset~{dataset}/file_id~{file_id}.zarr..."
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
WARNING:ModuleConfig: No default target specified for module "integration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/integration/dataset~{dataset}/file_id~{file_id}/method~{method}/batch~{batch}/label~{label}/var_mask~{var_mask}/output_type~{output_type}.zarr..."
WARNING:ModuleConfig: No default target specified for module "marker_genes", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/marker_genes/dataset~{dataset}/file_id~{file_id}.zarr..."
Building DAG of jobs...
Using shell: /usr/local/bin/bash
Provided cores: 10
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Select jobs to execute...
Changing to shadow directory: /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpo3c7w6n4
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: qc
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpf3bp1tpy/.snakemake/scripts/tmp96t7zv1e.doubletdetection.py
Activating conda environment: qc
Activating conda environment: qc
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpo3c7w6n4/.snakemake/scripts/tmpw6dxvywl.doubletdetection.py
Activating conda environment: qc
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Subset to batch GSM5519476...
INFO:root:AnnData object with n_obs × n_vars = 3231 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:Subset to batch GSM5519479...
INFO:root:AnnData object with n_obs × n_vars = 4040 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:Run doubletdetection...
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:116: UserWarning: Leiden clustering is experimental and results have not been validated.
  warnings.warn("Leiden clustering is experimental and results have not been validated.")
INFO:root:Run doubletdetection...
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:116: UserWarning: Leiden clustering is experimental and results have not been validated.
  warnings.warn("Leiden clustering is experimental and results have not been validated.")
  0%|          | 0/10 [00:00<?, ?it/s]  0%|          | 0/10 [00:00<?, ?it/s]/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:350: FutureWarning: In the future, the default backend for leiden will be igraph instead of leidenalg.

 To achieve the future defaults please pass: flavor="igraph" and n_iterations=2.  directed must also be False to work with igraph's implementation.
  clus(
 10%|█         | 1/10 [00:08<01:17,  8.61s/it]/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:350: FutureWarning: In the future, the default backend for leiden will be igraph instead of leidenalg.

 To achieve the future defaults please pass: flavor="igraph" and n_iterations=2.  directed must also be False to work with igraph's implementation.
  clus(
 10%|█         | 1/10 [00:10<01:35, 10.65s/it] 20%|██        | 2/10 [00:11<00:40,  5.05s/it] 30%|███       | 3/10 [00:13<00:26,  3.82s/it] 20%|██        | 2/10 [00:15<00:57,  7.18s/it] 40%|████      | 4/10 [00:16<00:20,  3.39s/it] 50%|█████     | 5/10 [00:19<00:16,  3.27s/it] 30%|███       | 3/10 [00:19<00:41,  5.89s/it] 60%|██████    | 6/10 [00:21<00:11,  2.98s/it] 70%|███████   | 7/10 [00:24<00:08,  2.78s/it] 40%|████      | 4/10 [00:24<00:33,  5.52s/it] 80%|████████  | 8/10 [00:26<00:05,  2.76s/it] 50%|█████     | 5/10 [00:28<00:24,  5.00s/it] 90%|█████████ | 9/10 [00:29<00:02,  2.83s/it]/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:350: FutureWarning: In the future, the default backend for leiden will be igraph instead of leidenalg.

 To achieve the future defaults please pass: flavor="igraph" and n_iterations=2.  directed must also be False to work with igraph's implementation.
  clus(
 60%|██████    | 6/10 [00:31<00:17,  4.34s/it]100%|██████████| 10/10 [00:32<00:00,  2.70s/it]100%|██████████| 10/10 [00:32<00:00,  3.22s/it]
INFO:root:Save results...
Not cleaning up /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpf3bp1tpy/.snakemake/scripts/tmp96t7zv1e.doubletdetection.py
 10%|█         | 1/10 [00:44<06:42, 44.68s/it][Wed Mar  5 16:20:00 2025]
Finished job 255.
30 of 51 steps (59%) done
Select jobs to execute...

[Wed Mar  5 16:20:00 2025]
rule doublets_doubletdetection:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519474.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519474.tsv
    jobid: 249
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519474.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519474
    threads: 3
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

 70%|███████   | 7/10 [00:35<00:12,  4.21s/it]Config file configs/outputs.yaml is extended by additional config specified via the command line.
WARNING:ModuleConfig: No default target specified for module "collect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/collect/dataset~{dataset}.zarr..."
WARNING:ModuleConfig: No default target specified for module "uncollect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/uncollect/dataset~{dataset}/file_id~{file_id}/new_file_id~{new_file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "exploration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/exploration/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "sample_representation", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/sample_representation/dataset~{dataset}/file_id~{file_id}/method~{method}/input_type~{input_type}/use_rep~{use_rep}/var_mask~{var_mask}.zarr..."
WARNING:ModuleConfig: No default target specified for module "batch_analysis", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/batch_analysis/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "doublets", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "subset", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/subset/dataset~{dataset}/file_id~{file_id}/strategy~{strategy}.zarr..."
WARNING:ModuleConfig: No default target specified for module "label_transfer", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/label_transfer/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "integration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/integration/dataset~{dataset}/file_id~{file_id}/method~{method}/batch~{batch}/label~{label}/var_mask~{var_mask}/output_type~{output_type}.zarr..."
WARNING:ModuleConfig: No default target specified for module "marker_genes", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/marker_genes/dataset~{dataset}/file_id~{file_id}.zarr..."
Building DAG of jobs...
Using shell: /usr/local/bin/bash
Provided cores: 10
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Select jobs to execute...
Changing to shadow directory: /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpvj1etsiq
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
 80%|████████  | 8/10 [00:39<00:08,  4.05s/it]Activating conda environment: qc
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpvj1etsiq/.snakemake/scripts/tmprbiiv4rr.doubletdetection.py
Activating conda environment: qc
 20%|██        | 2/10 [00:53<03:08, 23.62s/it]INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Subset to batch GSM5519474...
INFO:root:AnnData object with n_obs × n_vars = 1877 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:Run doubletdetection...
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:116: UserWarning: Leiden clustering is experimental and results have not been validated.
  warnings.warn("Leiden clustering is experimental and results have not been validated.")
  0%|          | 0/10 [00:00<?, ?it/s] 90%|█████████ | 9/10 [00:44<00:04,  4.46s/it]100%|██████████| 10/10 [00:49<00:00,  4.39s/it]100%|██████████| 10/10 [00:49<00:00,  4.91s/it]
INFO:root:Save results...
 30%|███       | 3/10 [01:01<01:54, 16.29s/it]Not cleaning up /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpo3c7w6n4/.snakemake/scripts/tmpw6dxvywl.doubletdetection.py
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:350: FutureWarning: In the future, the default backend for leiden will be igraph instead of leidenalg.

 To achieve the future defaults please pass: flavor="igraph" and n_iterations=2.  directed must also be False to work with igraph's implementation.
  clus(
 10%|█         | 1/10 [00:08<01:14,  8.32s/it][Wed Mar  5 16:20:17 2025]
Finished job 256.
31 of 51 steps (61%) done
Select jobs to execute...

[Wed Mar  5 16:20:17 2025]
rule doublets_doubletdetection:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519492.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519492.tsv
    jobid: 261
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519492.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519492
    threads: 3
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

Config file configs/outputs.yaml is extended by additional config specified via the command line.
 20%|██        | 2/10 [00:10<00:37,  4.67s/it]WARNING:ModuleConfig: No default target specified for module "collect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/collect/dataset~{dataset}.zarr..."
WARNING:ModuleConfig: No default target specified for module "uncollect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/uncollect/dataset~{dataset}/file_id~{file_id}/new_file_id~{new_file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "exploration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/exploration/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "sample_representation", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/sample_representation/dataset~{dataset}/file_id~{file_id}/method~{method}/input_type~{input_type}/use_rep~{use_rep}/var_mask~{var_mask}.zarr..."
WARNING:ModuleConfig: No default target specified for module "batch_analysis", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/batch_analysis/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "doublets", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "subset", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/subset/dataset~{dataset}/file_id~{file_id}/strategy~{strategy}.zarr..."
WARNING:ModuleConfig: No default target specified for module "label_transfer", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/label_transfer/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "integration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/integration/dataset~{dataset}/file_id~{file_id}/method~{method}/batch~{batch}/label~{label}/var_mask~{var_mask}/output_type~{output_type}.zarr..."
 30%|███       | 3/10 [00:12<00:23,  3.30s/it]WARNING:ModuleConfig: No default target specified for module "marker_genes", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/marker_genes/dataset~{dataset}/file_id~{file_id}.zarr..."
Building DAG of jobs...
Using shell: /usr/local/bin/bash
Provided cores: 10
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Select jobs to execute...
Changing to shadow directory: /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmprqge7fsi
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: qc
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmprqge7fsi/.snakemake/scripts/tmp9ive3blp.doubletdetection.py
Activating conda environment: qc
 40%|████      | 4/10 [00:14<00:17,  2.89s/it] 40%|████      | 4/10 [01:10<01:22, 13.68s/it] 50%|█████     | 5/10 [00:16<00:12,  2.51s/it]INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Subset to batch GSM5519492...
INFO:root:AnnData object with n_obs × n_vars = 4793 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:Run doubletdetection...
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:116: UserWarning: Leiden clustering is experimental and results have not been validated.
  warnings.warn("Leiden clustering is experimental and results have not been validated.")
  0%|          | 0/10 [00:00<?, ?it/s] 60%|██████    | 6/10 [00:18<00:09,  2.30s/it] 70%|███████   | 7/10 [00:19<00:06,  2.16s/it] 80%|████████  | 8/10 [00:21<00:04,  2.06s/it] 50%|█████     | 5/10 [01:19<00:59, 11.82s/it] 90%|█████████ | 9/10 [00:23<00:01,  1.99s/it]100%|██████████| 10/10 [00:25<00:00,  1.86s/it]100%|██████████| 10/10 [00:25<00:00,  2.52s/it]
INFO:root:Save results...
Not cleaning up /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpvj1etsiq/.snakemake/scripts/tmprbiiv4rr.doubletdetection.py
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:350: FutureWarning: In the future, the default backend for leiden will be igraph instead of leidenalg.

 To achieve the future defaults please pass: flavor="igraph" and n_iterations=2.  directed must also be False to work with igraph's implementation.
  clus(
[Wed Mar  5 16:20:36 2025]
Finished job 249.
32 of 51 steps (63%) done
Select jobs to execute...

[Wed Mar  5 16:20:36 2025]
rule doublets_doubletdetection:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519490.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519490.tsv
    jobid: 242
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519490.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519490
    threads: 3
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

Config file configs/outputs.yaml is extended by additional config specified via the command line.
 10%|█         | 1/10 [00:11<01:46, 11.85s/it]WARNING:ModuleConfig: No default target specified for module "collect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/collect/dataset~{dataset}.zarr..."
WARNING:ModuleConfig: No default target specified for module "uncollect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/uncollect/dataset~{dataset}/file_id~{file_id}/new_file_id~{new_file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "exploration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/exploration/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "sample_representation", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/sample_representation/dataset~{dataset}/file_id~{file_id}/method~{method}/input_type~{input_type}/use_rep~{use_rep}/var_mask~{var_mask}.zarr..."
WARNING:ModuleConfig: No default target specified for module "batch_analysis", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/batch_analysis/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "doublets", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "subset", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/subset/dataset~{dataset}/file_id~{file_id}/strategy~{strategy}.zarr..."
WARNING:ModuleConfig: No default target specified for module "label_transfer", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/label_transfer/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "integration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/integration/dataset~{dataset}/file_id~{file_id}/method~{method}/batch~{batch}/label~{label}/var_mask~{var_mask}/output_type~{output_type}.zarr..."
WARNING:ModuleConfig: No default target specified for module "marker_genes", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/marker_genes/dataset~{dataset}/file_id~{file_id}.zarr..."
Building DAG of jobs...
Using shell: /usr/local/bin/bash
Provided cores: 10
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Select jobs to execute...
Changing to shadow directory: /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpgzlfkhd2
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: qc
 60%|██████    | 6/10 [01:28<00:43, 10.82s/it]python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpgzlfkhd2/.snakemake/scripts/tmp0nuvljc6.doubletdetection.py
Activating conda environment: qc
 20%|██        | 2/10 [00:16<00:59,  7.43s/it]INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Subset to batch GSM5519490...
INFO:root:AnnData object with n_obs × n_vars = 2686 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:Run doubletdetection...
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:116: UserWarning: Leiden clustering is experimental and results have not been validated.
  warnings.warn("Leiden clustering is experimental and results have not been validated.")
  0%|          | 0/10 [00:00<?, ?it/s] 30%|███       | 3/10 [00:22<00:47,  6.80s/it] 70%|███████   | 7/10 [01:37<00:31, 10.45s/it] 40%|████      | 4/10 [00:26<00:34,  5.68s/it]/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:350: FutureWarning: In the future, the default backend for leiden will be igraph instead of leidenalg.

 To achieve the future defaults please pass: flavor="igraph" and n_iterations=2.  directed must also be False to work with igraph's implementation.
  clus(
 10%|█         | 1/10 [00:10<01:33, 10.38s/it] 50%|█████     | 5/10 [00:31<00:27,  5.53s/it] 20%|██        | 2/10 [00:13<00:46,  5.84s/it] 80%|████████  | 8/10 [01:45<00:19,  9.53s/it] 30%|███       | 3/10 [00:15<00:30,  4.36s/it] 60%|██████    | 6/10 [00:36<00:20,  5.23s/it] 40%|████      | 4/10 [00:18<00:22,  3.81s/it] 70%|███████   | 7/10 [00:40<00:14,  4.90s/it] 90%|█████████ | 9/10 [01:53<00:09,  9.20s/it] 50%|█████     | 5/10 [00:21<00:18,  3.61s/it] 60%|██████    | 6/10 [00:24<00:12,  3.23s/it] 80%|████████  | 8/10 [00:44<00:09,  4.80s/it] 70%|███████   | 7/10 [00:27<00:09,  3.18s/it] 90%|█████████ | 9/10 [00:48<00:04,  4.56s/it]100%|██████████| 10/10 [02:02<00:00,  9.05s/it]100%|██████████| 10/10 [02:02<00:00, 12.27s/it]
INFO:root:Save results...
 80%|████████  | 8/10 [00:30<00:06,  3.10s/it]Not cleaning up /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmp0bhvufar/.snakemake/scripts/tmpnr9f6oum.doubletdetection.py
 90%|█████████ | 9/10 [00:32<00:02,  2.95s/it]100%|██████████| 10/10 [00:53<00:00,  4.68s/it]100%|██████████| 10/10 [00:53<00:00,  5.39s/it]
INFO:root:Save results...
[Wed Mar  5 16:21:19 2025]
Finished job 262.
33 of 51 steps (65%) done
Select jobs to execute...

[Wed Mar  5 16:21:19 2025]
rule doublets_doubletdetection:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519500.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519500.tsv
    jobid: 258
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519500.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519500
    threads: 3
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

Not cleaning up /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmprqge7fsi/.snakemake/scripts/tmp9ive3blp.doubletdetection.py
Config file configs/outputs.yaml is extended by additional config specified via the command line.
100%|██████████| 10/10 [00:36<00:00,  2.98s/it]100%|██████████| 10/10 [00:36<00:00,  3.60s/it]
INFO:root:Save results...
WARNING:ModuleConfig: No default target specified for module "collect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/collect/dataset~{dataset}.zarr..."
WARNING:ModuleConfig: No default target specified for module "uncollect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/uncollect/dataset~{dataset}/file_id~{file_id}/new_file_id~{new_file_id}.zarr..."
Not cleaning up /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpgzlfkhd2/.snakemake/scripts/tmp0nuvljc6.doubletdetection.py
WARNING:ModuleConfig: No default target specified for module "exploration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/exploration/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "sample_representation", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/sample_representation/dataset~{dataset}/file_id~{file_id}/method~{method}/input_type~{input_type}/use_rep~{use_rep}/var_mask~{var_mask}.zarr..."
WARNING:ModuleConfig: No default target specified for module "batch_analysis", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/batch_analysis/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "doublets", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "subset", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/subset/dataset~{dataset}/file_id~{file_id}/strategy~{strategy}.zarr..."
WARNING:ModuleConfig: No default target specified for module "label_transfer", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/label_transfer/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "integration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/integration/dataset~{dataset}/file_id~{file_id}/method~{method}/batch~{batch}/label~{label}/var_mask~{var_mask}/output_type~{output_type}.zarr..."
WARNING:ModuleConfig: No default target specified for module "marker_genes", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/marker_genes/dataset~{dataset}/file_id~{file_id}.zarr..."
Building DAG of jobs...
Using shell: /usr/local/bin/bash
Provided cores: 10
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Select jobs to execute...
[Wed Mar  5 16:21:22 2025]
Finished job 261.
34 of 51 steps (67%) done
Select jobs to execute...

[Wed Mar  5 16:21:22 2025]
rule doublets_doubletdetection:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519503.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519503.tsv
    jobid: 251
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519503.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519503
    threads: 3
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

Changing to shadow directory: /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpahx_20ud
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Config file configs/outputs.yaml is extended by additional config specified via the command line.
Activating conda environment: qc
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpahx_20ud/.snakemake/scripts/tmp74n9cczj.doubletdetection.py
Activating conda environment: qc
[Wed Mar  5 16:21:23 2025]
Finished job 242.
35 of 51 steps (69%) done
Select jobs to execute...

[Wed Mar  5 16:21:23 2025]
rule doublets_doubletdetection:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519498.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519498.tsv
    jobid: 244
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519498.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519498
    threads: 3
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

WARNING:ModuleConfig: No default target specified for module "collect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/collect/dataset~{dataset}.zarr..."
WARNING:ModuleConfig: No default target specified for module "uncollect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/uncollect/dataset~{dataset}/file_id~{file_id}/new_file_id~{new_file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "exploration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/exploration/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "sample_representation", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/sample_representation/dataset~{dataset}/file_id~{file_id}/method~{method}/input_type~{input_type}/use_rep~{use_rep}/var_mask~{var_mask}.zarr..."
Config file configs/outputs.yaml is extended by additional config specified via the command line.
WARNING:ModuleConfig: No default target specified for module "batch_analysis", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/batch_analysis/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "doublets", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "subset", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/subset/dataset~{dataset}/file_id~{file_id}/strategy~{strategy}.zarr..."
WARNING:ModuleConfig: No default target specified for module "label_transfer", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/label_transfer/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "integration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/integration/dataset~{dataset}/file_id~{file_id}/method~{method}/batch~{batch}/label~{label}/var_mask~{var_mask}/output_type~{output_type}.zarr..."
WARNING:ModuleConfig: No default target specified for module "collect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/collect/dataset~{dataset}.zarr..."
WARNING:ModuleConfig: No default target specified for module "uncollect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/uncollect/dataset~{dataset}/file_id~{file_id}/new_file_id~{new_file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "marker_genes", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/marker_genes/dataset~{dataset}/file_id~{file_id}.zarr..."
Building DAG of jobs...
WARNING:ModuleConfig: No default target specified for module "exploration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/exploration/dataset~{dataset}/file_id~{file_id}.zarr..."
Using shell: /usr/local/bin/bash
Provided cores: 10
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Select jobs to execute...
Changing to shadow directory: /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpwyrkxqw6
WARNING:ModuleConfig: No default target specified for module "sample_representation", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/sample_representation/dataset~{dataset}/file_id~{file_id}/method~{method}/input_type~{input_type}/use_rep~{use_rep}/var_mask~{var_mask}.zarr..."
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
WARNING:ModuleConfig: No default target specified for module "batch_analysis", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/batch_analysis/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "doublets", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "subset", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/subset/dataset~{dataset}/file_id~{file_id}/strategy~{strategy}.zarr..."
WARNING:ModuleConfig: No default target specified for module "label_transfer", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/label_transfer/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "integration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/integration/dataset~{dataset}/file_id~{file_id}/method~{method}/batch~{batch}/label~{label}/var_mask~{var_mask}/output_type~{output_type}.zarr..."
WARNING:ModuleConfig: No default target specified for module "marker_genes", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/marker_genes/dataset~{dataset}/file_id~{file_id}.zarr..."
Building DAG of jobs...
Using shell: /usr/local/bin/bash
Provided cores: 10
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Select jobs to execute...
Changing to shadow directory: /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpqxf97yan
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: qc
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpwyrkxqw6/.snakemake/scripts/tmp7d2gf2nx.doubletdetection.py
Activating conda environment: qc
INFO:root:Subset to batch GSM5519500...
INFO:root:AnnData object with n_obs × n_vars = 5029 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:Run doubletdetection...
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:116: UserWarning: Leiden clustering is experimental and results have not been validated.
  warnings.warn("Leiden clustering is experimental and results have not been validated.")
Activating conda environment: qc
  0%|          | 0/10 [00:00<?, ?it/s]python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpqxf97yan/.snakemake/scripts/tmpl82py5yl.doubletdetection.py
Activating conda environment: qc
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Subset to batch GSM5519503...
INFO:root:AnnData object with n_obs × n_vars = 6273 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:Run doubletdetection...
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:116: UserWarning: Leiden clustering is experimental and results have not been validated.
  warnings.warn("Leiden clustering is experimental and results have not been validated.")
  0%|          | 0/10 [00:00<?, ?it/s]INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Subset to batch GSM5519498...
INFO:root:AnnData object with n_obs × n_vars = 3991 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:Run doubletdetection...
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:116: UserWarning: Leiden clustering is experimental and results have not been validated.
  warnings.warn("Leiden clustering is experimental and results have not been validated.")
  0%|          | 0/10 [00:00<?, ?it/s]/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:350: FutureWarning: In the future, the default backend for leiden will be igraph instead of leidenalg.

 To achieve the future defaults please pass: flavor="igraph" and n_iterations=2.  directed must also be False to work with igraph's implementation.
  clus(
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:350: FutureWarning: In the future, the default backend for leiden will be igraph instead of leidenalg.

 To achieve the future defaults please pass: flavor="igraph" and n_iterations=2.  directed must also be False to work with igraph's implementation.
  clus(
 10%|█         | 1/10 [00:12<01:56, 12.98s/it] 10%|█         | 1/10 [00:09<01:28,  9.79s/it]/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:350: FutureWarning: In the future, the default backend for leiden will be igraph instead of leidenalg.

 To achieve the future defaults please pass: flavor="igraph" and n_iterations=2.  directed must also be False to work with igraph's implementation.
  clus(
 10%|█         | 1/10 [00:12<01:55, 12.84s/it] 20%|██        | 2/10 [00:13<00:50,  6.28s/it] 20%|██        | 2/10 [00:18<01:06,  8.31s/it] 30%|███       | 3/10 [00:17<00:36,  5.18s/it] 20%|██        | 2/10 [00:18<01:09,  8.73s/it] 30%|███       | 3/10 [00:23<00:47,  6.82s/it] 40%|████      | 4/10 [00:21<00:28,  4.72s/it] 30%|███       | 3/10 [00:25<00:53,  7.70s/it] 40%|████      | 4/10 [00:28<00:37,  6.25s/it] 50%|█████     | 5/10 [00:25<00:21,  4.32s/it] 60%|██████    | 6/10 [00:28<00:15,  3.96s/it] 40%|████      | 4/10 [00:30<00:40,  6.72s/it] 50%|█████     | 5/10 [00:33<00:28,  5.65s/it] 70%|███████   | 7/10 [00:31<00:10,  3.66s/it] 60%|██████    | 6/10 [00:38<00:22,  5.55s/it] 80%|████████  | 8/10 [00:34<00:07,  3.61s/it] 50%|█████     | 5/10 [00:35<00:31,  6.29s/it] 90%|█████████ | 9/10 [00:38<00:03,  3.72s/it] 60%|██████    | 6/10 [00:41<00:24,  6.03s/it] 70%|███████   | 7/10 [00:44<00:16,  5.60s/it]100%|██████████| 10/10 [00:42<00:00,  3.55s/it]100%|██████████| 10/10 [00:42<00:00,  4.20s/it]
INFO:root:Save results...
Not cleaning up /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpqxf97yan/.snakemake/scripts/tmpl82py5yl.doubletdetection.py
[Wed Mar  5 16:22:16 2025]
Finished job 244.
36 of 51 steps (71%) done
Select jobs to execute...

[Wed Mar  5 16:22:16 2025]
rule doublets_doubletdetection:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519511.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519511.tsv
    jobid: 260
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519511.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519511
    threads: 3
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

 70%|███████   | 7/10 [00:46<00:17,  5.78s/it] 80%|████████  | 8/10 [00:49<00:11,  5.62s/it]Config file configs/outputs.yaml is extended by additional config specified via the command line.
WARNING:ModuleConfig: No default target specified for module "collect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/collect/dataset~{dataset}.zarr..."
WARNING:ModuleConfig: No default target specified for module "uncollect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/uncollect/dataset~{dataset}/file_id~{file_id}/new_file_id~{new_file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "exploration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/exploration/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "sample_representation", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/sample_representation/dataset~{dataset}/file_id~{file_id}/method~{method}/input_type~{input_type}/use_rep~{use_rep}/var_mask~{var_mask}.zarr..."
WARNING:ModuleConfig: No default target specified for module "batch_analysis", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/batch_analysis/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "doublets", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "subset", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/subset/dataset~{dataset}/file_id~{file_id}/strategy~{strategy}.zarr..."
WARNING:ModuleConfig: No default target specified for module "label_transfer", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/label_transfer/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "integration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/integration/dataset~{dataset}/file_id~{file_id}/method~{method}/batch~{batch}/label~{label}/var_mask~{var_mask}/output_type~{output_type}.zarr..."
WARNING:ModuleConfig: No default target specified for module "marker_genes", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/marker_genes/dataset~{dataset}/file_id~{file_id}.zarr..."
Building DAG of jobs...
Using shell: /usr/local/bin/bash
Provided cores: 10
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Select jobs to execute...
Changing to shadow directory: /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpuss3nsei
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: qc
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpuss3nsei/.snakemake/scripts/tmpmb5i8sza.doubletdetection.py
Activating conda environment: qc
 80%|████████  | 8/10 [00:52<00:11,  5.85s/it] 90%|█████████ | 9/10 [00:55<00:05,  5.67s/it]INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Subset to batch GSM5519511...
INFO:root:AnnData object with n_obs × n_vars = 8081 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:Run doubletdetection...
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:116: UserWarning: Leiden clustering is experimental and results have not been validated.
  warnings.warn("Leiden clustering is experimental and results have not been validated.")
  0%|          | 0/10 [00:00<?, ?it/s]100%|██████████| 10/10 [01:00<00:00,  5.40s/it]100%|██████████| 10/10 [01:00<00:00,  6.03s/it]
INFO:root:Save results...
 90%|█████████ | 9/10 [00:57<00:05,  5.62s/it]Not cleaning up /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpahx_20ud/.snakemake/scripts/tmp74n9cczj.doubletdetection.py
[Wed Mar  5 16:22:30 2025]
Finished job 258.
37 of 51 steps (73%) done
Select jobs to execute...

[Wed Mar  5 16:22:30 2025]
rule doublets_doubletdetection:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519473.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519473.tsv
    jobid: 246
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519473.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519473
    threads: 3
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

Config file configs/outputs.yaml is extended by additional config specified via the command line.
WARNING:ModuleConfig: No default target specified for module "collect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/collect/dataset~{dataset}.zarr..."
WARNING:ModuleConfig: No default target specified for module "uncollect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/uncollect/dataset~{dataset}/file_id~{file_id}/new_file_id~{new_file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "exploration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/exploration/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "sample_representation", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/sample_representation/dataset~{dataset}/file_id~{file_id}/method~{method}/input_type~{input_type}/use_rep~{use_rep}/var_mask~{var_mask}.zarr..."
WARNING:ModuleConfig: No default target specified for module "batch_analysis", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/batch_analysis/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "doublets", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "subset", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/subset/dataset~{dataset}/file_id~{file_id}/strategy~{strategy}.zarr..."
WARNING:ModuleConfig: No default target specified for module "label_transfer", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/label_transfer/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "integration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/integration/dataset~{dataset}/file_id~{file_id}/method~{method}/batch~{batch}/label~{label}/var_mask~{var_mask}/output_type~{output_type}.zarr..."
100%|██████████| 10/10 [01:03<00:00,  5.70s/it]100%|██████████| 10/10 [01:03<00:00,  6.37s/it]
INFO:root:Save results...
WARNING:ModuleConfig: No default target specified for module "marker_genes", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/marker_genes/dataset~{dataset}/file_id~{file_id}.zarr..."
Building DAG of jobs...
Using shell: /usr/local/bin/bash
Provided cores: 10
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Select jobs to execute...
Changing to shadow directory: /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpofkgtcvo
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Not cleaning up /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpwyrkxqw6/.snakemake/scripts/tmp7d2gf2nx.doubletdetection.py
Activating conda environment: qc
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpofkgtcvo/.snakemake/scripts/tmpdhivk2lu.doubletdetection.py
Activating conda environment: qc
[Wed Mar  5 16:22:37 2025]
Finished job 251.
38 of 51 steps (75%) done
Select jobs to execute...

[Wed Mar  5 16:22:37 2025]
rule doublets_doubletdetection:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519507.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519507.tsv
    jobid: 241
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519507.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519507
    threads: 3
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
Config file configs/outputs.yaml is extended by additional config specified via the command line.
INFO:root:Subset to batch GSM5519473...
INFO:root:AnnData object with n_obs × n_vars = 1782 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:Run doubletdetection...
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:116: UserWarning: Leiden clustering is experimental and results have not been validated.
  warnings.warn("Leiden clustering is experimental and results have not been validated.")
  0%|          | 0/10 [00:00<?, ?it/s]WARNING:ModuleConfig: No default target specified for module "collect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/collect/dataset~{dataset}.zarr..."
WARNING:ModuleConfig: No default target specified for module "uncollect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/uncollect/dataset~{dataset}/file_id~{file_id}/new_file_id~{new_file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "exploration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/exploration/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "sample_representation", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/sample_representation/dataset~{dataset}/file_id~{file_id}/method~{method}/input_type~{input_type}/use_rep~{use_rep}/var_mask~{var_mask}.zarr..."
WARNING:ModuleConfig: No default target specified for module "batch_analysis", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/batch_analysis/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "doublets", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "subset", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/subset/dataset~{dataset}/file_id~{file_id}/strategy~{strategy}.zarr..."
WARNING:ModuleConfig: No default target specified for module "label_transfer", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/label_transfer/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "integration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/integration/dataset~{dataset}/file_id~{file_id}/method~{method}/batch~{batch}/label~{label}/var_mask~{var_mask}/output_type~{output_type}.zarr..."
WARNING:ModuleConfig: No default target specified for module "marker_genes", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/marker_genes/dataset~{dataset}/file_id~{file_id}.zarr..."
Building DAG of jobs...
Using shell: /usr/local/bin/bash
Provided cores: 10
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Select jobs to execute...
Changing to shadow directory: /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpylyp9fwv
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: qc
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpylyp9fwv/.snakemake/scripts/tmpvev56h0k.doubletdetection.py
Activating conda environment: qc
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Subset to batch GSM5519507...
INFO:root:AnnData object with n_obs × n_vars = 6889 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:Run doubletdetection...
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:116: UserWarning: Leiden clustering is experimental and results have not been validated.
  warnings.warn("Leiden clustering is experimental and results have not been validated.")
  0%|          | 0/10 [00:00<?, ?it/s]/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:350: FutureWarning: In the future, the default backend for leiden will be igraph instead of leidenalg.

 To achieve the future defaults please pass: flavor="igraph" and n_iterations=2.  directed must also be False to work with igraph's implementation.
  clus(
 10%|█         | 1/10 [00:08<01:19,  8.78s/it] 20%|██        | 2/10 [00:10<00:36,  4.56s/it] 30%|███       | 3/10 [00:12<00:23,  3.29s/it] 40%|████      | 4/10 [00:13<00:15,  2.60s/it] 50%|█████     | 5/10 [00:16<00:13,  2.73s/it] 60%|██████    | 6/10 [00:19<00:10,  2.64s/it] 70%|███████   | 7/10 [00:21<00:07,  2.41s/it] 80%|████████  | 8/10 [00:22<00:04,  2.14s/it] 90%|█████████ | 9/10 [00:24<00:02,  2.03s/it]100%|██████████| 10/10 [00:26<00:00,  1.91s/it]100%|██████████| 10/10 [00:26<00:00,  2.61s/it]
INFO:root:Save results...
Not cleaning up /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpofkgtcvo/.snakemake/scripts/tmpdhivk2lu.doubletdetection.py
[Wed Mar  5 16:23:08 2025]
Finished job 246.
39 of 51 steps (76%) done
Select jobs to execute...

[Wed Mar  5 16:23:08 2025]
rule doublets_doubletdetection:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519501.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519501.tsv
    jobid: 250
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519501.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519501
    threads: 3
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:350: FutureWarning: In the future, the default backend for leiden will be igraph instead of leidenalg.

 To achieve the future defaults please pass: flavor="igraph" and n_iterations=2.  directed must also be False to work with igraph's implementation.
  clus(
Config file configs/outputs.yaml is extended by additional config specified via the command line.
WARNING:ModuleConfig: No default target specified for module "collect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/collect/dataset~{dataset}.zarr..."
WARNING:ModuleConfig: No default target specified for module "uncollect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/uncollect/dataset~{dataset}/file_id~{file_id}/new_file_id~{new_file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "exploration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/exploration/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "sample_representation", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/sample_representation/dataset~{dataset}/file_id~{file_id}/method~{method}/input_type~{input_type}/use_rep~{use_rep}/var_mask~{var_mask}.zarr..."
WARNING:ModuleConfig: No default target specified for module "batch_analysis", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/batch_analysis/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "doublets", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "subset", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/subset/dataset~{dataset}/file_id~{file_id}/strategy~{strategy}.zarr..."
WARNING:ModuleConfig: No default target specified for module "label_transfer", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/label_transfer/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "integration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/integration/dataset~{dataset}/file_id~{file_id}/method~{method}/batch~{batch}/label~{label}/var_mask~{var_mask}/output_type~{output_type}.zarr..."
WARNING:ModuleConfig: No default target specified for module "marker_genes", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/marker_genes/dataset~{dataset}/file_id~{file_id}.zarr..."
Building DAG of jobs...
Using shell: /usr/local/bin/bash
Provided cores: 10
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Select jobs to execute...
Changing to shadow directory: /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpsrq8zu53
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
 10%|█         | 1/10 [00:46<07:02, 46.90s/it]Activating conda environment: qc
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpsrq8zu53/.snakemake/scripts/tmpdf9nf6f8.doubletdetection.py
Activating conda environment: qc
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Subset to batch GSM5519501...
INFO:root:AnnData object with n_obs × n_vars = 5458 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:Run doubletdetection...
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:116: UserWarning: Leiden clustering is experimental and results have not been validated.
  warnings.warn("Leiden clustering is experimental and results have not been validated.")
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:57<03:25, 25.69s/it]/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:350: FutureWarning: In the future, the default backend for leiden will be igraph instead of leidenalg.

 To achieve the future defaults please pass: flavor="igraph" and n_iterations=2.  directed must also be False to work with igraph's implementation.
  clus(
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:350: FutureWarning: In the future, the default backend for leiden will be igraph instead of leidenalg.

 To achieve the future defaults please pass: flavor="igraph" and n_iterations=2.  directed must also be False to work with igraph's implementation.
  clus(
 10%|█         | 1/10 [00:12<01:50, 12.25s/it] 10%|█         | 1/10 [00:45<06:46, 45.13s/it] 30%|███       | 3/10 [01:07<02:07, 18.28s/it] 20%|██        | 2/10 [00:17<01:06,  8.33s/it] 20%|██        | 2/10 [00:54<03:11, 23.93s/it] 40%|████      | 4/10 [01:16<01:27, 14.56s/it] 30%|███       | 3/10 [00:25<00:55,  7.87s/it] 40%|████      | 4/10 [00:29<00:39,  6.66s/it] 30%|███       | 3/10 [01:04<02:02, 17.54s/it] 50%|█████     | 5/10 [00:34<00:29,  5.84s/it] 50%|█████     | 5/10 [01:25<01:04, 12.88s/it] 60%|██████    | 6/10 [00:39<00:21,  5.49s/it] 40%|████      | 4/10 [01:12<01:22, 13.80s/it] 70%|███████   | 7/10 [00:44<00:16,  5.51s/it] 60%|██████    | 6/10 [01:37<00:49, 12.41s/it] 50%|█████     | 5/10 [01:20<00:58, 11.67s/it] 80%|████████  | 8/10 [00:50<00:11,  5.62s/it] 90%|█████████ | 9/10 [00:55<00:05,  5.42s/it] 60%|██████    | 6/10 [01:27<00:41, 10.31s/it] 70%|███████   | 7/10 [01:50<00:37, 12.63s/it]100%|██████████| 10/10 [01:00<00:00,  5.39s/it]100%|██████████| 10/10 [01:00<00:00,  6.08s/it]
INFO:root:Save results...
Not cleaning up /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpsrq8zu53/.snakemake/scripts/tmpdf9nf6f8.doubletdetection.py
[Wed Mar  5 16:24:20 2025]
Finished job 250.
40 of 51 steps (78%) done
Select jobs to execute...

[Wed Mar  5 16:24:20 2025]
rule doublets_doubletdetection:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519470.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519470.tsv
    jobid: 259
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519470.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519470
    threads: 3
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

 70%|███████   | 7/10 [01:35<00:28,  9.35s/it]Config file configs/outputs.yaml is extended by additional config specified via the command line.
WARNING:ModuleConfig: No default target specified for module "collect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/collect/dataset~{dataset}.zarr..."
WARNING:ModuleConfig: No default target specified for module "uncollect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/uncollect/dataset~{dataset}/file_id~{file_id}/new_file_id~{new_file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "exploration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/exploration/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "sample_representation", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/sample_representation/dataset~{dataset}/file_id~{file_id}/method~{method}/input_type~{input_type}/use_rep~{use_rep}/var_mask~{var_mask}.zarr..."
WARNING:ModuleConfig: No default target specified for module "batch_analysis", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/batch_analysis/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "doublets", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "subset", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/subset/dataset~{dataset}/file_id~{file_id}/strategy~{strategy}.zarr..."
WARNING:ModuleConfig: No default target specified for module "label_transfer", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/label_transfer/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "integration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/integration/dataset~{dataset}/file_id~{file_id}/method~{method}/batch~{batch}/label~{label}/var_mask~{var_mask}/output_type~{output_type}.zarr..."
WARNING:ModuleConfig: No default target specified for module "marker_genes", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/marker_genes/dataset~{dataset}/file_id~{file_id}.zarr..."
Building DAG of jobs...
Using shell: /usr/local/bin/bash
Provided cores: 10
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Select jobs to execute...
Changing to shadow directory: /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpedie4m3r
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: qc
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpedie4m3r/.snakemake/scripts/tmpsqkvv0l9.doubletdetection.py
Activating conda environment: qc
 80%|████████  | 8/10 [01:59<00:23, 11.54s/it]INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Subset to batch GSM5519470...
INFO:root:AnnData object with n_obs × n_vars = 1327 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:Run doubletdetection...
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:116: UserWarning: Leiden clustering is experimental and results have not been validated.
  warnings.warn("Leiden clustering is experimental and results have not been validated.")
  0%|          | 0/10 [00:00<?, ?it/s] 80%|████████  | 8/10 [01:43<00:18,  9.07s/it] 90%|█████████ | 9/10 [02:11<00:11, 11.49s/it]/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:350: FutureWarning: In the future, the default backend for leiden will be igraph instead of leidenalg.

 To achieve the future defaults please pass: flavor="igraph" and n_iterations=2.  directed must also be False to work with igraph's implementation.
  clus(
 10%|█         | 1/10 [00:09<01:22,  9.16s/it] 20%|██        | 2/10 [00:10<00:36,  4.53s/it] 30%|███       | 3/10 [00:11<00:20,  2.93s/it] 90%|█████████ | 9/10 [01:54<00:09,  9.51s/it] 40%|████      | 4/10 [00:12<00:12,  2.15s/it] 50%|█████     | 5/10 [00:13<00:08,  1.72s/it] 60%|██████    | 6/10 [00:14<00:05,  1.49s/it] 70%|███████   | 7/10 [00:15<00:03,  1.32s/it] 80%|████████  | 8/10 [00:16<00:02,  1.20s/it] 90%|█████████ | 9/10 [00:17<00:01,  1.13s/it]100%|██████████| 10/10 [02:20<00:00, 10.88s/it]100%|██████████| 10/10 [02:20<00:00, 14.07s/it]
INFO:root:Save results...
100%|██████████| 10/10 [00:18<00:00,  1.09s/it]100%|██████████| 10/10 [00:18<00:00,  1.83s/it]
INFO:root:Save results...
Not cleaning up /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpuss3nsei/.snakemake/scripts/tmpmb5i8sza.doubletdetection.py
Not cleaning up /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpedie4m3r/.snakemake/scripts/tmpsqkvv0l9.doubletdetection.py
100%|██████████| 10/10 [02:02<00:00,  9.29s/it]100%|██████████| 10/10 [02:02<00:00, 12.29s/it]
INFO:root:Save results...
Not cleaning up /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpylyp9fwv/.snakemake/scripts/tmpvev56h0k.doubletdetection.py
[Wed Mar  5 16:24:50 2025]
Finished job 260.
41 of 51 steps (80%) done
Select jobs to execute...

[Wed Mar  5 16:24:50 2025]
rule doublets_doubletdetection:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519489.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519489.tsv
    jobid: 252
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519489.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519489
    threads: 3
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

[Wed Mar  5 16:24:50 2025]
Finished job 259.
42 of 51 steps (82%) done
Select jobs to execute...

[Wed Mar  5 16:24:50 2025]
rule doublets_doubletdetection:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519480.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519480.tsv
    jobid: 253
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519480.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519480
    threads: 3
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

Config file configs/outputs.yaml is extended by additional config specified via the command line.
Config file configs/outputs.yaml is extended by additional config specified via the command line.
[Wed Mar  5 16:24:51 2025]
Finished job 241.
43 of 51 steps (84%) done
Select jobs to execute...

[Wed Mar  5 16:24:51 2025]
rule doublets_doubletdetection:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519467.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519467.tsv
    jobid: 257
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519467.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519467
    threads: 3
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

WARNING:ModuleConfig: No default target specified for module "collect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/collect/dataset~{dataset}.zarr..."
WARNING:ModuleConfig: No default target specified for module "uncollect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/uncollect/dataset~{dataset}/file_id~{file_id}/new_file_id~{new_file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "collect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/collect/dataset~{dataset}.zarr..."
WARNING:ModuleConfig: No default target specified for module "uncollect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/uncollect/dataset~{dataset}/file_id~{file_id}/new_file_id~{new_file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "exploration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/exploration/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "sample_representation", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/sample_representation/dataset~{dataset}/file_id~{file_id}/method~{method}/input_type~{input_type}/use_rep~{use_rep}/var_mask~{var_mask}.zarr..."
WARNING:ModuleConfig: No default target specified for module "exploration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/exploration/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "batch_analysis", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/batch_analysis/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "doublets", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "sample_representation", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/sample_representation/dataset~{dataset}/file_id~{file_id}/method~{method}/input_type~{input_type}/use_rep~{use_rep}/var_mask~{var_mask}.zarr..."
WARNING:ModuleConfig: No default target specified for module "batch_analysis", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/batch_analysis/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "doublets", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "subset", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/subset/dataset~{dataset}/file_id~{file_id}/strategy~{strategy}.zarr..."
Config file configs/outputs.yaml is extended by additional config specified via the command line.
WARNING:ModuleConfig: No default target specified for module "label_transfer", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/label_transfer/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "subset", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/subset/dataset~{dataset}/file_id~{file_id}/strategy~{strategy}.zarr..."
WARNING:ModuleConfig: No default target specified for module "label_transfer", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/label_transfer/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "integration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/integration/dataset~{dataset}/file_id~{file_id}/method~{method}/batch~{batch}/label~{label}/var_mask~{var_mask}/output_type~{output_type}.zarr..."
WARNING:ModuleConfig: No default target specified for module "integration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/integration/dataset~{dataset}/file_id~{file_id}/method~{method}/batch~{batch}/label~{label}/var_mask~{var_mask}/output_type~{output_type}.zarr..."
WARNING:ModuleConfig: No default target specified for module "marker_genes", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/marker_genes/dataset~{dataset}/file_id~{file_id}.zarr..."
Building DAG of jobs...
Using shell: /usr/local/bin/bash
Provided cores: 10
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Select jobs to execute...
Changing to shadow directory: /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmplfz5lrhy
WARNING:ModuleConfig: No default target specified for module "marker_genes", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/marker_genes/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "collect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/collect/dataset~{dataset}.zarr..."
WARNING:ModuleConfig: No default target specified for module "uncollect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/uncollect/dataset~{dataset}/file_id~{file_id}/new_file_id~{new_file_id}.zarr..."
Building DAG of jobs...
Using shell: /usr/local/bin/bash
Provided cores: 10
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Select jobs to execute...
Changing to shadow directory: /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpdu15rtey
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
WARNING:ModuleConfig: No default target specified for module "exploration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/exploration/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "sample_representation", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/sample_representation/dataset~{dataset}/file_id~{file_id}/method~{method}/input_type~{input_type}/use_rep~{use_rep}/var_mask~{var_mask}.zarr..."
WARNING:ModuleConfig: No default target specified for module "batch_analysis", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/batch_analysis/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "doublets", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "subset", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/subset/dataset~{dataset}/file_id~{file_id}/strategy~{strategy}.zarr..."
WARNING:ModuleConfig: No default target specified for module "label_transfer", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/label_transfer/dataset~{dataset}/file_id~{file_id}.zarr..."
Activating conda environment: qc
Activating conda environment: qc
WARNING:ModuleConfig: No default target specified for module "integration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/integration/dataset~{dataset}/file_id~{file_id}/method~{method}/batch~{batch}/label~{label}/var_mask~{var_mask}/output_type~{output_type}.zarr..."
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpdu15rtey/.snakemake/scripts/tmp9kg059zh.doubletdetection.py
Activating conda environment: qc
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmplfz5lrhy/.snakemake/scripts/tmpdbsqjr4t.doubletdetection.py
Activating conda environment: qc
WARNING:ModuleConfig: No default target specified for module "marker_genes", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/marker_genes/dataset~{dataset}/file_id~{file_id}.zarr..."
Building DAG of jobs...
Using shell: /usr/local/bin/bash
Provided cores: 10
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Select jobs to execute...
Changing to shadow directory: /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmph9c3gj61
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: qc
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmph9c3gj61/.snakemake/scripts/tmpoopjiki8.doubletdetection.py
Activating conda environment: qc
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Subset to batch GSM5519489...
INFO:root:AnnData object with n_obs × n_vars = 2875 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:Subset to batch GSM5519480...
INFO:root:AnnData object with n_obs × n_vars = 197 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:Run doubletdetection...
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:116: UserWarning: Leiden clustering is experimental and results have not been validated.
  warnings.warn("Leiden clustering is experimental and results have not been validated.")
INFO:root:Run doubletdetection...
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:116: UserWarning: Leiden clustering is experimental and results have not been validated.
  warnings.warn("Leiden clustering is experimental and results have not been validated.")
  0%|          | 0/10 [00:00<?, ?it/s]  0%|          | 0/10 [00:00<?, ?it/s]INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Subset to batch GSM5519467...
INFO:root:AnnData object with n_obs × n_vars = 696 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:Run doubletdetection...
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:116: UserWarning: Leiden clustering is experimental and results have not been validated.
  warnings.warn("Leiden clustering is experimental and results have not been validated.")
  0%|          | 0/10 [00:00<?, ?it/s]/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:350: FutureWarning: In the future, the default backend for leiden will be igraph instead of leidenalg.

 To achieve the future defaults please pass: flavor="igraph" and n_iterations=2.  directed must also be False to work with igraph's implementation.
  clus(
 10%|█         | 1/10 [00:07<01:05,  7.30s/it] 20%|██        | 2/10 [00:07<00:24,  3.07s/it] 30%|███       | 3/10 [00:07<00:12,  1.72s/it] 40%|████      | 4/10 [00:07<00:06,  1.08s/it] 50%|█████     | 5/10 [00:07<00:03,  1.36it/s] 60%|██████    | 6/10 [00:07<00:02,  1.92it/s] 70%|███████   | 7/10 [00:07<00:01,  2.58it/s] 80%|████████  | 8/10 [00:08<00:00,  3.33it/s] 90%|█████████ | 9/10 [00:08<00:00,  4.16it/s]100%|██████████| 10/10 [00:08<00:00,  4.99it/s]100%|██████████| 10/10 [00:08<00:00,  1.21it/s]
INFO:root:Save results...
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:350: FutureWarning: In the future, the default backend for leiden will be igraph instead of leidenalg.

 To achieve the future defaults please pass: flavor="igraph" and n_iterations=2.  directed must also be False to work with igraph's implementation.
  clus(
Not cleaning up /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpdu15rtey/.snakemake/scripts/tmp9kg059zh.doubletdetection.py
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:350: FutureWarning: In the future, the default backend for leiden will be igraph instead of leidenalg.

 To achieve the future defaults please pass: flavor="igraph" and n_iterations=2.  directed must also be False to work with igraph's implementation.
  clus(
 10%|█         | 1/10 [00:07<01:10,  7.78s/it] 10%|█         | 1/10 [00:09<01:26,  9.56s/it] 20%|██        | 2/10 [00:08<00:28,  3.54s/it] 30%|███       | 3/10 [00:08<00:14,  2.13s/it][Wed Mar  5 16:25:08 2025]
Finished job 253.
44 of 51 steps (86%) done
Select jobs to execute...
 40%|████      | 4/10 [00:09<00:08,  1.49s/it]
[Wed Mar  5 16:25:08 2025]
rule doublets_doubletdetection:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519468.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519468.tsv
    jobid: 248
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519468.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519468
    threads: 3
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

 50%|█████     | 5/10 [00:09<00:05,  1.18s/it]Config file configs/outputs.yaml is extended by additional config specified via the command line.
 60%|██████    | 6/10 [00:10<00:03,  1.05it/s]WARNING:ModuleConfig: No default target specified for module "collect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/collect/dataset~{dataset}.zarr..."
WARNING:ModuleConfig: No default target specified for module "uncollect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/uncollect/dataset~{dataset}/file_id~{file_id}/new_file_id~{new_file_id}.zarr..."
 70%|███████   | 7/10 [00:11<00:02,  1.21it/s] 20%|██        | 2/10 [00:12<00:47,  5.92s/it]WARNING:ModuleConfig: No default target specified for module "exploration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/exploration/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "sample_representation", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/sample_representation/dataset~{dataset}/file_id~{file_id}/method~{method}/input_type~{input_type}/use_rep~{use_rep}/var_mask~{var_mask}.zarr..."
WARNING:ModuleConfig: No default target specified for module "batch_analysis", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/batch_analysis/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "doublets", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~{dataset}/file_id~{file_id}.zarr..."
 80%|████████  | 8/10 [00:11<00:01,  1.35it/s]WARNING:ModuleConfig: No default target specified for module "subset", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/subset/dataset~{dataset}/file_id~{file_id}/strategy~{strategy}.zarr..."
WARNING:ModuleConfig: No default target specified for module "label_transfer", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/label_transfer/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "integration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/integration/dataset~{dataset}/file_id~{file_id}/method~{method}/batch~{batch}/label~{label}/var_mask~{var_mask}/output_type~{output_type}.zarr..."
 90%|█████████ | 9/10 [00:12<00:00,  1.43it/s]WARNING:ModuleConfig: No default target specified for module "marker_genes", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/marker_genes/dataset~{dataset}/file_id~{file_id}.zarr..."
Building DAG of jobs...
Using shell: /usr/local/bin/bash
Provided cores: 10
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Select jobs to execute...
Changing to shadow directory: /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmp4blf_5jo
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
100%|██████████| 10/10 [00:12<00:00,  1.56it/s]100%|██████████| 10/10 [00:12<00:00,  1.27s/it]
INFO:root:Save results...
Not cleaning up /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmph9c3gj61/.snakemake/scripts/tmpoopjiki8.doubletdetection.py
Activating conda environment: qc
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmp4blf_5jo/.snakemake/scripts/tmp403fa1bz.doubletdetection.py
Activating conda environment: qc
 30%|███       | 3/10 [00:16<00:35,  5.00s/it][Wed Mar  5 16:25:15 2025]
Finished job 257.
45 of 51 steps (88%) done
Select jobs to execute...

[Wed Mar  5 16:25:15 2025]
rule doublets_doubletdetection:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519481.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519481.tsv
    jobid: 245
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519481.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519481
    threads: 3
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
Config file configs/outputs.yaml is extended by additional config specified via the command line.
INFO:root:Subset to batch GSM5519468...
INFO:root:AnnData object with n_obs × n_vars = 655 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:Run doubletdetection...
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:116: UserWarning: Leiden clustering is experimental and results have not been validated.
  warnings.warn("Leiden clustering is experimental and results have not been validated.")
  0%|          | 0/10 [00:00<?, ?it/s]WARNING:ModuleConfig: No default target specified for module "collect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/collect/dataset~{dataset}.zarr..."
WARNING:ModuleConfig: No default target specified for module "uncollect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/uncollect/dataset~{dataset}/file_id~{file_id}/new_file_id~{new_file_id}.zarr..."
 40%|████      | 4/10 [00:19<00:24,  4.12s/it]WARNING:ModuleConfig: No default target specified for module "exploration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/exploration/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "sample_representation", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/sample_representation/dataset~{dataset}/file_id~{file_id}/method~{method}/input_type~{input_type}/use_rep~{use_rep}/var_mask~{var_mask}.zarr..."
WARNING:ModuleConfig: No default target specified for module "batch_analysis", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/batch_analysis/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "doublets", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "subset", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/subset/dataset~{dataset}/file_id~{file_id}/strategy~{strategy}.zarr..."
WARNING:ModuleConfig: No default target specified for module "label_transfer", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/label_transfer/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "integration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/integration/dataset~{dataset}/file_id~{file_id}/method~{method}/batch~{batch}/label~{label}/var_mask~{var_mask}/output_type~{output_type}.zarr..."
WARNING:ModuleConfig: No default target specified for module "marker_genes", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/marker_genes/dataset~{dataset}/file_id~{file_id}.zarr..."
Building DAG of jobs...
Using shell: /usr/local/bin/bash
Provided cores: 10
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Select jobs to execute...
Changing to shadow directory: /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpoxjw3cdb
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: qc
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpoxjw3cdb/.snakemake/scripts/tmpe57p7z0i.doubletdetection.py
Activating conda environment: qc
 50%|█████     | 5/10 [00:22<00:18,  3.64s/it]INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Subset to batch GSM5519481...
INFO:root:AnnData object with n_obs × n_vars = 287 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
INFO:root:Run doubletdetection...
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:116: UserWarning: Leiden clustering is experimental and results have not been validated.
  warnings.warn("Leiden clustering is experimental and results have not been validated.")
  0%|          | 0/10 [00:00<?, ?it/s] 60%|██████    | 6/10 [00:25<00:13,  3.29s/it]/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:350: FutureWarning: In the future, the default backend for leiden will be igraph instead of leidenalg.

 To achieve the future defaults please pass: flavor="igraph" and n_iterations=2.  directed must also be False to work with igraph's implementation.
  clus(
 10%|█         | 1/10 [00:07<01:08,  7.64s/it] 20%|██        | 2/10 [00:08<00:27,  3.42s/it] 30%|███       | 3/10 [00:08<00:14,  2.05s/it] 40%|████      | 4/10 [00:08<00:08,  1.41s/it] 50%|█████     | 5/10 [00:09<00:05,  1.06s/it] 70%|███████   | 7/10 [00:28<00:10,  3.37s/it] 60%|██████    | 6/10 [00:09<00:03,  1.17it/s] 70%|███████   | 7/10 [00:10<00:02,  1.38it/s] 80%|████████  | 8/10 [00:10<00:01,  1.60it/s] 90%|█████████ | 9/10 [00:11<00:00,  1.76it/s]100%|██████████| 10/10 [00:11<00:00,  1.85it/s]100%|██████████| 10/10 [00:11<00:00,  1.16s/it]
INFO:root:Save results...
 80%|████████  | 8/10 [00:31<00:06,  3.14s/it]Not cleaning up /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmp4blf_5jo/.snakemake/scripts/tmp403fa1bz.doubletdetection.py
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:350: FutureWarning: In the future, the default backend for leiden will be igraph instead of leidenalg.

 To achieve the future defaults please pass: flavor="igraph" and n_iterations=2.  directed must also be False to work with igraph's implementation.
  clus(
 10%|█         | 1/10 [00:06<01:02,  6.93s/it] 20%|██        | 2/10 [00:07<00:23,  2.96s/it] 30%|███       | 3/10 [00:07<00:11,  1.67s/it] 40%|████      | 4/10 [00:07<00:06,  1.09s/it] 50%|█████     | 5/10 [00:07<00:03,  1.35it/s] 60%|██████    | 6/10 [00:07<00:02,  1.88it/s] 70%|███████   | 7/10 [00:07<00:01,  2.51it/s] 80%|████████  | 8/10 [00:07<00:00,  3.15it/s] 90%|█████████ | 9/10 [00:08<00:00,  3.89it/s]100%|██████████| 10/10 [00:08<00:00,  4.49it/s]100%|██████████| 10/10 [00:08<00:00,  1.21it/s]
INFO:root:Save results...
[Wed Mar  5 16:25:31 2025]
Finished job 248.
46 of 51 steps (90%) done
Select jobs to execute...

[Wed Mar  5 16:25:31 2025]
rule doublets_doubletdetection:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/_batches/GSM5519482.txt
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519482.tsv
    jobid: 243
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519482.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs, batch=GSM5519482
    threads: 3
    resources: tmpdir=/tmp, partition=, qos=, gpu=, mem_mb=

Not cleaning up /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpoxjw3cdb/.snakemake/scripts/tmpe57p7z0i.doubletdetection.py
Config file configs/outputs.yaml is extended by additional config specified via the command line.
 90%|█████████ | 9/10 [00:34<00:03,  3.23s/it]WARNING:ModuleConfig: No default target specified for module "collect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/collect/dataset~{dataset}.zarr..."
WARNING:ModuleConfig: No default target specified for module "uncollect", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/uncollect/dataset~{dataset}/file_id~{file_id}/new_file_id~{new_file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "exploration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/exploration/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "sample_representation", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/sample_representation/dataset~{dataset}/file_id~{file_id}/method~{method}/input_type~{input_type}/use_rep~{use_rep}/var_mask~{var_mask}.zarr..."
WARNING:ModuleConfig: No default target specified for module "batch_analysis", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/batch_analysis/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "doublets", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "subset", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/subset/dataset~{dataset}/file_id~{file_id}/strategy~{strategy}.zarr..."
WARNING:ModuleConfig: No default target specified for module "label_transfer", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/label_transfer/dataset~{dataset}/file_id~{file_id}.zarr..."
WARNING:ModuleConfig: No default target specified for module "integration", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/integration/dataset~{dataset}/file_id~{file_id}/method~{method}/batch~{batch}/label~{label}/var_mask~{var_mask}/output_type~{output_type}.zarr..."
[Wed Mar  5 16:25:33 2025]
Finished job 245.
47 of 51 steps (92%) done
WARNING:ModuleConfig: No default target specified for module "marker_genes", using default:
"/nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/marker_genes/dataset~{dataset}/file_id~{file_id}.zarr..."
Building DAG of jobs...
Using shell: /usr/local/bin/bash
Provided cores: 10
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Select jobs to execute...
Changing to shadow directory: /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpvxyq0lam
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: qc
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpvxyq0lam/.snakemake/scripts/tmprmja6ir2.doubletdetection.py
Activating conda environment: qc
100%|██████████| 10/10 [00:37<00:00,  3.17s/it]100%|██████████| 10/10 [00:37<00:00,  3.77s/it]
INFO:root:Save results...
Not cleaning up /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmplfz5lrhy/.snakemake/scripts/tmpdbsqjr4t.doubletdetection.py
INFO:root:Read /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr...
INFO:root:Subset to batch GSM5519482...
INFO:root:AnnData object with n_obs × n_vars = 80 × 24452
    obs: 'doi', 'infection_status', 'donor', 'IR_VDJ_1_v_call', 'barcode', 'modalities', 'IR_VJ_1_junction_aa', 'original_annotation', 'self_reported_ethnicity_ontology_term_id', 'age', 'organism_ontology_term_id', 'pipeline_version', 'disease', 'IR_VDJ_1_junction_aa', 'author_annotation', 'donor_id', 'IR_VJ_1_j_call', 'assay', 'development_stage', 'organism', 'sex', 'assay_ontology_term_id', 'study', 'institution', 'sample', 'tissue_ontology_term_id', 'disease_ontology_term_id', 'IR_VDJ_1_j_call', 'sex_ontology_term_id', 'Cross_tissue_broad', 'development_stage_ontology_term_id', 'Lindeboom_detailed', 'self_reported_ethnicity', 'infection_stage', 'dataset', 'IR_VJ_1_v_call', 'Compartment_prediction', 'reference', 'organ', 'pathogen', 'suspension_type', 'cell_type_ontology_term_id', 'Lindeboom_broad', 'dataset_id', 'cell_type', 'tissue', 'Cross_tissue_detailed', 'batch_condition', '10X_5prime', 'sample_id', 'is_primary_data', 'n_counts', 'log1p_n_counts', 'n_genes', 'log1p_n_genes', 'percent_mito', 'n_counts_mito', 'percent_ribo', 'n_counts_ribo', 'percent_hb', 'n_counts_hb', 'percent_top50', 'cell_passed_qc', 'passed_qc', 'user_qc_status', 'alternative_qc_status', 'qc_status'
[Wed Mar  5 16:25:37 2025]
Finished job 252.
48 of 51 steps (94%) done
INFO:root:Run doubletdetection...
/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:116: UserWarning: Leiden clustering is experimental and results have not been validated.
  warnings.warn("Leiden clustering is experimental and results have not been validated.")
  0%|          | 0/10 [00:00<?, ?it/s]/lustre/scratch126/cellgen/team205/ld21/miniforge3/envs/qc/lib/python3.10/site-packages/doubletdetection/doubletdetection.py:350: FutureWarning: In the future, the default backend for leiden will be igraph instead of leidenalg.

 To achieve the future defaults please pass: flavor="igraph" and n_iterations=2.  directed must also be False to work with igraph's implementation.
  clus(
 10%|█         | 1/10 [00:06<00:58,  6.52s/it] 40%|████      | 4/10 [00:06<00:07,  1.27s/it] 70%|███████   | 7/10 [00:06<00:01,  1.64it/s]100%|██████████| 10/10 [00:06<00:00,  2.75it/s]100%|██████████| 10/10 [00:06<00:00,  1.45it/s]
INFO:root:Save results...
Not cleaning up /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/shadow/tmpvxyq0lam/.snakemake/scripts/tmprmja6ir2.doubletdetection.py
[Wed Mar  5 16:25:47 2025]
Finished job 243.
49 of 51 steps (96%) done
Select jobs to execute...

[Wed Mar  5 16:25:47 2025]
localrule doublets_collect:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/qc/dataset~complete/file_id~GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519493.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519507.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519490.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519482.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519498.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519481.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519473.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519478.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519468.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519474.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519501.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519503.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519489.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519480.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519505.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519476.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519479.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519467.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519500.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519470.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519511.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519492.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519509.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519493.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519507.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519490.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519482.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519498.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519481.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519473.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519478.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519468.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519474.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519501.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519503.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519489.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519480.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519505.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519476.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519479.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519467.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519500.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519470.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519511.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519492.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519509.tsv
    output: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~complete/file_id~qc:GSE182159_PBMCs.zarr
    jobid: 6
    reason: Missing output files: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~complete/file_id~qc:GSE182159_PBMCs.zarr; Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519493.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519479.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519490.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519498.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519480.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519500.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519478.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519473.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519490.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519507.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519474.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519482.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519503.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519505.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519492.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519482.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519507.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519501.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519470.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519468.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519489.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519509.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519479.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519493.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519468.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519511.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519509.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519498.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519481.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519467.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519501.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519511.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519489.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519474.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519481.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519476.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519500.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519476.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519467.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519505.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519503.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519470.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519492.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519480.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/doubletdetection/GSM5519473.tsv, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/scatter/dataset~complete/file_id~qc:GSE182159_PBMCs/scrublet/GSM5519478.tsv
    wildcards: dataset=complete, file_id=qc:GSE182159_PBMCs
    resources: tmpdir=/tmp, mem_mb=

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: scanpy
python /nfs/team205/ld21/repos/sc-atlassing-toolbox/.snakemake/scripts/tmpkfd5uv1g.collect.py
Activating conda environment: scanpy
[Wed Mar  5 16:25:54 2025]
Finished job 6.
50 of 51 steps (98%) done
Select jobs to execute...

[Wed Mar  5 16:25:54 2025]
localrule doublets_all:
    input: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~complete/file_id~qc:GSE182159_Liver.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~complete/file_id~qc:GSE182159_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~complete/file_id~qc:GSE259231_mCEL_seq2_HBV.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~complete/file_id~qc:GSE259231_mCEL_seq2_HCV.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~complete/file_id~qc:GSE162097_PBMCs.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~complete/file_id~qc:GSE162097_TDL.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~complete/file_id~qc:GSE287808_NALT.zarr, /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~complete/file_id~qc:GSE287808_PBMCs.zarr
    jobid: 0
    reason: Input files updated by another job: /nfs/team205/tcr_pipeline/datasets/pan_infection_atlas/snakemake_toolbox/out/doublets/dataset~complete/file_id~qc:GSE182159_PBMCs.zarr
    resources: tmpdir=/tmp

[Wed Mar  5 16:25:54 2025]
Finished job 0.
51 of 51 steps (100%) done
Complete log: .snakemake/log/2025-03-05T160001.011863.snakemake.log
